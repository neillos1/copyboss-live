<!DOCTYPE html>
<html lang="en">

<head>
    <!-- ✅ Primary SEO Meta -->
    <title>VideoBoss Analyzer - AI Video Analysis Tool</title>
    <meta name="description" content="Analyze your videos with CopyBoss Analyzer — get AI-powered insights on virality, engagement, retention, and performance to improve your TikTok, YouTube, and Instagram content.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <meta name="msvalidate.01" content="A38FE47EADB280B3037029B991B65523" />

    <!-- ✅ Favicon -->
    <link rel="icon" type="image/png" href="/assets/img/favicon.png">
    <link rel="apple-touch-icon" href="/assets/img/favicon.png">

    <!-- ✅ Open Graph (Facebook, LinkedIn) -->
    <meta property="og:title" content="VideoBoss Analyzer - AI Video Analysis Tool">
    <meta property="og:description" content="Analyze TikTok, YouTube, and Instagram videos with AI insights. Discover virality, engagement, and performance metrics.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://copy-boss.com/analyzer.html">
    <meta property="og:image" content="https://copy-boss.com/assets/img/og-analyzer.png">

    <!-- ✅ Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="VideoBoss Analyzer - AI Video Analysis Tool">
    <meta name="twitter:description" content="Get AI-powered insights on virality, engagement, and retention for your videos.">
    <meta name="twitter:image" content="https://copy-boss.com/assets/img/og-analyzer.png">
    <meta name="twitter:site" content="@copybosshq">

    <!-- ✅ Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "s3457vebta");
    </script>

    <!-- ✅ Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6WMZL614NV"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-6WMZL614NV');
    </script>

    <!-- ✅ Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "ZERRA Group Ltd",
      "url": "https://copy-boss.com",
      "logo": "https://copy-boss.com/assets/img/mascot.png",
      "sameAs": [
        "https://twitter.com/copybosshq",
        "https://facebook.com/copybosshq",
        "https://instagram.com/copybosshq",
        "https://www.tiktok.com/@copybosspro",
        "https://youtube.com/copybosshq"
      ],
      "founder": "Neil Enright",
      "brand": {
        "@type": "Brand",
        "name": "CopyBoss"
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "url": "https://copy-boss.com/",
      "name": "CopyBoss",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://copy-boss.com/?s={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Product",
      "name": "CopyBoss",
      "description": "AI-powered video analyzer and script generator built for content creators on TikTok, YouTube, and Instagram.",
      "brand": {
        "@type": "Brand",
        "name": "CopyBoss"
      },
      "offers": {
        "@type": "Offer",
        "url": "https://copy-boss.com/pricing.html",
        "priceCurrency": "GBP",
        "price": "4.99",
        "availability": "https://schema.org/InStock"
      }
    }
    </script>

    <!-- ✅ Robots + Sitemap -->
    <meta name="robots" content="index, follow">
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml">

    <!-- Toastify CSS + JS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

    <!-- Font Awesome v6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <!-- CSS Files -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/now-ui-dashboard.css?v=1.5.0" rel="stylesheet" />
    <link href="assets/css/demo.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://js.stripe.com/v3"></script>
    <script src="js/countdown.js"></script>

<body style="margin: 0; display: flex; flex-direction: column;">
    <!-- Particle Animation -->
    <div class="particles" id="particles"></div>

<script>
  // User plan configuration
  const userIsPro = false; // Change this to true if the user has Pro access
  
  // Pro features configuration
  const PRO_FEATURES = {
    COMPARE_VIDEOS: true,
    SHARE_REPORTS: true,
    DOWNLOAD_RESULTS: true,
    ALL_GAUGES: true
  };
  
  // Upgrade system configuration
  const UPGRADE_SYSTEM_ACTIVE = true; // Set to false when upgrade system is not live
</script>

<div class="main-content"></div>


  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #0a0a1a 0%, #1a1a2e 25%, #16213e 50%, #0f0f23 100%);
      min-height: 100vh;
      overflow-x: hidden;
      color: white;
      margin: 0;
    }

    /* Particle Animation */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: rgba(102, 126, 234, 0.6);
      border-radius: 50%;
      animation: float 6s infinite linear;
    }

    @keyframes float {
      0% {
        transform: translateY(100vh) translateX(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) translateX(100px);
        opacity: 0;
      }
    }

    .navbar-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 15px;
      padding: 20px 30px;
    }

    .navbar-buttons button {
      background: #fbfbfb;
      color: #fff;
     border: 1px solid white !important;


      padding: 8px 16px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s;
    }

    .navbar-buttons button:hover {
      background: #ff7b51;
    }

    /* Ghost Button Styling */
    .ghost-btn {
      background: transparent !important;
      border: 1px solid white !important;
      color: white !important;
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .ghost-btn:hover {
      background: linear-gradient(135deg, #3B82F6, #2563EB) !important;
      color: white !important;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
      transform: translateY(-1px);
    }

    .ghost-btn i {
      margin-right: 4px;
    }

    /* Icon Hover Animation */
    .sidebar-btn i,
    .ghost-btn i {
      transition: transform 0.4s ease-in-out;
    }
    
    .sidebar-btn:hover i,
    .ghost-btn:hover i {
      transform: rotate(360deg);
    }

    /* Sidebar Button Styling */
    .sidebar-btn {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      color: white;
      text-decoration: none;
      transition: background 0.3s, box-shadow 0.3s;
      border-radius: 8px;
      margin: 2px 0;
      width: 100%;
    }

    .sidebar-btn:hover {
      background: linear-gradient(135deg, #3B82F6, #2563EB);
      color: white;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
      transform: translateX(4px);
    }

    .btn-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex: 1;
      min-height: 20px;
    }

    .sidebar-btn i {
      transition: transform 0.4s ease-in-out;
      font-size: 16px;
      width: 20px;
      text-align: center;
    }

    .sidebar-btn:hover i {
      transform: rotate(360deg);
    }

    .pro-badge {
      background: #6c2bd9; /* keep existing color */
      padding: 2px 8px;
      border-radius: 6px;
      font-size: 12px;
      margin-right: 12px; /* spacing from right edge */
      color: white;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      flex-shrink: 0;
    }

    /* Sidebar Divider */
    .sidebar-divider {
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
      margin: 16px 0;
      width: 100%;
    }

    /* Fade-in animation for video comparison modal */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .video-item {
      animation: fadeIn 0.3s ease-in-out;
    }

    /* Compare button states */
    .compare-btn {
      width: 100%;
      padding: 12px 16px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .compare-btn.disabled {
      background: #6c757d;
      color: white;
      cursor: not-allowed;
    }

    /* Custom Stripe Button Styling */
    .stripe-checkout-btn {
      background: linear-gradient(135deg, #6c63ff, #8e7cff) !important;
      color: white !important;
      border: none !important;
      padding: 12px 24px !important;
      border-radius: 10px !important;
      font-weight: 600 !important;
      font-size: 16px !important;
      cursor: pointer !important;
      transition: all 0.3s ease !important;
      box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3) !important;
      text-decoration: none !important;
      display: inline-block !important;
    }

    .stripe-checkout-btn:hover {
      transform: translateY(-2px) !important;
      box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4) !important;
      color: white !important;
      text-decoration: none !important;
    }

    .stripe-checkout-btn:focus {
      outline: none !important;
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.3) !important;
    }

    /* Sidebar Credit Button Styling - Dark Neon Theme */
    .sidebar-credit-btn {
      background: linear-gradient(135deg, #4e54c8, #8f94fb) !important;
      color: white !important;
      border: none !important;
      border-radius: 10px !important;
      font-weight: 700 !important;
      box-shadow: 0 4px 15px rgba(78, 84, 200, 0.3) !important;
      transition: all 0.3s ease !important;
    }

    .sidebar-credit-btn:hover {
      transform: translateY(-2px) !important;
      box-shadow: 0 6px 20px rgba(78, 84, 200, 0.5) !important;
      background: linear-gradient(135deg, #5a60d4, #9ba0ff) !important;
    }

    .sidebar-credit-btn:active {
      transform: translateY(0) !important;
      box-shadow: 0 2px 10px rgba(78, 84, 200, 0.4) !important;
    }

    .stripe-checkout-btn.pro {
      background: linear-gradient(135deg, #6c63ff, #8e7cff) !important;
    }

    .stripe-checkout-btn.credits-2 {
      background: linear-gradient(135deg, #4CAF50, #45a049) !important;
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3) !important;
    }

    .stripe-checkout-btn.credits-2:hover {
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4) !important;
    }

    .stripe-checkout-btn.credits-15 {
      background: linear-gradient(135deg, #FF9800, #F57C00) !important;
      box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3) !important;
    }

    .stripe-checkout-btn.credits-15:hover {
      box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4) !important;
    }

    .compare-btn.enabled {
      background: #2248bc;
      color: white;
      cursor: pointer;
      opacity: 1;
    }

    .compare-btn.enabled:hover {
      background: #1a3a9e;
    }
    
    /* Mobile-friendly modal styles */
    @media (max-width: 768px) {
      .swal2-popup-custom {
        width: 95% !important;
        margin: 10px !important;
      }
      
      .swal2-popup-custom .swal2-html-container {
        max-height: 60vh !important;
        overflow-y: auto !important;
      }
    }
    
    /* Comparison results styling */
    .comparison-card {
      border: 1px solid #e9ecef;
      border-radius: 12px;
      padding: 16px;
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .comparison-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .comparison-metrics {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 12px;
    }
    
    .metric-item {
      text-align: center;
      padding: 8px;
      background: #f8f9fa;
      border-radius: 6px;
      transition: background 0.2s ease;
    }
    
    .metric-item:hover {
      background: #e9ecef;
    }
    
    /* Mobile-friendly comparison section */
    @media (max-width: 768px) {
      #comparisonSection {
        padding: 10px !important;
      }
      
      #comparisonSection h1 {
        font-size: 20px !important;
      }
      
      #comparisonSection .grid {
        grid-template-columns: 1fr !important;
      }
    }
    
    /* Dropdown PRO tag styling */
    .pro-tag-dropdown {
      float: right;
      margin-top: 2px;
    }
    
    /* Share options button styling */
    .share-option-btn {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: left;
      width: 100%;
      text-decoration: none;
      color: inherit;
    }
    
    .share-option-btn:hover {
      background: #e9ecef;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    /* Upgrade modal styling */
    .upgrade-features {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 16px;
      margin: 20px 0;
      text-align: left;
    }
    
    .upgrade-features ul {
      margin: 0;
      padding-left: 20px;
      color: #666;
      font-size: 14px;
    }
    
    .upgrade-features li {
      margin-bottom: 6px;
    }
    
    /* Upgrade button hover effects */
    .sidebar-link[data-target="upgrade-pro"]:hover {
      box-shadow: 0 0 15px rgba(142, 124, 255, 0.5) !important;
      transform: translateY(-1px);
    }
    
    /* PRO tag styling */
    .pro-tag, .pro-tag-dropdown {
      background: #8e7cff !important;
      color: white !important;
      font-size: 10px !important;
      padding: 2px 6px !important;
      border-radius: 4px !important;
      margin-left: 8px !important;
      font-weight: bold !important;
      vertical-align: middle !important;
      display: inline-block !important;
    }
    
    /* Mobile responsiveness for PRO elements */
    @media (max-width: 768px) {
      .pro-tag, .pro-tag-dropdown {
        font-size: 9px !important;
        padding: 1px 4px !important;
        margin-left: 6px !important;
      }
      
      .sidebar-link[data-target="upgrade-pro"] {
        font-size: 14px !important;
        padding: 10px 12px !important;
      }
    }

  .gauge-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 24px;
  padding: 40px 20px;
}

.gauge-box {
  background-color: #124582;
  border-radius: 16px;
  padding: 20px;
  width: 280px;
  position: relative;
  box-shadow: 0 0 20px rgba(18, 69, 130, 0.7), 0 0 40px rgba(18, 69, 130, 0.5), 0 0 60px rgba(18, 69, 130, 0.3);
  text-align: center;
  color: white;
  transition: transform 0.3s ease;
}

.gauge-box:hover {
  transform: scale(1.03);
}

.gauge-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #fff;
}

.gauge-feedback {
  font-size: 14px;
  margin-top: 10px;
  color: #ccc;
}

/* Responsive for small screens */
@media screen and (max-width: 600px) {
  .gauge-box {
    width: 100%;
    padding: 16px;
  }

  .gauge-title {
    font-size: 16px;
  }

  .gauge-feedback {
    font-size: 13px;
  }
}

.gauge-box canvas {
  margin: 0 auto;
  display: block;
}



    .panel-header-lg {
      padding: 40px 0;
      height: 400px;
    }

    canvas#bigChart {
      max-height: 100%;
      max-width: 100%;
    }
  
  .analyzer-form {
  padding: 20px;
  max-width: 600px;
  margin: auto;
  color: #fff;
  font-family: 'Poppins', sans-serif;
}

.analyzer-form h5 {
  font-weight: 600;
  font-size: 18px;
}

.analyzer-form p {
  font-size: 14px;
  color: #bbb;
  margin-bottom: 10px;
}

.analyzer-form input[type="text"] {
  padding: 12px 14px;
  font-size: 15px;
  border-radius: 8px;
  border: none;
  width: 100%;
  margin-bottom: 12px;
}

.upload-box {
  background: #111;
  position: relative;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.7), 0 0 40px rgba(59, 130, 246, 0.5), 0 0 60px rgba(59, 130, 246, 0.3);
  padding: 12px;
  border: 2px dashed #444;
  border-radius: 8px;
  color: #ccc;
  text-align: center;
  cursor: pointer;
  margin-bottom: 10px;
  display: block;
}
.upload-box {
  background-color: black !important;
  color: white;
  border: 1px solid white;
}



.upload-box input[type="file"] {
  display: none;
}

.analyzer-form video {
  width: 100%;
  max-height: 250px;
  border-radius: 10px;
  margin-top: 10px;
  margin-bottom: 15px;
}

.analyzer-form button {
  background: #2248bc;
  border: 1px solid white;
  padding: 12px;
  width: 100%;
  color: white;
  font-weight: 600;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  margin-top: 10px;
}

.loading {
  display: none;
  text-align: center;
  margin-top: 20px;
  color: #bbb;
}

@media (max-width: 600px) {
  .analyzer-form {
    padding: 15px;
  }
}

  .leaderboard-panel {
  background-color: transparent;
  padding: 20px 15px;
  border-radius: 10px;
  color: #fff;
  font-family: 'Poppins', sans-serif;
}

.leaderboard-title {
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 10px;
  color: #ffffff;
  border-bottom: 1px solid rgba(255,255,255,0.2);
  padding-bottom: 6px;
}

.leaderboard-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.leaderboard-list li {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
  border-bottom: 1px dashed rgba(255,255,255,0.1);
}

.rank {
  width: 30px;
  font-weight: bold;
}

.user {
  flex: 1;
  margin-left: 5px;
}

.score {
  font-weight: bold;
}

.view-all-link {
  display: block;
  margin-top: 10px;
  color: #fff;
  text-decoration: underline;
  font-size: 13px;
  text-align: center;
}

/* Dynamic Leaderboard Styles */
.leaderboard-content {
  position: relative;
}

.loading-item {
  text-align: center;
  color: #94a3b8;
  font-style: italic;
  padding: 20px 0;
}

.leaderboard-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 0;
  border-bottom: 1px dashed rgba(255,255,255,0.1);
  transition: all 0.3s ease;
}

.leaderboard-item.current-user {
  background: rgba(59, 130, 246, 0.2);
  border-radius: 6px;
  padding: 8px 6px;
  margin: 2px 0;
  border: 1px solid rgba(59, 130, 246, 0.4);
  box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
}

.leaderboard-item .rank {
  width: 30px;
  font-weight: bold;
  text-align: center;
}

.leaderboard-item .user-info {
  display: flex;
  align-items: center;
  flex: 1;
  margin: 0 10px;
}

.leaderboard-item .user-avatar {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  margin-right: 8px;
  object-fit: cover;
  border: 1px solid rgba(255,255,255,0.2);
}

.leaderboard-item .username {
  font-size: 13px;
  color: #e2e8f0;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.leaderboard-item .score {
  font-weight: bold;
  color: #3b82f6;
  min-width: 30px;
  text-align: right;
}

.user-rank-display {
  margin-top: 15px;
  padding: 10px;
  background: rgba(59, 130, 246, 0.1);
  border: 1px solid rgba(59, 130, 246, 0.3);
  border-radius: 8px;
}

.user-rank-box {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 13px;
}

.user-rank-label {
  color: #94a3b8;
}

.user-rank-value {
  color: #3b82f6;
  font-weight: bold;
}

.user-rank-score {
  color: #10b981;
  font-weight: bold;
}

.leaderboard-footer {
  margin-top: 15px;
  padding-top: 10px;
  border-top: 1px solid rgba(255,255,255,0.1);
}

.reset-info {
  margin-bottom: 10px;
  text-align: center;
}

.reset-info small {
  color: #94a3b8;
  font-size: 11px;
  display: block;
  margin-bottom: 5px;
}

.countdown-container {
  margin-top: 5px;
}

/* Countdown Timer Styles */
.countdown-timer {
  font-size: 1.2rem;
  font-weight: bold;
  color: #e0e0e0;
  position: relative;
  display: inline-block;
  text-shadow: 0 0 8px rgba(255,255,255,0.3);
  overflow: hidden;
  animation: brighten 2s infinite;
}

.countdown-timer::before {
  content: "";
  position: absolute;
  top: 0; left: -100%;
  height: 100%; width: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
  animation: shine 4s infinite;
}

.countdown-digit {
  display: inline-block;
  margin: 0 2px;
  animation: pulse 1s infinite;
}

@keyframes shine {
  0% { left: -100%; }
  50% { left: 100%; }
  100% { left: 100%; }
}

@keyframes brighten {
  0%, 100% { color: #e0e0e0; text-shadow: 0 0 8px rgba(255,255,255,0.3); }
  50% { color: #ffffff; text-shadow: 0 0 12px rgba(255,255,255,0.6); }
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.user-profile {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px 15px;
  background-color: rgba(255,255,255,0.05);
  border-radius: 8px;
  margin: 10px 0;
}

.user-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  width: 100%;
}

.user-info .username {
  color: #fff;
  font-size: 16px;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
  display: block;
  margin-bottom: 12px;
  text-align: center;
}

.user-badges {
  display: flex;
  flex-direction: row;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
}

/* Responsive design for small screens */
@media (max-width: 768px) {
  .user-badges {
    flex-direction: column;
    gap: 6px;
  }
  
  .user-rank-badge,
  .plan-status {
    width: 100%;
    max-width: 200px;
  }
}

.edit-profile-link {
  font-size: 12px;
  color: #93c5fd;
  text-decoration: underline;
}


#analyzeBtn {
  border: 1px solid white !important;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
}






#go-pro-section {
  margin-bottom: 0 !important;
  border-bottom: none !important;
}

/* CSS Override to ensure free gauges are always clear */
#soundGaugeCard,
#viewerGaugeCard {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  background: #124582 !important; /* match normal gauge background */
}

#soundGaugeCard::after,
#viewerGaugeCard::after {
  display: none !important;
  content: none !important;
}

        /* Legal Modal Styles - Isolated */
        .legal-modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 10000 !important;
            display: none !important;
            align-items: center !important;
            justify-content: center !important;
            background: rgba(0, 0, 0, 0.7) !important;
            backdrop-filter: blur(5px) !important;
        }

        .legal-modal.show {
            display: flex !important;
        }

        .legal-modal-overlay {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            cursor: pointer !important;
        }

        .legal-modal-content {
            position: relative !important;
            background: linear-gradient(135deg, rgba(30, 30, 64, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            border-radius: 16px !important;
            padding: 0 !important;
            max-width: 90% !important;
            width: 600px !important;
            max-height: 80vh !important;
            overflow: hidden !important;
            backdrop-filter: blur(20px) !important;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important;
        }

        .legal-modal-header {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            padding: 24px 32px !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
            background: rgba(255, 255, 255, 0.05) !important;
        }

        .legal-modal-title {
            font-size: 1.5rem !important;
            font-weight: 600 !important;
            color: white !important;
            margin: 0 !important;
        }

        /* Navbar and Controls Styles */
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Ensure navigation is always visible on desktop */
        .navbar-nav {
            display: flex !important;
            align-items: center;
            gap: 1.5rem;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
        }

        /* Override any conflicting styles */
        header nav.navbar-nav {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
        }

        header nav.navbar-nav a {
            display: inline-block !important;
            visibility: visible !important;
            opacity: 1 !important;
            white-space: nowrap !important;
            flex-shrink: 0 !important;
        }

        /* Force horizontal layout for navigation */
        .hidden.md\:flex.space-x-6 {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            align-items: center !important;
            gap: 1.5rem !important;
        }

        /* Ensure each link is inline */
        .hidden.md\:flex.space-x-6 a {
            display: inline-block !important;
            white-space: nowrap !important;
            flex-shrink: 0 !important;
        }

        /* Additional aggressive fixes for navigation layout */
        header .flex.justify-between.items-center nav {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            align-items: center !important;
            gap: 1.5rem !important;
        }

        header .flex.justify-between.items-center nav a {
            display: inline-block !important;
            white-space: nowrap !important;
            flex-shrink: 0 !important;
            margin: 0 !important;
            padding: 0 !important;
        }

        /* Override any potential flex-col or block display */
        nav.navbar-nav.hidden.md\:flex.space-x-6,
        nav.navbar-nav.hidden.md\:flex.space-x-6 * {
            display: inline-block !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
        }

        /* Force horizontal layout with proper spacing */
        header nav.navbar-nav {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            align-items: center !important;
            gap: 2rem !important;
            margin: 0 !important;
            padding: 0 !important;
        }

        header nav.navbar-nav a {
            display: inline-block !important;
            white-space: nowrap !important;
            flex-shrink: 0 !important;
            margin: 0 !important;
            padding: 0.5rem 0 !important;
            text-decoration: none !important;
        }

        /* Ensure Report Issue button is visible */
        header .hidden.md\:flex {
            display: flex !important;
            align-items: center !important;
        }

        /* Force the entire header layout */
        header .flex.justify-between.items-center {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            width: 100% !important;
        }

        /* Ensure logo has proper spacing and doesn't get cut off */
        header .flex.justify-between.items-center > div:first-child {
            margin-left: 2rem !important;
            padding-left: 0.5rem !important;
            z-index: 10 !important;
        }

        /* Logo styling to ensure visibility */
        header .gradient-text {
            position: relative !important;
            z-index: 10 !important;
        }

        /* Specific targeting for navigation links */
        header nav.navbar-nav.hidden.md\:flex.space-x-6 {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            align-items: center !important;
            gap: 2rem !important;
            margin: 0 !important;
            padding: 0 !important;
        }

        header nav.navbar-nav.hidden.md\:flex.space-x-6 a {
            display: inline-block !important;
            white-space: nowrap !important;
            flex-shrink: 0 !important;
            margin: 0 !important;
            padding: 0.5rem 0 !important;
            text-decoration: none !important;
            color: #d1d5db !important;
        }

        header nav.navbar-nav.hidden.md\:flex.space-x-6 a:hover {
            color: white !important;
        }

        /* Ensure Report Issue button container is visible */
        header div.hidden.md\:flex {
            display: flex !important;
            align-items: center !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Report Issue Modal Styles */
        #reportIssueModal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.6) !important;
            backdrop-filter: blur(8px) !important;
            display: none !important;
            align-items: center !important;
            justify-content: center !important;
            z-index: 9999 !important;
        }

        #reportIssueModal.show {
            display: flex !important;
        }

        #modalContent {
            background: rgba(17, 24, 39, 0.95) !important;
            backdrop-filter: blur(20px) !important;
            border: 1px solid rgba(75, 85, 99, 0.5) !important;
            border-radius: 16px !important;
            padding: 32px !important;
            max-width: 448px !important;
            width: 100% !important;
            margin: 0 16px !important;
            transform: scale(0.95) !important;
            opacity: 0 !important;
            transition: all 0.3s ease !important;
            position: relative !important;
            z-index: 10000 !important;
            display: block !important;
            min-height: 200px !important;
            color: white !important;
            box-shadow: 0 0 50px rgba(255, 255, 255, 0.3) !important;
        }

        #modalContent.show {
            transform: scale(1) !important;
            opacity: 1 !important;
            display: block !important;
            visibility: visible !important;
        }

        /* Force all modal content to be visible */
        #modalContent * {
            color: inherit !important;
            visibility: visible !important;
        }

        #modalContent h2,
        #modalContent label,
        #modalContent input,
        #modalContent textarea,
        #modalContent button {
            color: white !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        @media (max-width: 768px) {
            .navbar-nav {
                display: none !important;
            }
        }

        .mascot-glow {
            filter: drop-shadow(0 0 8px rgba(102, 126, 234, 0.6));
        }

        .btn-gradient-red {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            transition: all 0.3s ease;
        }

        .btn-gradient-red:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.4);
        }

        /* Controls Section Hover Effects */
        .upload-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        #analyzeBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .controls-section {
                padding: 20px 15px;
            }
            
            .upload-label, #analyzeBtn {
                min-width: 160px;
                padding: 14px 24px;
                font-size: 14px;
            }
        }

        .legal-modal-close {
            background: none !important;
            border: none !important;
            color: #8fa3c7 !important;
            font-size: 1.5rem !important;
            cursor: pointer !important;
            padding: 8px !important;
            border-radius: 8px !important;
            transition: all 0.2s ease !important;
            width: 40px !important;
            height: 40px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .legal-modal-close:hover {
            background: rgba(255, 255, 255, 0.1) !important;
            color: white !important;
        }

        .legal-modal-body {
            padding: 32px !important;
            max-height: calc(80vh - 120px) !important;
            overflow-y: auto !important;
        }

        .legal-modal-summary {
            background: rgba(59, 130, 246, 0.1) !important;
            border: 1px solid rgba(59, 130, 246, 0.2) !important;
            border-radius: 8px !important;
            padding: 16px !important;
            margin-bottom: 24px !important;
        }

        .legal-modal-summary p {
            margin: 0 !important;
            color: #e2e8f0 !important;
            font-size: 0.95rem !important;
            line-height: 1.5 !important;
        }

        .legal-modal-content-text h3 {
            color: white !important;
            font-size: 1.25rem !important;
            font-weight: 600 !important;
            margin: 24px 0 12px 0 !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding-bottom: 8px !important;
        }

        .legal-modal-content-text h4 {
            color: #e2e8f0 !important;
            font-size: 1.1rem !important;
            font-weight: 500 !important;
            margin: 20px 0 8px 0 !important;
        }

        .legal-modal-content-text p {
            color: #cbd5e1 !important;
            line-height: 1.6 !important;
            margin: 12px 0 !important;
        }

        .legal-modal-content-text ul {
            color: #cbd5e1 !important;
            line-height: 1.6 !important;
            margin: 12px 0 !important;
            padding-left: 20px !important;
        }

        .legal-modal-content-text li {
            margin: 6px 0 !important;
        }

        /* Scrollbar styling for legal modal */
        .legal-modal-body::-webkit-scrollbar {
            width: 6px !important;
        }

        .legal-modal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05) !important;
            border-radius: 3px !important;
        }

        .legal-modal-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2) !important;
            border-radius: 3px !important;
        }

        .legal-modal-body::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3) !important;
        }

        /* Responsive legal modal */
        @media (max-width: 768px) {
            .legal-modal-content {
                width: 95% !important;
                max-height: 90vh !important;
            }

            .legal-modal-header {
                padding: 20px 24px !important;
            }

            .legal-modal-body {
                padding: 24px !important;
                max-height: calc(90vh - 100px) !important;
            }

            .legal-modal-title {
                font-size: 1.25rem !important;
            }
        }

        /* Keep existing specific modal styles for backward compatibility */
        #privacy-modal.modal,
        #terms-modal.modal,
        #support-modal.modal {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            z-index: 1000 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            opacity: 0 !important;
            visibility: hidden !important;
            transition: all 0.3s ease !important;
        }

        #privacy-modal.modal.show,
        #terms-modal.modal.show,
        #support-modal.modal.show {
            opacity: 1 !important;
            visibility: visible !important;
        }

        #privacy-modal.modal.hidden,
        #terms-modal.modal.hidden,
        #support-modal.modal.hidden {
            opacity: 0 !important;
            visibility: hidden !important;
        }

        #privacy-modal .modal-overlay,
        #terms-modal .modal-overlay,
        #support-modal .modal-overlay {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.7) !important;
            backdrop-filter: blur(5px) !important;
        }

        #privacy-modal .modal-content,
        #terms-modal .modal-content,
        #support-modal .modal-content {
            position: relative !important;
            background: linear-gradient(135deg, rgba(30, 30, 64, 0.95) 0%, rgba(20, 20, 40, 0.95) 100%) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            border-radius: 16px !important;
            padding: 0 !important;
            max-width: 90% !important;
            width: 600px !important;
            max-height: 80vh !important;
            overflow: hidden !important;
            backdrop-filter: blur(20px) !important;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3) !important;
            transform: translateY(20px) !important;
            transition: transform 0.3s ease !important;
        }

        #privacy-modal.modal.show .modal-content,
        #terms-modal.modal.show .modal-content,
        #support-modal.modal.show .modal-content {
            transform: translateY(0) !important;
        }

        #privacy-modal .modal-header,
        #terms-modal .modal-header,
        #support-modal .modal-header {
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            padding: 24px 32px !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
            background: rgba(255, 255, 255, 0.05) !important;
        }

        #privacy-modal .modal-title,
        #terms-modal .modal-title,
        #support-modal .modal-title {
            font-size: 1.5rem !important;
            font-weight: 600 !important;
            color: white !important;
            margin: 0 !important;
        }

        #privacy-modal .modal-close,
        #terms-modal .modal-close,
        #support-modal .modal-close {
            background: none !important;
            border: none !important;
            color: #8fa3c7 !important;
            font-size: 1.5rem !important;
            cursor: pointer !important;
            padding: 8px !important;
            border-radius: 8px !important;
            transition: all 0.2s ease !important;
            width: 40px !important;
            height: 40px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        #privacy-modal .modal-close:hover,
        #terms-modal .modal-close:hover,
        #support-modal .modal-close:hover {
            background: rgba(255, 255, 255, 0.1) !important;
            color: white !important;
        }

        #privacy-modal .modal-body,
        #terms-modal .modal-body,
        #support-modal .modal-body {
            padding: 32px !important;
            max-height: calc(80vh - 120px) !important;
            overflow-y: auto !important;
        }

        #privacy-modal .modal-summary,
        #terms-modal .modal-summary,
        #support-modal .modal-summary {
            background: rgba(59, 130, 246, 0.1) !important;
            border: 1px solid rgba(59, 130, 246, 0.2) !important;
            border-radius: 8px !important;
            padding: 16px !important;
            margin-bottom: 24px !important;
        }

        #privacy-modal .modal-summary p,
        #terms-modal .modal-summary p,
        #support-modal .modal-summary p {
            margin: 0 !important;
            color: #e2e8f0 !important;
            font-size: 0.95rem !important;
            line-height: 1.5 !important;
        }

        #privacy-modal .modal-content-text h3,
        #terms-modal .modal-content-text h3,
        #support-modal .modal-content-text h3 {
            color: white !important;
            font-size: 1.25rem !important;
            font-weight: 600 !important;
            margin: 24px 0 12px 0 !important;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
            padding-bottom: 8px !important;
        }

        #privacy-modal .modal-content-text h4,
        #terms-modal .modal-content-text h4,
        #support-modal .modal-content-text h4 {
            color: #e2e8f0 !important;
            font-size: 1.1rem !important;
            font-weight: 500 !important;
            margin: 20px 0 8px 0 !important;
        }

        #privacy-modal .modal-content-text p,
        #terms-modal .modal-content-text p,
        #support-modal .modal-content-text p {
            color: #cbd5e1 !important;
            line-height: 1.6 !important;
            margin: 12px 0 !important;
        }

        #privacy-modal .modal-content-text ul,
        #terms-modal .modal-content-text ul,
        #support-modal .modal-content-text ul {
            color: #cbd5e1 !important;
            line-height: 1.6 !important;
            margin: 12px 0 !important;
            padding-left: 20px !important;
        }

        #privacy-modal .modal-content-text li,
        #terms-modal .modal-content-text li,
        #support-modal .modal-content-text li {
            margin: 6px 0 !important;
        }

        /* Scrollbar styling for modal */
        #privacy-modal .modal-body::-webkit-scrollbar,
        #terms-modal .modal-body::-webkit-scrollbar,
        #support-modal .modal-body::-webkit-scrollbar {
            width: 6px !important;
        }

        #privacy-modal .modal-body::-webkit-scrollbar-track,
        #terms-modal .modal-body::-webkit-scrollbar-track,
        #support-modal .modal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05) !important;
            border-radius: 3px !important;
        }

        #privacy-modal .modal-body::-webkit-scrollbar-thumb,
        #terms-modal .modal-body::-webkit-scrollbar-thumb,
        #support-modal .modal-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2) !important;
            border-radius: 3px !important;
        }

        #privacy-modal .modal-body::-webkit-scrollbar-thumb:hover,
        #terms-modal .modal-body::-webkit-scrollbar-thumb:hover,
        #support-modal .modal-body::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3) !important;
        }

        /* Responsive modal */
        @media (max-width: 768px) {
            #privacy-modal .modal-content,
            #terms-modal .modal-content,
            #support-modal .modal-content {
                width: 95% !important;
                max-height: 90vh !important;
            }

            #privacy-modal .modal-header,
            #terms-modal .modal-header,
            #support-modal .modal-header {
                padding: 20px 24px !important;
            }

            #privacy-modal .modal-body,
            #terms-modal .modal-body,
            #support-modal .modal-body {
                padding: 24px !important;
                max-height: calc(90vh - 100px) !important;
            }

            #privacy-modal .modal-title,
            #terms-modal .modal-title,
            #support-modal .modal-title {
                font-size: 1.25rem !important;
            }
        }

        .modal-summary {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .modal-summary p {
            margin: 0;
            color: #e2e8f0;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .modal-content-text h3 {
            color: white;
            font-size: 1.25rem;
            font-weight: 600;
            margin: 24px 0 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 8px;
        }

        .modal-content-text h4 {
            color: #e2e8f0;
            font-size: 1.1rem;
            font-weight: 500;
            margin: 20px 0 8px 0;
        }

        .modal-content-text p {
            color: #cbd5e1;
            line-height: 1.6;
            margin: 12px 0;
        }

        .modal-content-text ul {
            color: #cbd5e1;
            line-height: 1.6;
            margin: 12px 0;
            padding-left: 20px;
        }

        .modal-content-text li {
            margin: 6px 0;
        }

        /* Scrollbar styling for modal */
        .modal-body::-webkit-scrollbar {
            width: 6px;
        }

        .modal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .modal-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        .modal-body::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Responsive modal */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                max-height: 90vh;
            }

            .modal-header {
                padding: 20px 24px;
            }

            .modal-body {
                padding: 24px;
                max-height: calc(90vh - 100px);
            }

            .modal-title {
                font-size: 1.25rem;
            }
        }

  </style>



  <div id="main-wrapper" style="flex: 1;">
  <!-- all your content goes here -->

        <!-- Header -->
        <header class="bg-gray-900/50 backdrop-blur-md border-b border-gray-800 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4" style="margin-left: 3rem;">
                    <!-- Logo -->
                    <div class="flex items-center" style="margin-left: 2rem;">
                        <a href="/index.html" class="text-2xl font-bold gradient-text flex items-center">
                            <img src="assets/img/mascot.png" alt="CopyBoss Mascot" class="h-8 w-auto mr-2 md:h-8 max-h-6 md:max-h-8 mascot-glow">
                            CopyBoss
                        </a>
                    </div>
                    
                    <!-- Navigation -->
                    <nav class="navbar-nav hidden md:flex space-x-8" style="margin-left: 2rem;">
                        <a href="/index.html" class="text-gray-300 hover:text-white transition-colors duration-200">Home</a>
                        <a href="/analyzer.html" class="text-gray-300 hover:text-white transition-colors duration-200">Analyzer</a>
                        <a href="/generator.html" class="text-gray-300 hover:text-white transition-colors duration-200">Generator</a>
                        <a href="/pricing.html" class="text-gray-300 hover:text-white transition-colors duration-200">Pricing</a>
                        <a href="https://copy-boss.com/community/" class="text-gray-300 hover:text-white transition-colors duration-200">Community Hub</a>
                        <a href="login.html" class="text-gray-300 hover:text-white transition-colors duration-200">Login</a>
                        <a href="signup.html" class="text-gray-300 hover:text-white transition-colors duration-200">Sign Up</a>
                    </nav>
                    
                    <!-- Upload and Analyze Buttons -->
                    <div class="hidden md:flex items-center space-x-4">
                        <!-- Upload Button -->
                        <input type="file" id="file-upload" style="display: none;" onchange="handleFileUpload(event)">
                        <label for="file-upload" class="upload-label new-upload-btn" style="
                            display: inline-flex;
                            align-items: center;
                            padding: 12px 20px;
                            background: linear-gradient(135deg, #10b981, #059669);
                            color: #fff;
                            border-radius: 8px;
                            font-weight: 600;
                            cursor: pointer;
                            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
                            transition: all 0.3s ease;
                            font-size: 14px;
                            min-width: 160px;
                            justify-content: center;
                        ">
                            <i class="fa-sharp fa-solid fa-upload" style="margin-right: 8px;"></i>
                            Upload Video
                        </label>
                        
                        <!-- Analyze Button -->
                        <button id="analyzeBtn" onclick="runAnalysis()" style="
                            display: inline-flex;
                            align-items: center;
                            padding: 12px 20px;
                            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
                            color: #fff;
                            border: none;
                            border-radius: 8px;
                            font-weight: 600;
                            cursor: pointer;
                            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
                            transition: all 0.3s ease;
                            font-size: 14px;
                            min-width: 120px;
                            justify-content: center;
                        ">
                            <i class="fas fa-chart-line" style="margin-right: 8px;"></i>
                            Analyze
                        </button>
                    </div>
                    
                    <!-- Mobile menu button -->
                    <div class="md:hidden">
                        <button type="button" class="text-gray-300 hover:text-white" id="mobile-menu-btn">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Mobile Navigation Menu -->
                <div class="md:hidden" id="mobile-menu" style="display: none;">
                    <div class="px-2 pt-2 pb-3 space-y-1 bg-gray-900/95 backdrop-blur-md rounded-lg mt-2">
                        <a href="/index.html" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Home</a>
                        <a href="/analyzer.html" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Analyzer</a>
                        <a href="/generator.html" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Generator</a>
                        <a href="/pricing.html" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Pricing</a>
                        <a href="https://copy-boss.com/community/" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Community Hub</a>
                        <a href="login.html" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Login</a>
                        <a href="signup.html" class="block px-3 py-2 text-gray-300 hover:text-white hover:bg-gray-800 rounded-md transition-colors duration-200">Sign Up</a>
                        
                        <!-- Mobile Upload and Analyze Buttons -->
                        <div class="pt-2 border-t border-gray-700">
                            <label for="file-upload" class="block px-3 py-2 text-white bg-gradient-to-r from-green-600 to-green-700 hover:from-green-500 hover:to-green-600 rounded-md transition-all duration-200 font-medium text-center">
                                <i class="fa-sharp fa-solid fa-upload mr-2"></i>
                                Upload Video
                            </label>
                            <button onclick="runAnalysis()" class="w-full mt-2 px-3 py-2 text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-500 hover:to-blue-600 rounded-md transition-all duration-200 font-medium">
                                <i class="fas fa-chart-line mr-2"></i>
                                Analyze
                            </button>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </header>



<div class="wrapper">
  <div class="sidebar" data-color="orange">
    <div class="logo">
      <div style="display: flex; align-items: center; padding: 15px 15px;">
        <img src="assets/img/mascot.png" alt="CopyBoss Mascot" style="height: 26px; width: auto; margin-right: 6px;">
        <span style="color: white; font-weight: bold; font-size: 18px; font-family: 'Montserrat', 'Helvetica Neue', Helvetica, Arial, sans-serif;">VideoBoss</span>
      </div>
    </div>








   <div class="sidebar-wrapper" id="sidebar-wrapper">
  <ul class="nav">
    <!-- DASHBOARD (static title, no link) -->
    <li class="active">
      <a href="#"><p>Dashboard</p></a>
    </li>

   <!-- Functional Buttons with Scroll Targets -->
<ul>
  <!-- Group 1: Main Features -->
  <li><a href="#" class="sidebar-btn" data-target="dashboard">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </div>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" data-target="analyzer-history">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-history"></i>
        <span>Analyzer History</span>
      </div>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" data-target="download-results">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-download"></i>
        <span>Download Results</span>
      </div>
      <span class="pro-badge">PRO</span>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" data-target="share-report">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-share-alt"></i>
        <span>Share Report</span>
      </div>
      <span class="pro-badge">PRO</span>
    </div>
  </a></li>
  
  <!-- Divider -->
  <div class="sidebar-divider"></div>
  
  <!-- Group 2: Upgrade/Buy Reports -->
  <li><a href="#" class="sidebar-btn" onclick="redirectToStripeCheckout('pro')">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-star"></i>
        <span>Upgrade to Pro</span>
      </div>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" onclick="redirectToStripeCheckout('2reports')">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-shopping-cart"></i>
        <span>Buy 2 Reports</span>
      </div>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" onclick="redirectToStripeCheckout('15reports')">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-shopping-cart"></i>
        <span>Buy 15 Reports</span>
      </div>
    </div>
  </a></li>
  
  <!-- Divider -->
  <div class="sidebar-divider"></div>
  
  <!-- Group 3: Settings & Tools -->
  <li><a href="#" class="sidebar-btn" data-target="settings-section">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-cog"></i>
        <span>Settings</span>
      </div>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" data-target="insights-section">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-chart-line"></i>
        <span>Insights</span>
      </div>
    </div>
  </a></li>
  <li><a href="#" class="sidebar-btn" data-target="ai-tips">
    <div class="btn-label">
      <div style="display: flex; align-items: center; gap: 8px;">
        <i class="fa-solid fa-lightbulb"></i>
        <span>AI Tips</span>
      </div>
    </div>
  </a></li>

</ul>





    
<div class="user-profile">
  <div class="user-info">
    <div class="username" id="loggedInName" title="@YourName">@YourName</div>
    
    <!-- Horizontal badge layout -->
    <div class="user-badges">
      <div class="user-rank-badge" title="Your current content rank based on viral scores. Updates automatically!">
        <i class="fa-sharp fa-solid fa-fire-flame-curved flame-icon"></i>
        <span class="badge-label">Rank:</span>
        <span class="badge-value" id="userRank">⚡ Content Climber Master Elite</span>
      </div>
      
      <div class="plan-status" id="planStatus" title="Your current plan and credits">
        <i class="fa-sharp fa-solid fa-crown"></i>
        <span class="badge-label">Plan:</span>
        <span class="badge-value" id="userPlan">Free Plan</span>
      </div>
    </div>
  </div>
</div>


<script>
  // Check if user is logged in and update UI accordingly
  async function checkUserStatus() {
    try {
      const response = await fetch('/api/me', {
        method: 'GET',
        credentials: 'include'
      });
      
      if (response.ok) {
        // User is authenticated, update UI
        const data = await response.json();
        const usernameElement = document.getElementById('loggedInName');
        const displayName = '@' + (data.user.username || data.user.email);
        usernameElement.textContent = displayName;
        usernameElement.title = displayName; // Update tooltip with full username
        
        // Show user profile section
        document.querySelector('.user-profile').style.display = 'flex';
      } else {
        // User is not logged in, hide user profile section
        document.querySelector('.user-profile').style.display = 'none';
      }
      
    } catch (error) {
      console.error('User status check error:', error);
      // Fallback to localStorage check for legacy support
      const name = localStorage.getItem('videobossUser');
      if (name) {
        const usernameElement = document.getElementById('loggedInName');
        const displayName = '@' + name;
        usernameElement.textContent = displayName;
        usernameElement.title = displayName;
        document.querySelector('.user-profile').style.display = 'flex';
      } else {
        document.querySelector('.user-profile').style.display = 'none';
      }
    }
  }

  // Check user status on page load
  checkUserStatus();

  window.logout = function () {
    localStorage.removeItem("videobossUser");
    window.location.href = "index.html";
  };
</script>





    
    
            <div class="leaderboard-panel">
              <h3 class="leaderboard-title" id="leaderboard-title">🏆 Top 10 Today</h3>
              <div id="leaderboard-content">
                <ul class="leaderboard-list" id="leaderboard-list">
                  <li class="loading-item">Loading leaderboard...</li>
                </ul>
                <div id="user-rank-display" class="user-rank-display" style="display: none;">
                  <div class="user-rank-box">
                    <span class="user-rank-label">Your Rank:</span>
                    <span class="user-rank-value" id="user-rank-value">#0</span>
                    <span class="user-rank-score" id="user-rank-score">Score: 0</span>
                  </div>
                </div>
              </div>
              <div class="leaderboard-footer">
                <div class="reset-info">
                  <small>Weekly leaderboard resets every Sunday at midnight (UTC).</small>
                  <div id="sidebar-countdown" class="countdown-container"></div>
                </div>
                <a href="/leaderboard.html" class="view-all-link">View Full Leaderboard ➜</a>
              </div>
            </div>

  
     
     
     </ul>

         <!-- Social icons -->
<div class="sidebar-social-container">
  <div class="social-label">Follow Us</div>
  <div class="sidebar-social-icons">
    <a href="https://www.tiktok.com/@copybosshq?lang=en-GB" target="_blank" rel="noopener noreferrer">
      <div class="social-icon tiktok" title="TikTok"></div>
    </a>
    <a href="https://www.instagram.com/copybosshq/" target="_blank" rel="noopener noreferrer">
      <div class="social-icon instagram" title="Instagram"></div>
    </a>
    <a href="https://www.youtube.com/@CopybossHQ" target="_blank" rel="noopener noreferrer">
      <div class="social-icon youtube" title="YouTube"></div>
    </a>
    <a href="https://x.com/copybosshq" target="_blank" rel="noopener noreferrer">
      <div class="social-icon twitter" title="Twitter/X"></div>
    </a>
  </div>
</div>


    
    
    </div>
  </div>
    
    
  
  
  






   <div class="analyzer-wrapper">
      <!-- Live Data Indicator -->
  <div style="
    position: fixed;
    top: 10px;
    right: 10px;
    background: #00ff00;
    color: #000;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: bold;
    z-index: 1000;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  ">
    🔴 LIVE API
  </div>




<!-- Results will be displayed in the gauge cards and report sections -->














 


      <!-- ✅ COPYBOSS GRAPH SECTION - Creative Tim Style Clone -->
<div class="chart-card" style="
  background: #1a233a;
  padding: 20px;
  padding-left: 80px; /* tweak until it looks even */

  border-radius: 12px;
  color: #fff;
  position: relative;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  margin: 30px auto;
  max-width: 1480px;
  width: 95%;
">

<div id="compareOutput" style="margin-top: 20px; color: #ccc; font-size: 14px; font-style: italic;"></div>




  <!-- Top Right Tools -->
  <div style="position: absolute; top: 20px; right: 8px; display: flex; gap: 12px; align-items: center; overflow: visible;">
    <!-- Search Bar -->
    <input type="text" class="top-search-input" placeholder="Search history...">


     <!-- Dropdown Menu -->
         
    <div class="dropdown" style="position: relative; overflow: visible;">
     <button id="dropdownToggleBtn" style="background: #2e3b5e; border: none; border-radius: 8px; padding: 8px 12px; color: #fff; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; min-width: 40px; height: 40px;">
        &#8942;
      </button>
    <div id="dropdownMenu" style="display: none; position: absolute; right: 0; top: 44px; background: #2e3b5e; border-radius: 6px; box-shadow: 0 2px 10px rgba(0,0,0,0.3); min-width: 180px; max-width: 200px; z-index: 1000;">
  <a href="#" id="compareBtn" style="display: block; padding: 10px 14px; color: #fff; text-decoration: none;">Compare With Past Videos</a>
  <a href="#" id="shareBtn" style="display: block; padding: 10px 14px; color: #fff; text-decoration: none;">
    Share This Graph
    <span class="pro-tag-dropdown" style="background: #8e7cff; color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-left: 8px; font-weight: bold; vertical-align: middle;">PRO</span>
  </a>
  <a href="#" id="exportBtn" style="display: block; padding: 10px 14px; color: #fff; text-decoration: none;">
    Export as Image
    <span class="pro-tag-dropdown" style="background: #8e7cff; color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-left: 8px; font-weight: bold; vertical-align: middle;">PRO</span>
  </a>
<a href="#" id="resetChartBtn" style="display: block; padding: 10px 14px; color: #fff; text-decoration: none;">🔁 Reset Chart</a>

<a href="#" id="graphHelpBtn" style="display: block; padding: 10px 14px; color: #fff; text-decoration: none;">📘 Graph Help</a>


</div>


    </div>
  </div>




  <!-- Graph Area -->
  
<!-- Graph Area -->
<div style="width: 100%; padding: 60px 40px; display: flex; justify-content: center;">
  <canvas id="copyBossChart" height="300" style="display: block; width: 100%; max-width: 1350px;"></canvas>
</div>








<script>
let copyBossChart;

// --- Gemini feedback global ---
window.feedback = {};

function injectGeminiFeedbackToDOM() {
  const fb = window.feedback || {};
  // 1. AI Summary
  document.getElementById('aiSummary') && (document.getElementById('aiSummary').innerText = fb.summary || 'Not available');
  // 2. Score Breakdown
  if (document.getElementById('scoreBreakdown')) {
    document.getElementById('scoreBreakdown').innerHTML = `
      <ul style="list-style:none;padding:0;">
        <li><b>Viral Score:</b> ${fb.viralScore ?? 'Not available'}</li>
        <li><b>Hook Strength:</b> ${fb.hookScore ?? 'Not available'}</li>
        <li><b>Caption Clarity:</b> ${fb.captionScore ?? 'Not available'}</li>
        <li><b>Video Structure:</b> ${fb.videoStructure ?? 'Not available'}</li>
        <li><b>Audio Match:</b> ${fb.audioMatchScore ?? 'Not available'}</li>
        <li><b>Engagement:</b> ${fb.engagementScore ?? 'Not available'}</li>
      </ul>
    `;
  }
  // 3. Full Feedback
  document.getElementById('fullFeedback') && (document.getElementById('fullFeedback').innerText = fb.details || 'Not available');
}

function syncGaugesFromGemini() {
  const fb = window.feedback || {};
  // Example: update gauge values if you have gauge update functions
  // updateGauge('viralGauge', fb.viralScore);
  // updateGauge('hookGauge', fb.hookScore);
  // ...
  // For now, just log for debug
  console.log('Syncing gauges from Gemini:', fb);
}
document.addEventListener("DOMContentLoaded", () => {
  // Initialize gauge visibility based on user plan
  initializeGaugeVisibility();
  
  const ctx = document.getElementById("copyBossChart")?.getContext("2d");

  const gradient = ctx.createLinearGradient(0, 0, 0, 300);
  gradient.addColorStop(0, "rgba(30,136,229,0.4)");
  gradient.addColorStop(1, "rgba(30,136,229,0)");

  const defaultLabels = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
  const defaultScores = [35, 50, 60, 45, 70, 55, 65];

  const savedLabels = JSON.parse(localStorage.getItem("copyBossLabels")) || defaultLabels;
  const savedScores = JSON.parse(localStorage.getItem("copyBossScores")) || defaultScores;

  copyBossChart = new Chart(ctx, {
    type: "line",
    data: {
      labels: savedLabels,
      datasets: [{
        label: "Viral Score",
        data: savedScores,
        borderColor: "#1E88E5",
        backgroundColor: gradient,
        fill: true,
        tension: 0.4,
        pointRadius: 4,
        pointBackgroundColor: "#1E88E5",
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false }
      },
      scales: {
        x: {
          ticks: { color: "#fff" },
          grid: { display: false }
        },
        y: {
          ticks: { color: "#fff" },
          grid: { color: "rgba(255,255,255,0.1)" },
          beginAtZero: true,
          max: 100
        }
      }
    }
  });

  

// ✅ RESET CHART — safe version with timeout to ensure button is in DOM
document.addEventListener("click", function (e) {
  if (e.target && e.target.id === "resetChartBtn") {
    if (confirm("Reset chart data?")) {
      copyBossChart.data.labels = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
      copyBossChart.data.datasets[0].data = [35, 50, 60, 45, 70, 55, 65];
      localStorage.removeItem("copyBossLabels");
      localStorage.removeItem("copyBossScores");
      copyBossChart.update();
      console.log("🔄 Chart reset to default");
    }
  }
});


  // 📸 Export chart as image (Pro users only)
  document.getElementById("exportBtn")?.addEventListener("click", (e) => {
    e.preventDefault();
    
    // Close dropdown first
    const menu = document.getElementById("dropdownMenu");
    if (menu) {
      menu.style.display = "none";
    }
    
    // Check user access (Pro or credits)
    if (isProActive()) {
      // Pro user - allow export
      downloadGraphImage();
    } else if (hasCredits()) {
      // Credit user - allow export and optionally decrement credit
      downloadGraphImage();
      // Optionally decrement a credit
      useReportCredit();
    } else {
      // Free user - show upgrade modal
      showUpgradeModal();
    }
  });

  // ☰ Dropdown toggle
  window.toggleDropdown = () => {
    const menu = document.getElementById("dropdownMenu");
    if (menu) {
      menu.style.display = menu.style.display === "block" ? "none" : "block";
    }
  };

  // ✅ Extra buttons (optional)
  document.getElementById("compareBtn")?.addEventListener("click", () => {
    // Close dropdown first
    const menu = document.getElementById("dropdownMenu");
    if (menu) {
      menu.style.display = "none";
    }
    
    // Show comparison modal
    const content = modalContentMap["compare-videos"];
    Swal.fire({
      title: content.title,
      html: content.html,
      showCloseButton: true,
      showConfirmButton: false,
      width: 500,
      customClass: {
        popup: 'swal2-popup-custom'
      }
    });
    
    // Initialize after modal is shown (not when closed)
    setTimeout(() => {
      initializeVideoComparison();
    }, 200);
  });

  document.getElementById("shareBtn")?.addEventListener("click", (e) => {
    e.preventDefault();
    
    // Close dropdown first
    const menu = document.getElementById("dropdownMenu");
    if (menu) {
      menu.style.display = "none";
    }
    
    // Check user access (Pro or credits)
    if (isProActive()) {
      // Pro user - allow sharing
      showShareOptions();
    } else if (hasCredits()) {
      // Credit user - allow sharing and optionally decrement credit
      showShareOptions();
      // Optionally decrement a credit
      useReportCredit();
    } else {
      // Free user - show upgrade modal
      showUpgradeModal();
    }
  });

  document.getElementById("graphHelpBtn")?.addEventListener("click", () => {
    alert("📘 This graph shows your viral score history from previous reports.");
  });
});

document.getElementById("dropdownToggleBtn")?.addEventListener("click", () => {
  const menu = document.getElementById("dropdownMenu");
  if (menu) {
    menu.style.display = menu.style.display === "block" ? "none" : "block";
  }
});



</script>





 
</script>





















<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>





















<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="content" style="margin-top: 30px;">
  <div class="gauge-container" style="display: grid; grid-template-columns: repeat(3, 1fr); column-gap: 28px; row-gap: 24px; max-width: 960px; margin: 30px auto 0; padding-inline: 20px;">

 <div class="gauge-box pro-locked">
  <div class="gauge-title">🔥 Viral Score</div>
  <div id="viralGauge"></div>
  <div class="gauge-feedback" id="viralFeedback" style="margin-top: 12px;">
  🧠 AI Feedback<br>Analyzing your results…
</div>



  <div class="locked-overlay">
   
    <div class="padlock-icon" style="
  position: absolute;
  top: 65%;
  left: 69.5%;
  transform: translate(-50%, -50%);
  width: 110px; /* 👈 increase this to make it bigger */
  height: auto;
  z-index: 10;
">
  <img src="/assets/img/padlock.png" alt="Padlock" style="width: 100%; height: auto;" />
</div>





    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay">


    <button class="btn-upgrade">Unlock with Pro</button>
  </div>
</div>







   <div class="gauge-box pro-locked">
  <div class="gauge-title">🎯 Caption Clarity</div>
  <div id="captionGauge"></div>
  <div class="gauge-feedback" id="captionFeedback" style="margin-top: 12px;">
  🧠 AI Feedback<br>Analyzing your results…
</div>


  <div class="locked-overlay">
  <div class="padlock-icon" style="
  position: absolute;
  top: 65%;
  left: 69.5%;
  transform: translate(-50%, -50%);
  width: 110px; /* 👈 increase this to make it bigger */
  height: auto;
  z-index: 10;
">
  <img src="/assets/img/padlock.png" alt="Padlock" style="width: 100%; height: auto;" />
</div>

    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay">
    <button class="btn-upgrade">Unlock with Pro</button>
  </div>
</div>


    <!-- SOUND GAUGE BLOCK -->
<div class="gauge-box" id="soundGaugeCard">
  <div class="gauge-title">🎵 Sound Match</div>
  <div id="soundGauge"></div>
  <div class="gauge-feedback" id="soundFeedback" style="margin-top: 12px;">
  🧠 AI Feedback<br>Analyzing your results…
</div>

</div>

<!-- VIEWER UNDERSTANDING GAUGE BLOCK -->
<div class="gauge-box" id="viewerGaugeCard">
  <div class="gauge-title">🧠 Viewer Understanding</div>
  <div id="viewerGauge"></div>
  <div class="gauge-feedback" id="viewerFeedback" style="margin-top: 12px;">
    🧠 AI Feedback<br>Analyzing your results…
  </div>
</div>






   <div class="gauge-box pro-locked">
  <div class="gauge-title">📈 Engagement Forecast</div>
  <div id="engagementGauge"></div>
  <div class="gauge-feedback" id="engagementFeedback" style="margin-top: 12px;">
  🧠 AI Feedback<br>Estimating likes, comments & shares…
</div>


  <div class="locked-overlay">
  <div class="padlock-icon" style="
  position: absolute;
  top: 65%;
  left: 69.5%;
  transform: translate(-50%, -50%);
  width: 110px; /* 👈 increase this to make it bigger */
  height: auto;
  z-index: 10;
">
  <img src="/assets/img/padlock.png" alt="Padlock" style="width: 100%; height: auto;" />
</div>

    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay">
    <button class="btn-upgrade">Unlock with Pro</button>
  </div>
</div>


   <div class="gauge-box pro-locked">
  <div class="gauge-title">🧠 Idea Strength</div>
<div id="hookGauge"></div>


 <div class="gauge-feedback" id="hookFeedback" style="margin-top: 12px;">
  🧠 AI Feedback<br>Measuring originality & creative potential…
</div>


  <div class="locked-overlay">
   <div class="padlock-icon" style="
  position: absolute;
  top: 65%;
  left: 69.5%;
  transform: translate(-50%, -50%);
  width: 110px; /* 👈 increase this to make it bigger */
  height: auto;
  z-index: 10;
">
  <img src="/assets/img/padlock.png" alt="Padlock" style="width: 100%; height: auto;" />
</div>

   
   <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay">
    <button class="btn-upgrade">Unlock with Pro</button>
  </div>
</div>
</div>






  <!-- Result Feedback Cards Section -->
 <div id="reportContainer" class="results-card">
 <div class="results-header">
  <div class="results-title">📊 Analysis Report</div>
  <p class="feedback-note">Feedback and breakdown will display here once analysis is complete...</p>
  <div class="results-loading">
    <div class="loading-bar"></div>
    <div class="analyzing-text">Analyzing<span class="dots">...</span></div>
  </div>
</div>

<!-- Optional Overall Score -->
<div class="overall-score" style="text-align: center; margin: 40px auto;">
  <div id="overallScoreCircle" class="score-circle" style="
    width: 100px;
    height: 100px;
    margin: 0 auto 10px;
    border-radius: 50%;
    font-size: 28px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    background: conic-gradient(#005eff, #001f4d);
    box-shadow: 0 0 12px rgba(0, 94, 255, 0.5);
    opacity: 0;
    transition: opacity 2s ease;
  ">0</div>
  <p class="score-label" style="font-size: 16px; color: #aaa;">Overall Score</p>
</div>



<div class="results-section-wrapper" style="margin-bottom: 0px; overflow: visible; position: relative;">






<div class="results-container" style="overflow: visible;">


<!-- 🔥 Viral Score - FINAL CLEANED VERSION -->
<div id="viral-card" class="pro-locked-results" style="
  position: relative;
  background: #062c85;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: visible;
  min-height: 300px;
  padding-bottom: 180px;
  transition: max-height 0.8s ease, opacity 0.4s ease;
  max-height: 60px;
">

  <!-- ⏳ Analyzing Placeholder -->
  <div class="analyzing" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: #aaa;">
    ⏳ Analyzing...
  </div>

  <!-- ✅ Final Result Block -->
  <div class="result-content" style="opacity: 0; padding: 20px; transition: opacity 0.4s ease;">
    <h4 style="margin: 0 0 8px 0; font-size: 18px; font-weight: bold; color: #fff;">
      Viral Score 
      <span style="margin-left: 10px; font-weight: normal;">
        <span id="viralScoreEmoji">🔴</span> | 
        <span id="viralScoreScore">--</span>
|
      </span>
    </h4>

   <p id="viralScoreLabel" class="strength-text" style="color: #c4c0c0; margin-top: 5px;">
  Analyzing...
</p>


    <p id="viralScoreFeedback" style="color: #ccc; margin-top: 10px;"></p>

    <!-- 📄 Detailed Gemini Report -->
    <p id="viralScoreDetailedGemini" style="color: #aaa; font-size: 14px; margin-top: 6px;"></p>

  </div>

  <!-- 🔐 LOCKED OVERLAY -->
  <div class="locked-overlay" style="
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(8px);
    background: rgba(191, 201, 211, 0.15);
    z-index: 9999;
    border-radius: 10px;
  ">
    <!-- Chains (centered) -->
    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay" style="
      width: 300px;
      opacity: 0.7;
      filter: brightness(1.4);
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 5;
    ">

    <!-- Padlock -->
    <div class="padlock-icon" style="
      position: absolute;
      top: 80%;
      left: 55.2%;
      transform: translate(-50%, -80%);
      z-index: 10000;
    ">
      <img src="/assets/img/padlock.png" alt="Padlock" style="width: 120px; height: auto; pointer-events: auto;" />
    </div>

    <!-- CTA Button -->
    <a href="/upgrade" class="btn-upgrade" style="
      position: absolute;
      bottom: 12px;
      right: 16px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #ffffff;
      background-color: #2248bc;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
    ">
      Upgrade to unlock full analysis
    </a>
  </div>
</div>

<!-- ✍️ Caption Score - PRO LOCKED -->
<div id="caption-card" class="pro-locked-results" style="
  position: relative;
  background: #062c85;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: visible;
  min-height: 300px;
  padding-bottom: 180px;
  transition: max-height 0.8s ease, opacity 0.4s ease;
  max-height: 60px;
">



  <!-- ⏳ Analyzing Placeholder -->
  <div class="analyzing" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: #aaa;">
    ⏳ Analyzing...
  </div>

  <!-- ✅ Final Result Block -->
  <div class="result-content" style="opacity: 0; padding: 20px; transition: opacity 0.4s ease;">
    <h4 style="margin: 0 0 8px 0; font-size: 18px; font-weight: bold; color: #fff;">
      Caption Score 
      <span style="margin-left: 10px; font-weight: normal;">
       <span id="captionClarityEmoji">🔴</span>

        <span id="captionClarityScore">--</span>

      </span>
    </h4>

    <p id="captionClarityLabel" class="strength-text" style="color: #c4c0c0; margin-top: 5px;">
  Analyzing...
</p>


    <p id="captionClarityFeedback" style="color: #ccc; margin-top: 10px;"></p>


    <!-- 📄 Detailed Gemini Report -->
   <p id="captionClarityDetailedGemini" style="color: #aaa; font-size: 14px; margin-top: 6px;"></p>

  </div>

  <!-- 🔐 LOCKED OVERLAY -->
  <div class="locked-overlay" style="
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(8px);
    background: rgba(191, 201, 211, 0.15);
    z-index: 9999;
    border-radius: 10px;
  ">
    <!-- Chains (centered) -->
    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay" style="
      width: 300px;
      opacity: 0.7;
      filter: brightness(1.4);
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 5;
    ">

    <!-- Padlock -->
    <div class="padlock-icon" style="
      position: absolute;
      top: 80%;
      left: 55.2%;
      transform: translate(-50%, -80%);
      z-index: 10000;
    ">
      <img src="/assets/img/padlock.png" alt="Padlock" style="width: 120px; height: auto; pointer-events: auto;" />
    </div>

    <!-- CTA Button -->
    <a href="/upgrade" class="btn-upgrade" style="
      position: absolute;
      bottom: 12px;
      right: 16px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #ffffff;
      background-color: #2248bc;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
    ">
      Upgrade to unlock full analysis
    </a>
  </div>
</div>


<!-- 🔊 Sound Match - FREE -->
<div id="soundmatch-card" style="
  position: relative;
  background: #062c85;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: visible;
  min-height: 300px;
  padding-bottom: 40px;
  transition: max-height 0.8s ease, opacity 0.4s ease;
  max-height: 60px;
">

  <!-- ⏳ Analyzing Placeholder -->
  <div class="analyzing" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: #aaa;">
    ⏳ Analyzing...
  </div>

  <!-- ✅ Final Result Block -->
  <div class="result-content" style="opacity: 0; padding: 20px; transition: opacity 0.4s ease;">
    <h4 style="margin: 0 0 8px 0; font-size: 18px; font-weight: bold; color: #fff;">
      Sound Match 
      <span style="margin-left: 10px; font-weight: normal;">
        <span id="soundMatchEmoji">🔴</span> | 
        <span id="soundMatchScore">--</span> |
      </span>
    </h4>

    <p id="soundMatchLabel" class="strength-text" style="color: #c4c0c0; margin-top: 5px;">
      Analyzing...
    </p>

    <p id="soundMatchFeedback" style="color: #ccc; margin-top: 10px;"></p>

    <!-- 📄 Detailed Gemini Report -->
   <p id="soundMatchDetailedGemini" style="color: #aaa; font-size: 14px; margin-top: 6px;"></p>

  </div>
</div>





<!-- 👁️ Viewer Understanding - FREE -->
<div id="viewerunderstanding-card" style="
  position: relative;
  background: #062c85;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: visible;
  min-height: 300px;
  padding-bottom: 40px;
  transition: max-height 0.8s ease, opacity 0.4s ease;
  max-height: 60px;
">

  <!-- ⏳ Analyzing Placeholder -->
  <div class="analyzing" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: #aaa;">
    ⏳ Analyzing...
  </div>

  <!-- ✅ Final Result Block -->
  <div class="result-content" style="opacity: 0; padding: 20px; transition: opacity 0.4s ease;">
    <h4 style="margin: 0 0 8px 0; font-size: 18px; font-weight: bold; color: #fff;">
      Viewer Understanding 
      <span style="margin-left: 10px; font-weight: normal;">
        <span id="viewerUnderstandingEmoji">🔴</span> | 
        <span id="viewerUnderstandingScore">--</span> |
      </span>
    </h4>

    <p id="viewerUnderstandingLabel" class="strength-text" style="color: #c4c0c0; margin-top: 5px;">
      Analyzing...
    </p>

    <p id="viewerUnderstandingFeedback" style="color: #ccc; margin-top: 10px;"></p>

    <!-- 📄 Detailed Gemini Report -->
   <p id="viewerUnderstandingDetailedGemini" style="color: #aaa; font-size: 14px; margin-top: 6px;"></p>

  </div>
</div>


<!-- 📈 Engagement Forecast - PRO LOCKED -->
<div id="engagementforecast-card" class="pro-locked-results" style="
  position: relative;
  background: #062c85;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: visible;
  min-height: 300px;
  padding-bottom: 180px;
  transition: max-height 0.8s ease, opacity 0.4s ease;
  max-height: 60px;
">

  <!-- ⏳ Analyzing Placeholder -->
  <div class="analyzing" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: #aaa;">
    ⏳ Analyzing...
  </div>

  <!-- ✅ Final Result Block -->
  <div class="result-content" style="opacity: 0; padding: 20px; transition: opacity 0.4s ease;">
    <h4 style="margin: 0 0 8px 0; font-size: 18px; font-weight: bold; color: #fff;">
      Engagement Forecast 
      <span style="margin-left: 10px; font-weight: normal;">
        <span id="engagementForecastEmoji">🔴</span> | 
        <span id="engagementForecastScore">--</span> |
      </span>
    </h4>

    <p id="engagementForecastLabel" class="strength-text" style="color: #c4c0c0; margin-top: 5px;">
      Analyzing...
    </p>

    <p id="engagementForecastFeedback" style="color: #ccc; margin-top: 10px;"></p>

    <!-- 📄 Detailed Gemini Report -->
   <p id="engagementForecastDetailedGemini" style="color: #aaa; font-size: 14px; margin-top: 6px;"></p>

  </div>

  <!-- 🔐 LOCKED OVERLAY -->
  <div class="locked-overlay" style="
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(8px);
    background: rgba(191, 201, 211, 0.15);
    z-index: 9999;
    border-radius: 10px;
  ">
    <!-- Chains (centered) -->
    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay" style="
      width: 300px;
      opacity: 0.7;
      filter: brightness(1.4);
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 5;
    ">

    <!-- Padlock -->
    <div class="padlock-icon" style="
      position: absolute;
      top: 80%;
      left: 55.2%;
      transform: translate(-50%, -80%);
      z-index: 10000;
    ">
      <img src="/assets/img/padlock.png" alt="Padlock" style="width: 120px; height: auto; pointer-events: auto;" />
    </div>

    <!-- CTA Button -->
    <a href="/upgrade" class="btn-upgrade" style="
      position: absolute;
      bottom: 12px;
      right: 16px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #ffffff;
      background-color: #2248bc;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
    ">
      Upgrade to unlock full analysis
    </a>
  </div>
</div>







<!-- 🧬 Viral Strength - PRO LOCKED -->
<div id="viralstrength-card" class="pro-locked-results" style="
  position: relative;
  background: #062c85;
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: visible;
  min-height: 300px;
  padding-bottom: 180px;
  transition: max-height 0.8s ease, opacity 0.4s ease;
  max-height: 60px;
">

  <!-- ⏳ Analyzing Placeholder -->
  <div class="analyzing" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 14px;
    color: #aaa;">
    ⏳ Analyzing...
  </div>

<!-- ✅ Viral Strength Result Block -->
<div class="result-content" style="opacity: 0; padding: 20px; transition: opacity 0.4s ease;">
  <h4 style="margin: 0 0 8px 0; font-size: 18px; font-weight: bold; color: #fff;">
    Viral Strength 
    <span style="margin-left: 10px; font-weight: normal;">
      <span id="viralStrengthEmoji">🔴</span> | 
      <span id="viralStrengthScore">--</span> |
    </span>
  </h4>

  <!-- 🔁 This line is not being updated -->
 <p id="hookStrengthLabel" class="strength-text" style="color: #c4c0c0; margin-top: 5px;">Analyzing...</p>



  <p id="viralStrengthFeedback" style="color: #ccc; margin-top: 10px;"></p>

  <!-- 📄 Detailed Gemini Report -->
  <p id="viralStrengthDetailedGemini" style="color: #aaa; font-size: 14px; margin-top: 6px;"></p>
</div>


  <!-- 🔐 LOCKED OVERLAY -->
  <div class="locked-overlay" style="
    display: flex;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(8px);
    background: rgba(191, 201, 211, 0.15);
    z-index: 9999;
    border-radius: 10px;
  ">
    <!-- Chains (centered) -->
    <img class="lock-image" src="/assets/img/locked-overlay-chains.png" alt="Locked Overlay" style="
      width: 300px;
      opacity: 0.7;
      filter: brightness(1.4);
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 5;
    ">

    <!-- Padlock -->
    <div class="padlock-icon" style="
      position: absolute;
      top: 80%;
      left: 55.2%;
      transform: translate(-50%, -80%);
      z-index: 10000;
    ">
      <img src="/assets/img/padlock.png" alt="Padlock" style="width: 120px; height: auto; pointer-events: auto;" />
    </div>

    <!-- CTA Button -->
    <a href="/upgrade" class="btn-upgrade" style="
      position: absolute;
      bottom: 12px;
      right: 16px;
      padding: 8px 16px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #ffffff;
      background-color: #2248bc;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
    ">
      Upgrade to unlock full analysis
    </a>
  </div>
</div>
















</div>







<script>
  function revealCard(cardId) {
    const card = document.getElementById(cardId);
    if (!card) return;

    const analyzing = card.querySelector('.analyzing');
    const content = card.querySelector('.result-content');

    setTimeout(() => {
      if (analyzing) analyzing.style.display = 'none';
      if (content) content.style.opacity = 1;
    }, 2000);
  }

  revealCard('viral-card');
  revealCard('caption-card');
  revealCard('soundmatch-card');
  revealCard('viewerunderstanding-card');
  revealCard('engagementforecast-card');
  revealCard('viralstrength-card');
</script>













  <!-- Core JS -->
  <script src="assets/js/core/jquery.min.js"></script>
  <script src="assets/js/core/popper.min.js"></script>
  <script src="assets/js/core/bootstrap.min.js"></script>
  <script src="assets/js/now-ui-dashboard.min.js"></script>




  <!-- ApexCharts Radial Gauges -->
  <script>
   const buildGauge = (id, value) => {
  const options = {
    chart: {
      id: id, // ✅ This is the only line added
      type: 'radialBar',
      height: 300,
      sparkline: { enabled: true }
    },
    series: [value],
    plotOptions: {
      radialBar: {
        startAngle: -120,
        endAngle: 120,
        hollow: {
          margin: 0,
          size: '60%',
          background: '#111'
        },
        track: {
          background: '#222',
          strokeWidth: '100%'
        },
        dataLabels: {
          name: { show: false },
          value: {
            fontSize: '28px',
            color: '#fff',
            offsetY: 10,
            formatter: val => `${Math.round(val)}%`
          }
        }
      }
    },
    fill: {
      type: 'gradient',
      gradient: {
        shade: 'dark',
        type: 'horizontal',
        gradientToColors: ['#00f2ff'],
        colorStops: [
          { offset: 0, color: '#ff00cc', opacity: 1 },
          { offset: 50, color: '#7c00ff', opacity: 1 },
          { offset: 100, color: '#00f2ff', opacity: 1 }
        ]
      }
    },
    stroke: { lineCap: 'round' },
    labels: []
  };

  new ApexCharts(document.querySelector(`#${id}`), options).render();
};

    // Placeholder values (replace with API response)
   
 
 



// Show video preview after upload
function previewVideo() {
  const file = document.getElementById('videoUpload').files[0];
  const preview = document.getElementById('videoPreview');
  const label = document.getElementById('uploadLabel');

  if (file) {
    const url = URL.createObjectURL(file);
    preview.src = url;
    preview.style.display = "block";
    label.textContent = "✅ Video uploaded: " + file.name;
  }
}

// Analyze video using Gemini backend
async function runAnalysis() {
  console.log('[runAnalysis] Started video analysis...');

  // Check if user has access (Pro, credits, or free upload)
  if (!isProActive() && !hasCredits() && hasUsedFreeUpload()) {
    showUpgradeModal();
    return;
  }

  // Mark free upload as used if this is their first analysis
  if (!isProActive() && !hasCredits() && !hasUsedFreeUpload()) {
    markFreeUploadUsed();
  }

  // Use a credit if not Pro and not using free upload
  if (!isProActive() && hasCredits() && !useReportCredit()) {
    alert("No report credits remaining. Please purchase more credits or upgrade to Pro.");
    return;
  }

  const fileInputEl = document.getElementById("file-upload");
  const loader = document.getElementById("loadingIndicator");
  const timerEl = document.getElementById("analysisTimer");

  if (!fileInputEl || !loader) {
    alert("⚠️ Missing file input or loading element.");
    return;
  }

  const file = fileInputEl.files[0];
  if (!file) {
    alert("Please upload a video to analyze.");
    return;
  }

  // ✅ Show animated overlay
  loader.style.display = "flex";
  
  // Start timer
  let seconds = 0;
  const timerInterval = setInterval(() => {
    seconds++;
    if (timerEl) {
      if (seconds < 10) {
        timerEl.textContent = `Processing... ${seconds}s`;
      } else if (seconds < 20) {
        timerEl.textContent = `Analyzing content... ${seconds}s`;
      } else {
        timerEl.textContent = `Finalizing results... ${seconds}s`;
      }
    }
  }, 1000);

  try {
    // Use live Gemini API instead of dummy data
    const formData = new FormData();
    formData.append("video", file);

    console.log("📤 Sending file to /upload for live Gemini analysis...");

    const response = await fetch("/upload", {
      method: "POST",
      body: formData,
    });

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }

    const result = await response.json();
    console.log("🌐 Live Gemini result:", result);

    // Validate the feedback structure
    if (!validateFeedback(result.feedback)) {
      throw new Error("Invalid feedback structure received from API");
    }

    // Clear timer
    clearInterval(timerInterval);
    if (timerEl) timerEl.textContent = "Analysis complete!";

    // Store feedback globally for PDF generation
    window.feedback = result;
    console.log('💾 Stored live feedback in window.feedback:', window.feedback);

    // Save analysis to history
    saveAnalysisToHistory(result, file.name);

    // Save score to leaderboard
    const f = result?.feedback;
    const scores = [
      f?.viralScore?.score,
      f?.hookStrength?.score,
      f?.captionClarity?.score,
      f?.soundMatch?.score,
      f?.viewerUnderstanding?.score,
      f?.engagementForecast?.score
    ].filter(score => typeof score === 'number');

    const overallScore = scores.length
      ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length)
      : 0;

    // Save to leaderboard
    if (typeof saveAnalysisResult === 'function') {
      saveAnalysisResult(overallScore);
    }

    // Update UI with live results
    displayGeminiResults(result);
    displayGeminiResultsSafe();
    syncGaugesFromGemini(result.feedback);

    // ✅ Hide overlay after done
    setTimeout(() => {
      loader.style.display = "none";
      
      // ✅ Show results
      document.querySelectorAll(".result-content").forEach(el => el.style.opacity = 1);
      document.querySelectorAll(".analyzing").forEach(el => el.style.display = "none");
      console.log("✅ Analysis complete - loader hidden and results shown");
    }, 1000);

  } catch (error) {
    console.error("❌ Analysis failed:", error);
    clearInterval(timerInterval);
    
    // Show error in timer
    if (timerEl) timerEl.textContent = "Analysis failed - please try again";
    
    setTimeout(() => {
      loader.style.display = "none";
      alert("❌ Analysis failed: " + error.message);
    }, 2000);
  }
}

// Function to save analysis results to history
function saveAnalysisToHistory(result, fileName) {
  try {
    // Get existing history
    const history = JSON.parse(localStorage.getItem("analysisHistory")) || [];
    
    // Calculate overall score
    const f = result?.feedback;
    const scores = [
      f?.viralScore?.score,
      f?.hookStrength?.score,
      f?.captionClarity?.score,
      f?.soundMatch?.score,
      f?.viewerUnderstanding?.score,
      f?.engagementForecast?.score
    ].filter(score => typeof score === 'number');

    const overallScore = scores.length
      ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length)
      : 0;

    // Create history entry
    const historyEntry = {
      id: Date.now().toString(),
      title: fileName || 'Untitled Video',
      date: new Date().toLocaleDateString(),
      score: overallScore,
      summary: result?.feedback?.summary || 'No summary available',
      feedback: result?.feedback || {},
      timestamp: Date.now()
    };

    // Add to history (newest first)
    history.unshift(historyEntry);
    
    // Keep only last 50 entries to prevent localStorage overflow
    if (history.length > 50) {
      history.splice(50);
    }

    // Save back to localStorage
    localStorage.setItem("analysisHistory", JSON.stringify(history));
    
    console.log('💾 Analysis saved to history:', historyEntry);
    console.log('📊 Total history entries:', history.length);
  } catch (error) {
    console.error('❌ Failed to save analysis to history:', error);
  }
}

</script>



<script>
// ✅ Helper function to safely get scores from feedback object
// This prevents crashes like "undefined is not an object"
function safeGetScore(key) {
  if (
    window.feedback &&                          // Make sure feedback exists
    typeof window.feedback === 'object' &&      // Ensure it's a valid object
    window.feedback.feedback &&                 // Check if nested feedback exists
    window.feedback.feedback[key] &&            // Check if the specific key exists
    typeof window.feedback.feedback[key].score === 'number'  // Check if score is a number
  ) {
    return window.feedback.feedback[key].score; // ✅ Safe to return the score
  } else {
    console.warn(`[displayGeminiResults] ${key} is missing or invalid`, window.feedback);
    return null;                                // Return null if invalid
  }
}

function displayGeminiResults(result) {
  console.log("✅ Gemini Result Received:", result);
  console.log("🧠 Raw Gemini feedback object:", result?.feedback);
  console.log("🔍 Display Debug Info:");
  console.log('Result type:', typeof result);
  console.log('Feedback type:', typeof result?.feedback);
  console.log('Feedback keys:', Object.keys(result?.feedback || {}));
  console.log('ViralScore exists:', !!result?.feedback?.viralScore);
  console.log('ViralScore value:', result?.feedback?.viralScore);

  const feedbackKeys = {
    viralScore: ["viralScoreScore", "viralScoreEmoji", "viralScoreLabel", "viralScoreFeedback", "viralScoreDetailedGemini"],
    captionClarity: ["captionClarityScore", "captionClarityEmoji", "captionClarityLabel", "captionClarityFeedback", "captionClarityDetailedGemini"],
    soundMatch: ["soundMatchScore", "soundMatchEmoji", "soundMatchLabel", "soundMatchFeedback", "soundMatchDetailedGemini"],
    viewerUnderstanding: ["viewerUnderstandingScore", "viewerUnderstandingEmoji", "viewerUnderstandingLabel", "viewerUnderstandingFeedback", "viewerUnderstandingDetailedGemini"],
    engagementForecast: ["engagementForecastScore", "engagementForecastEmoji", "engagementForecastLabel", "engagementForecastFeedback", "engagementForecastDetailedGemini"],
    hookStrength: ["viralStrengthScore", "viralStrengthEmoji", "hookStrengthLabel", "viralStrengthFeedback", "viralStrengthDetailedGemini"]
  };

  for (const key in feedbackKeys) {
    const data = result?.feedback?.[key] || {};
    const [numId, emojiId, labelId, shortId, detailId] = feedbackKeys[key];

    const numEl = document.getElementById(numId);
    const emojiEl = document.getElementById(emojiId);
    const labelEl = document.getElementById(labelId);
    const shortEl = document.getElementById(shortId);
    const detailEl = document.getElementById(detailId);

    if (numEl) numEl.textContent = data.score ?? "--";

    if (emojiEl) {
      const score = data.score ?? 0;
      if (score >= 80) emojiEl.textContent = "🟢";
      else if (score >= 60) emojiEl.textContent = "🟡";
      else if (score >= 40) emojiEl.textContent = "🟠";
      else emojiEl.textContent = "🔴";
    }

    if (labelEl) {
      let icon = "🟡"; // Default
      const labelText = (data.label || "").toLowerCase();
      switch (labelText) {
        case "strong":
        case "good": icon = "✅"; break;
        case "weak": icon = "⚠️"; break;
        case "poor":
        case "bad": icon = "❌"; break;
        case "okay": icon = "🟡"; break;
      }
      labelEl.textContent = data.label ? `${icon} ${data.label}` : "—";
    }

    if (shortEl) {
      let shortText = data.short?.trim() || "Awaiting feedback.";
      shortText = shortText.replace(/^•\s*/, '').replace(/^&#8226;\s*/, '').replace(/^\u2022\s*/, '');
      shortEl.innerHTML = `<span style="color: #fff;">•</span> <span class="feedback-title">🧠 AI Feedback</span><br>${shortText}`;
    }

    if (detailEl) {
      let detailText = data.detail?.trim() || "More details coming soon.";
      detailText = detailText.replace(/^•\s*/, '').replace(/^&#8226;\s*/, '').replace(/^\u2022\s*/, '');
      detailEl.innerHTML = `<span style="color:#fff;">•</span> <span class="feedback-title">🔍 Full Analysis</span><br>${detailText}`;
    }
  }

  syncGaugesFromGemini(result?.feedback);

  // ✅ OVERALL SCORE CIRCLE ANIMATION
  const f = result?.feedback;
  const scores = [
    f?.viralScore?.score,
    f?.hookStrength?.score,
    f?.captionClarity?.score,
    f?.soundMatch?.score,
    f?.viewerUnderstanding?.score,
    f?.engagementForecast?.score
  ].filter(score => typeof score === 'number');

  const overallScore = scores.length
    ? Math.round(scores.reduce((a, b) => a + b, 0) / scores.length)
    : 0;

  console.log("🎯 Gemini says overall score is:", overallScore);
  
  // ✅ Update the overall score circle with the calculated score
  const scoreEl = document.getElementById("overallScoreCircle");
  if (scoreEl && typeof overallScore === "number" && !isNaN(overallScore)) {
    // Animate the score from 0 to the final value
    let current = 0;
    const steps = 30;
    const stepTime = 1500 / steps;
    const increment = overallScore / steps;
    
    const counter = setInterval(() => {
      current += increment;
      if (current >= overallScore) {
        current = overallScore;
        clearInterval(counter);
      }
      scoreEl.textContent = Math.round(current);
    }, stepTime);
    
    scoreEl.style.opacity = 1;
  }
  
  // ✅ Send the same overall score to the chart for consistency
  if (typeof overallScore === "number" && !isNaN(overallScore)) {
    syncViralChartFromGemini(overallScore);
  } else {
    console.warn("⚠️ Invalid overallScore for chart sync:", overallScore);
  }
}

// ✅ Safe version of displayGeminiResults that uses window.feedback
// This prevents crashes when called without parameters
function displayGeminiResultsSafe() {
  console.log('[displayGeminiResultsSafe] Starting display with feedback:', window.feedback);

  // Get each score safely using the helper function
  const viralScore = safeGetScore('viralScore');
  const hookStrength = safeGetScore('hookStrength');
  const captionClarity = safeGetScore('captionClarity');
  const soundMatch = safeGetScore('soundMatch');
  const viewerUnderstanding = safeGetScore('viewerUnderstanding');
  const engagementForecast = safeGetScore('engagementForecast');

  // Only update the gauge if the score is valid (not null)
  if (viralScore !== null) updateGaugeAndFeedback('viralGauge', 'viralFeedback', viralScore);
  if (hookStrength !== null) updateGaugeAndFeedback('hookGauge', 'hookFeedback', hookStrength);
  if (captionClarity !== null) updateGaugeAndFeedback('captionGauge', 'captionFeedback', captionClarity);
  if (soundMatch !== null) updateGaugeAndFeedback('soundGauge', 'soundFeedback', soundMatch);
  if (viewerUnderstanding !== null) updateGaugeAndFeedback('viewerGauge', 'viewerFeedback', viewerUnderstanding);
  if (engagementForecast !== null) updateGaugeAndFeedback('engagementGauge', 'engagementFeedback', engagementForecast);

  console.log('[displayGeminiResultsSafe] Gauge updates complete');
}
</script>

















<script>
  window.onload = () => {
    buildGauge("viralGauge", 0);
    buildGauge("captionGauge", 0);
    buildGauge("soundGauge", 0);
    buildGauge("viewerGauge", 0);
    buildGauge("engagementGauge", 0);
    buildGauge("hookGauge", 0);
  };
</script>










<script>
  // Short summary feedback by score range
  function getShortFeedback(score) {
    if (score >= 90) return "🔥 Dominating the algorithm";
    if (score >= 70) return "✅ Strong performance";
    if (score >= 50) return "⚠️ Decent but could improve";
    if (score >= 30) return "🔍 Needs serious attention";
    return "🚫 Major issues holding this back";
  }

  // Sync each gauge and feedback
  function updateGaugeAndFeedback(gaugeId, feedbackId, score) {
    // Handle null/undefined scores safely
    if (score === null || score === undefined || isNaN(score)) {
      console.warn(`[updateGaugeAndFeedback] Invalid score for ${gaugeId}:`, score);
      return;
    }
    
    if (typeof ApexCharts !== "undefined") {
      const chart = ApexCharts.getChartByID(gaugeId);
      if (chart) {
        chart.updateSeries([score]);
      }
    }

    const feedbackEl = document.getElementById(feedbackId);
    if (feedbackEl) {
      feedbackEl.innerHTML = `🧠 AI Feedback<br>${getShortFeedback(score)}`;
    }
  }

  // 💡 This is what you call inside your Gemini response handler
  function syncGaugesFromGemini(feedback) {
    if (!feedback || typeof feedback !== 'object') {
      console.warn('[syncGaugesFromGemini] Invalid feedback object:', feedback);
      return;
    }
    
    updateGaugeAndFeedback("viralGauge", "viralFeedback", feedback.viralScore?.score);
    updateGaugeAndFeedback("captionGauge", "captionFeedback", feedback.captionClarity?.score);
    updateGaugeAndFeedback("soundGauge", "soundFeedback", feedback.soundMatch?.score);
    updateGaugeAndFeedback("viewerGauge", "viewerFeedback", feedback.viewerUnderstanding?.score);
    updateGaugeAndFeedback("engagementGauge", "engagementFeedback", feedback.engagementForecast?.score);
    updateGaugeAndFeedback("hookGauge", "hookFeedback", feedback.hookStrength?.score);
  }
</script>


 




<style>
  
.sidebar-link i {
  margin-right: 10px;
  width: 20px;
  text-align: center;
}











.user-info {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-left: 8px;
  margin-top: 10px;
}

.username {
  font-size: 15px;
  font-weight: 500;
  margin-bottom: 0;
}





.user-rank-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  background: linear-gradient(135deg, #8b5cf6, #a855f7);
  color: #fff;
  padding: 10px 12px;
  border-radius: 16px;
  font-size: 11px;
  box-shadow: 0 2px 8px rgba(139, 92, 246, 0.3);
  width: fit-content;
  min-width: 0;
  flex-shrink: 0;
  transition: all 0.2s ease;
  word-wrap: break-word;
  overflow-wrap: break-word;
  height: 32px;
}

.user-rank-badge:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
}

.user-rank-badge .badge-label {
  font-weight: 600;
  font-size: 11px;
  opacity: 0.9;
  white-space: nowrap;
  flex-shrink: 0;
}

.user-rank-badge .badge-value {
  font-weight: 500;
  white-space: normal;
  word-wrap: break-word;
  overflow-wrap: break-word;
  text-align: center;
  line-height: 1.2;
}

.flame-icon {
  color: #ff5500;
  font-size: 16px;
  animation: flicker 1.2s infinite alternate ease-in-out;
}

/* 🔥 Flame flicker effect */
@keyframes flicker {
  0%   { opacity: 0.7; transform: scale(1); }
  50%  { opacity: 1; transform: scale(1.05); }
  100% { opacity: 0.85; transform: scale(0.98); }
}

/* 🌟 Optional glow effect for badge */
@keyframes glowFade {
  from {
    box-shadow: 0 0 5px rgba(248, 248, 248, 0.2), 0 0 10px rgba(204, 213, 224, 0.4);
  }
  to {
    box-shadow: 0 0 8px rgba(8, 33, 224, 0.4), 0 0 14px rgba(2, 46, 242, 0.6);
  }
}




.user-rank-badge.glow {
  box-shadow: 0 0 12px #f7f4f4, 0 0 20px #3822de;
}

.plan-status {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: #fff;
  padding: 10px 12px;
  border-radius: 16px;
  font-size: 11px;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
  width: fit-content;
  min-width: 0;
  flex-shrink: 0;
  transition: all 0.2s ease;
  word-wrap: break-word;
  overflow-wrap: break-word;
  height: 32px;
}

.plan-status:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.plan-status .badge-label {
  font-weight: 600;
  font-size: 11px;
  opacity: 0.9;
  white-space: nowrap;
  flex-shrink: 0;
}

.plan-status .badge-value {
  font-weight: 500;
  white-space: normal;
  word-wrap: break-word;
  overflow-wrap: break-word;
  text-align: center;
  line-height: 1.2;
}






.sidebar-social-icons {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 14px;
  padding: 20px 0;
  flex-wrap: nowrap;
}

.social-icon {
  width: 40px;
  height: 40px;
  background-image: url('assets/img/social-logos.png');
  background-size: 200% 200%; /* 2x2 layout */
  background-repeat: no-repeat;
  background-position: center;
  border-radius: 10px;
  transition: transform 0.3s ease, filter 0.3s ease;
  cursor: pointer;

  /* Fix optical alignment from shadows */
  display: inline-block;
  vertical-align: middle;
  box-sizing: border-box;
}


.social-icon:hover {
  transform: scale(1.1);
  filter: brightness(1.2);
}

.tiktok    { background-position: 0% 0%; }
.instagram { background-position: 100% 0%; }
.youtube {
  background-position: 0% 100%;
  margin-top: 5px; /* visually nudges it down */
}

.twitter {
  background-position: 100% 100%;
  margin-top: 5px;
}


/* Responsive sidebar adjustments */
@media (max-width: 768px) {
  .user-info {
    max-width: 150px;
  }
  
  .user-rank-badge,
  .plan-status {
    padding: 6px 12px;
    font-size: 11px;
    width: 100%;
  }
  
  .user-rank-badge .badge-label,
  .plan-status .badge-label {
    font-size: 10px;
  }
  
  .user-rank-badge .badge-value,
  .plan-status .badge-value {
    font-size: 11px;
    line-height: 1.1;
  }
}

@media (max-height: 700px) {
  .sidebar-social-icons {
    flex-wrap: wrap;
    gap: 10px;
  }
}

.sidebar-social-container {
  text-align: center;
  padding: 10px 0 20px;
}

.social-label {
  font-size: 17px;
  font-weight: 700;
  color: #ffffff;
  margin-bottom: 4px; /* reduced from 12px to bring it closer */
  letter-spacing: 0.4px;
}


/* Dropdown Menu Styles */
#dropdownMenu {
  display: none;
  position: absolute;
  right: 0;
  top: 36px;
  background: #2e3b5e;
  border-radius: 6px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
  min-width: 180px;
  max-width: 200px;
  z-index: 1000;
}

/* Responsive dropdown positioning for smaller screens */
@media (max-width: 1200px) {
  #dropdownMenu {
    right: 0;
    min-width: 170px;
    max-width: 190px;
  }
}

@media (max-width: 768px) {
  #dropdownMenu {
    right: 0;
    min-width: 160px;
    max-width: 180px;
  }
}

@media (max-width: 480px) {
  #dropdownMenu {
    right: 0;
    min-width: 140px;
    max-width: 160px;
  }
}

#dropdownMenu a {
  display: block;
  padding: 10px 14px;
  color: #ffffff;
  text-decoration: none;
  font-size: 14px;
  transition: background 0.2s ease;
}

#dropdownMenu a:hover {
  background-color: rgba(255, 255, 255, 0.08);
  border-radius: 4px;
}


/* Search Bar Style */
.top-search-input {
  padding: 6px 12px;
  border-radius: 8px;
  border: none;
  outline: none;
  background: #2e3b5e;
  color: #ffffff;
  font-size: 14px;
  transition: box-shadow 0.3s ease;
}

.top-search-input:focus {
  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
}



/* Style for VB */
/* Sidebar logo styling */
.logo {
  /* Use flex to align items horizontally and vertically within the logo container */
  display: flex;
  align-items: center;         /* Vertically center the items within .logo */
  justify-content: flex-start; /* Left-align the logo text to match sidebar content */
  padding: 15px 15px;          /* Maintain padding consistent with other sidebar elements */
}

.logo a {
  display: inline-flex;        /* Use inline-flex for mascot + text alignment */
  align-items: center;         /* Vertically center mascot and text */
  color: #fff;                 /* White text for high contrast on dark sidebar */
  font-weight: 700;            /* Bold text to make the logo stand out */
  text-decoration: none;       /* Remove any underline from the links */
  font-family: 'Montserrat', 'Helvetica Neue', Helvetica, Arial, sans-serif;
  /* ^ Use a modern, distinctive sans-serif font (Montserrat as first choice) */
  font-size: 18px;             /* Slightly larger font size for prominence (adjust as needed) */
}

/* Mascot image styling */
.logo a img {
  height: 26px;
  width: auto;
  margin-right: 6px;
}

/* Spacing between "VB" and "VideoBoss" */
.logo .logo-mini {
  margin-right: 8px;  /* Add a small gap after "VB" to separate it from "VideoBoss" */
}


.top-buttons {
  position: absolute;
  top: 20px;
  right: 115px;
  display: flex;
  gap: 12px;
  align-items: center; /* 👈 THIS fixes vertical misalignment */
  z-index: 999;
}

.top-buttons a {
  padding: 6px 14px;           /* Slightly reduced padding for tighter height */
  font-size: 12px;
  height: auto;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  background-color: #ffffff;
  color: #1a1a1a;
  font-weight: 600;
  text-decoration: none;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  transition: all 0.25s ease;
  white-space: nowrap;
}

.top-buttons a i {
  margin-right: 6px;
  font-size: 14px;
}


.top-buttons a:hover {
  background-color: #f2f2f2;
  transform: translateY(-1px);
}

/* Specifically target only the Login button */
.top-buttons a.login-btn {
  padding: 6px 14px !important;
  font-size: 12px;
  height: 40px !important;   /* Force same height */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 6px;
  background-color: #ffffff;
  color: #1a1a1a;
  font-weight: 600;
  text-decoration: none;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  transition: all 0.25s ease;
  white-space: nowrap;
}

.top-login-btn {
  height: 38px !important;
  padding: 8px 12px !important;
  line-height: 1 !important;
}






.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.modal {
  background: #fff;
  padding: 30px 25px;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  width: 90%;
  max-width: 350px;
  text-align: center;
}

.modal input {
  width: 100%;
  padding: 10px;
  margin: 15px 0;
  border-radius: 8px;
  border: 1px solid #ccc;
}

.modal button {
  background: #0a84ff;
  color: white;
  padding: 10px 16px;
  border: none;
  border-radius: 20px;
  cursor: pointer;
}


.upload-label {
  display: inline-block;
  padding: 12px 20px;
  background: linear-gradient(135deg, #1b1f80, #3c48f2);
  color: #fff;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 0 10px rgba(60, 72, 242, 0.5);
  transition: transform 0.2s ease, box-shadow 0.3s ease;
  animation: pulseGlow 1.8s infinite;
}

.upload-label i {
  margin-right: 8px;
}

.upload-label:hover {
  transform: scale(1.05);
  box-shadow: 0 0 20px rgba(60, 72, 242, 0.8);
}

@keyframes pulseGlow {
  0% {
    box-shadow: 0 0 10px rgba(60, 72, 242, 0.4);
  }
  50% {
    box-shadow: 0 0 20px rgba(60, 72, 242, 0.9);
  }
  100% {
    box-shadow: 0 0 10px rgba(60, 72, 242, 0.4);
  }
}


  
  
  
  /* Your CSS goes here */
 .sidebar .nav {
  list-style: none;
  padding: 0;
  margin: 0;
}

.sidebar .nav li {
  margin-bottom: 10px;
}

.sidebar .nav li a {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  border-radius: 10px;
  text-decoration: none;
  color: #ffffff;
  font-size: 15px;
  font-weight: 600;
  background-color: transparent;
  transition: background 0.25s ease, transform 0.2s ease;
}

.sidebar .nav li.active a {
  background-color: #ffffff;
  color: #1a1e36;
  font-weight: 700;
  animation: dashboardFadeIn 0.5s ease-out;
  animation-delay: 0.2s;
  animation-fill-mode: both; /* This is key */
}


.sidebar .nav li.active a::before {
  content: "";
  position: absolute;
  left: 0;
  top: 8px;
  bottom: 8px;
  width: 4px;
  background-color: #046dec; /* or any accent color you like */
  border-radius: 2px;
}

.sidebar .nav li:not(.active) a:hover {
  background-color: rgba(255, 255, 255, 0.08);
  transform: translateX(4px);
}

@keyframes dashboardFadeIn {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.sidebar .nav li.active a {
  background-color: #ffffff;
  color: #1a1e36;
  font-weight: 700;
  animation: dashboardFadeIn 0.5s ease-out;
  animation-delay: 0.2s;
  animation-fill-mode: both;
}








 .top-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding: 16px 24px;
  background: rgba(15, 15, 117, 0.92);
  backdrop-filter: blur(8px);
  box-shadow: 0 2px 12px rgba(0, 255, 255, 0.1);
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  box-sizing: border-box;
  position: relative;
  z-index: 9;
}

.analyzer-bar {
  display: flex;
  align-items: center;
  gap: 12px;
}

.analyzer-input {
  padding: 10px 14px;
  border-radius: 8px;
  border: none;
  outline: none;
  font-size: 14px;
  min-width: 260px;
}

.analyze-btn {
  background-color: #f6f2f1;
  color: white;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  transition: transform 0.2s ease;
}

.analyze-btn:hover {
  transform: scale(1.05);
}



.grid-score-bands {
  display: flex;
  justify-content: space-between;
  margin: 16px 0;
  font-size: 14px;
  color: #ccc;
  padding-inline: 8px;
}

.band-label.green { color: #00e676; }
.band-label.amber { color: #ffeb3b; }
.band-label.red   { color: #f44336; }






.gauge-wrapper {
  position: relative;
  width: 150px;
  height: 150px;
  margin: 0 auto;
}

.gauge-wrapper canvas {
  width: 100%;
  height: 100%;
}

.gauge-percent {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 20px;
  color: white;
  font-weight: bold;
}


.results-card {
  background-color: rgba(255, 255, 255, 0.02);
  backdrop-filter: blur(8px);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 14px;
  max-width: 1100px;
  margin: 80px auto 40px auto;
  padding: 32px;
  min-height: 700px;
  position: relative;
  box-shadow: 0 0 20px rgba(255, 255, 255, 0.1), 0 0 40px rgba(255, 255, 255, 0.05), 0 0 60px rgba(255, 255, 255, 0.03);
  transition: all 0.3s ease;
}

.results-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 0 30px rgba(255, 255, 255, 0.15), 0 0 50px rgba(255, 255, 255, 0.08), 0 0 70px rgba(255, 255, 255, 0.05);
}

/* Neon glow effects for all card elements */
.pro-locked-results {
  position: relative;
  box-shadow: 0 0 20px rgba(108, 43, 217, 0.7), 0 0 40px rgba(108, 43, 217, 0.5), 0 0 60px rgba(108, 43, 217, 0.3);
}

.chart-card {
  position: relative;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.7), 0 0 40px rgba(59, 130, 246, 0.5), 0 0 60px rgba(59, 130, 246, 0.3);
}

.history-card {
  position: relative;
  box-shadow: 0 0 20px rgba(34, 197, 94, 0.7), 0 0 40px rgba(34, 197, 94, 0.5), 0 0 60px rgba(34, 197, 94, 0.3);
}

/* Score blocks with neon glow */
.score-block {
  position: relative;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.7), 0 0 40px rgba(59, 130, 246, 0.5), 0 0 60px rgba(59, 130, 246, 0.3);
}

.score-block.excellent {
  box-shadow: 0 0 20px rgba(34, 197, 94, 0.7), 0 0 40px rgba(34, 197, 94, 0.5), 0 0 60px rgba(34, 197, 94, 0.3);
}

.score-block.good {
  box-shadow: 0 0 20px rgba(245, 158, 11, 0.7), 0 0 40px rgba(245, 158, 11, 0.5), 0 0 60px rgba(245, 158, 11, 0.3);
}

.score-block.poor {
  box-shadow: 0 0 20px rgba(239, 68, 68, 0.7), 0 0 40px rgba(239, 68, 68, 0.5), 0 0 60px rgba(239, 68, 68, 0.3);
}

.results-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start; /* changed from center */
  margin-bottom: 20px;
}

.results-title {
  display: flex;
  align-items: center;
  font-weight: bold;
  font-size: 20px;
  margin-bottom: 20px;
  color: #333;
}






.results-loading {
  text-align: right;
}



@keyframes slide {
  0% {
    background-position: 0% 0%;
  }
  100% {
    background-position: 100% 0%;
  }
}


.loading-bar {
  background-size: 200% 100%;
}





.analyzing-text {
  font-size: 14px;
  color: #cccccc;
  margin-top: 6px;
}

.dots::after {
  content: '';
  animation: dots 1.5s steps(3, end) infinite;
}

@keyframes dots {
  0% { content: ''; }
  33% { content: '.'; }
  66% { content: '..'; }
  100% { content: '...'; }
}



.results-grid {
  display: grid;
  grid-template-columns: 200px 1fr 1fr 1fr;
  gap: 16px;
  color: #fff;
  font-size: 15px;
  margin-top: 30px;
}

.grid-header {
  display: contents;
}

.grid-label {
  font-weight: 600;
  text-align: center;
  padding-bottom: 6px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.grid-title {
  font-weight: 500;
  padding-top: 10px;
}

.grid-row {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 12px;
  margin-top: 8px;
}


.grid-cell {
  background-color: rgba(255,255,255,0.03);
  padding: 12px 10px;
  border-radius: 8px;
  position: relative;
  display: flex;
  align-items: center;
  gap: 8px;
}

.dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  display: inline-block;
}

.dot.green { background-color: #4cd964; }
.dot.amber { background-color: #ffcc00; }
.dot.red { background-color: #ff3b30; }

.grid-cell.green { border-left: 4px solid #4cd964; }
.grid-cell.amber { border-left: 4px solid #ffcc00; }
.grid-cell.red { border-left: 4px solid #ff3b30; }

.results-card {
  color: #333;
}



.grid-title {
  font-size: 16px;
}

.grid-cell {
  font-size: 15px;
}

.grid-label {
  font-size: 14px;
  opacity: 0.9;
}

/* Adds divider before Amber and Red columns */
.results-grid .grid-cell:nth-child(2n+2) {
  border-left: 1px solid #ddd;
  padding-left: 12px;
}





.analyzer-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 40px;
}

.analyzer-row {
  display: flex;
  align-items: center;
}

.analyzer-row input {
  padding: 10px 15px;
  width: 300px;
  border-radius: 6px;
  border: none;
  margin-right: 10px;
}

.analyzer-row button {
  padding: 10px 20px;
  background-color: #2248bc;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s ease; /* enables smooth animation */
}

.analyzer-row button:hover {
  background-color: #5f64ec; /* lighter orange on hover */
  transform: scale(1.05);    /* subtle zoom */
  box-shadow: 0 0 8px rgba(255, 87, 34, 0.3);
}

.analyzer-row button:active {
  transform: scale(0.97);    /* slight press-in effect */
  box-shadow: 0 0 4px rgba(255, 87, 34, 0.15);
}







.upload-analyze-row {
  display: flex;
  gap: 12px;
  margin-top: 20px;
  justify-content: center;
  align-items: center;
}

.upload-label {
  background-color: #1e90ff;
  padding: 10px 18px;
  border-radius: 8px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

.analyze-btn {
  background-color: #00ffcc;
  border: none;
  padding: 10px 18px;
  border-radius: 8px;
  font-weight: 600;
  color: #000;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

.new-upload-btn {
  background-color: #00aaff;
  color: white;
  padding: 10px 18px;
  margin-left: 15px;
  margin-top: 6px; /* 👈 This is the line to tweak */
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  display: inline-block;
  border: none;
}




.analyzer-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center; /* keeps them stacked & centered with each other */
  margin-top: 40px;
  transform: translateX(95px); /* ⬅️ nudge them right together */
}

.return-home-btn {
  display: inline-block;
  margin: 20px auto;
  padding: 10px 18px;
  background-color: #00ffff;
  color: #0c0c0c;
  font-weight: 600;
  border-radius: 8px;
  text-decoration: none;
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
  border: 1px solid white !important;

  transition: all 0.3s ease;
}

.return-home-wrapper {
  position: fixed;
  top: -40px;     /* Move it up or down: lower = further down */
  right: 120px;   /* Move it left or right: lower = closer to center */
  z-index: 999;
}

.return-home-btn {
  background-color: #2248bc;
  color: #f5efef;
  font-weight: 600;
  text-decoration: none;
  padding: 10px 16px;
  border-radius: 8px;
  transition: all 0.25s ease;
  box-shadow: 0 0 10px #04283b88;
  font-size: 14px;
}

.return-home-btn:hover {
  background-color: #5f64ec;
  transform: scale(1.05);
  box-shadow: 0 0 12px rgba(82, 137, 182, 0.5);
}
.feedback-row {
  background-color: rgba(255, 255, 255, 0.04);
  border-radius: 12px;
  padding: 16px 20px;
  margin-bottom: 18px;
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.15);
  color: #fff;
}

.results-grid,
.grid-title,
.grid-label,
.grid-cell {
  color: #fff !important;
}

.sidebar[data-color="orange"]:after {
  background-color: #2248bc !important;
}

.sidebar .nav li.active > a {
  color: #2248bc  !important;
}


  .gauge-box.pro-locked {
    position: relative;
    overflow: hidden;
    background: #ab999931;
    border-radius: 14px;
    box-shadow: 0 0 20px rgba(108, 43, 217, 0.7), 0 0 40px rgba(108, 43, 217, 0.5), 0 0 60px rgba(108, 43, 217, 0.3);
  }

 .gauge-box.pro-locked::after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  background: rgba(0,0,0,0.35);
  z-index: 1;
}






  .gauge-box.pro-locked .locked-overlay {
    position: absolute;
    z-index: 2;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
  }

  

  

  .gauge-box.pro-locked .locked-overlay .padlock {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 48px;
    color: #b0a6a628;
    animation: pulseLock 2s infinite;
  }

  @keyframes pulseLock {
    0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    50% { transform: translate(-50%, -50%) scale(1.1); opacity: 0.85; }
  }

  .gauge-box.pro-locked .locked-overlay .btn-upgrade {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 6px 14px;
    background-color: #2248bc;
    color: #ffffff;
    font-weight: 600;
    font-size: 14px;
    border: 1px solid white;

    border-radius: 8px;
    cursor: pointer;
    pointer-events: auto;
    z-index: 3;
  }

  .gauge-box.pro-locked .locked-overlay .btn-upgrade:hover {
    background-color: #0386f8;
  }

@keyframes pulse {
  0% {
    transform: translateX(-50%) scale(1);
  }
  50% {
    transform: translateX(-50%) scale(1.08);
  }
  100% {
    transform: translateX(-50%) scale(1);
  }
}
.gauge-box.pro-locked .locked-overlay .btn-upgrade:hover {
  animation: pulse 0.4s ease-in-out;
}

.padlock-icon {
  position: absolute;
  top: 47%;
  left: 50%;
  width: 110px; /* adjust size if needed */
  transform: translate(-50%, -50%);
  z-index: 2;
  pointer-events: none;
}


 .padlock-icon img {
  width: 100%;
  height: auto;
  pointer-events: auto;
  transform: translate(-50%, -50%);
}

.padlock-icon:hover img,
.padlock-icon:active img {
  animation: shake 0.4s ease;
}

@keyframes shake {
  0% { transform: translate(-50%, -50%) rotate(0deg); }
  10% { transform: translate(-50%, -50%) rotate(8deg); }
  20% { transform: translate(-50%, -50%) rotate(-8deg); }
  30% { transform: translate(-50%, -50%) rotate(6deg); }
  40% { transform: translate(-50%, -50%) rotate(-6deg); }
  50% { transform: translate(-50%, -50%) rotate(4deg); }
  60% { transform: translate(-50%, -50%) rotate(-4deg); }
  70% { transform: translate(-50%, -50%) rotate(2deg); }
  80% { transform: translate(-50%, -50%) rotate(-2deg); }
  100% { transform: translate(-50%, -50%) rotate(0deg); }
}


  








a {
  color: #93c5fd; /* soft blue by default */
  text-decoration: none;
  transition: color 0.2s ease;
}

a:hover {
  color: #60a5fa; /* lighter blue on hover */
  text-decoration: underline;
}

.analyzer-wrapper {
  background-color: #1e3a8a !important; /* Change this to test your own */
}
.analyzer-wrapper {
  margin-top: 0 !important;
  padding-top: 0 !important;
}

.analyzer-row {
  padding-top: 30px;
  display: flex;
  gap: 10px;
  align-items: center;
}

.upload-box {
  padding-top: 20px;
}

.return-home-wrapper {
  position: absolute;
  top: 5px;
  right: 110px;
}

.results-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 15px;
}

.results-title {
  font-size: 22px;
  font-weight: bold;
  display: flex;
  align-items: center;
  color: #ffffff;
}

.feedback-note {
  font-size: 15px;
  color: #999;
  flex: 1 1 100%;
}

.results-loading {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
}

.loading-bar {
  width: 80px;
  height: 5px;
  border-radius: 20px;
  background: linear-gradient(90deg, #00f260, #ffdd00, #ff0000);
  background-size: 200% 100%;
  animation: slide 2s linear infinite;
}

.analyzing-text {
  font-size: 12px;
  color: #999;
  margin-top: 5px;
}

@keyframes slide {
  0% { background-position: 0% 0%; }
  100% { background-position: 200% 0%; }
}

.dots::after {
  content: '';
  animation: dots 1.5s steps(3, end) infinite;
}

@keyframes dots {
  0% { content: ''; }
  33% { content: '.'; }
  66% { content: '..'; }
  100% { content: '...'; }
}

.feedback-block {
  background: #1f1f2e;
  border-radius: 10px;
  padding: 15px 20px;
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.feedback-title {
  font-size: 16px;
  font-weight: 600;
  color: #fff;
  margin-bottom: 5px;
}

.feedback-text {
  font-size: 14px;
  color: #ccc;
  margin-bottom: 8px;
}

.feedback-badge {
  font-size: 13px;
  padding: 5px 12px;
  border-radius: 15px;
  width: fit-content;
  color: #fff;
  font-weight: 600;
}

.feedback-badge.green {
  background: #1fc85f;
}

.feedback-badge.amber {
  background: #f9a825;
}

.feedback-badge.red {
  background: #e53935;
}

.hidden {
  display: none;
}

/* Optional: Overall Score */
.overall-score {
  text-align: center;
  margin: 20px 0;
}

.score-circle {
  width: 100px;
  height: 100px;
  background: linear-gradient(to right, #00f260, #0575e6);
  color: #fff;
  font-size: 32px;
  font-weight: bold;
  line-height: 100px;
  border-radius: 50%;
  margin: 0 auto;
}

.score-label {
  font-size: 16px;
  color: #ccc;
  margin-top: 5px;
}

.analysis-feedback {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.result-card {
  display: flex;
  align-items: center;
  background: #1c1f2b;
  padding: 16px;
  border-radius: 10px;
  position: relative;
  box-shadow: 0 0 20px rgba(28, 31, 43, 0.7), 0 0 40px rgba(28, 31, 43, 0.5), 0 0 60px rgba(28, 31, 43, 0.3);
  transition: all 0.3s ease;
}

.result-icon {
  font-size: 22px;
  margin-right: 15px;
  color: #ccc;
  min-width: 30px;
}

.result-content h4 {
  margin: 0;
  font-size: 16px;
  color: #fff;
}

.result-content .result-desc {
  margin: 3px 0;
  color: #ccc;
  font-size: 14px;
}

.result-badge {
  padding: 4px 10px;
  border-radius: 20px;
  color: white;
  font-size: 12px;
  display: inline-block;
}

.badge-strong { background: #2ecc71; }
.badge-average { background: #f4b400; }
.badge-weak { background: #e74c3c; }



@keyframes typing {
  from { width: 0 }
  to { width: 135px }
}
@keyframes analyzingFade {
  0% { opacity: 0.2; }
  25% { opacity: 0.4; }
  50% { opacity: 0.6; }
  75% { opacity: 0.8; }
  100% { opacity: 1; }
}

.analyzing {
  animation: analyzingFade 1.2s ease-in-out infinite alternate;
  font-weight: 500;
  letter-spacing: 1px;
  opacity: 0.7;
}

.score-circle {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  font-size: 28px;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  background: radial-gradient(circle at center, #0861e7, #043bd0); /* Matches gauge gradient */
  position: relative;
  box-shadow: 0 0 20px rgba(8, 97, 231, 0.7), 0 0 40px rgba(8, 97, 231, 0.5), 0 0 60px rgba(8, 97, 231, 0.3);
  transition: all 0.3s ease-in-out;
  margin: 0 auto;
}
.score-label {
  text-align: center;
  color: #ccc;
  font-size: 16px;
  margin-top: 8px;
}
.score-circle {
  opacity: 0;
  animation: fadeIn 1s ease forwards;
  animation-delay: 2s;
}

@keyframes fadeIn {
  to {
    opacity: 1;
  }
}

.result-content p:not(:empty)::before {
  content: "•";
  color: #fff;
  margin-right: 6px;
}



/* Only make the feedback titles bold white */
.result-content p span.feedback-title {
  color: #fff !important;
  font-weight: bold !important;
}


.analyzing {
  position: fixed; /* Full screen overlay */
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.6); /* Optional: already have this */
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none; /* Allow clicks through if needed */
}

.analyzing-message {
  font-size: 22px;
  font-weight: bold;
  color: #fff;
  padding: 20px 40px;
  background: rgba(20, 0, 40, 0.85);
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(255, 0, 200, 0.5);
}








</style>
<script>
  document.querySelectorAll(".btn-upgrade").forEach(button => {
    button.addEventListener("click", () => {
      const lock = button.parentElement.querySelector(".padlock-icon");
      if (lock) {
        lock.classList.add("shake");
        setTimeout(() => lock.classList.remove("shake"), 400);
      }
    });
  });
</script>

<script>
  // Overall score circle animation - will be updated by displayGeminiResults
  const circle = document.querySelector('.score-circle');
  
  // Initialize with 0 and let displayGeminiResults update it with live data
  if (circle) {
    circle.textContent = '0';
    circle.style.opacity = 0;
  }
</script>



</div>






  <!-- End of your main content wrapper -->
   <!-- Close analyzer-wrapper or wrapper etc. -->

  <!-- 🌍 Full-Width Footer -->
 </div> <!-- 🌍 Full-Width Footer -->
</div> <!-- End of wrapper -->

<!-- START OF FILE -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CopyBoss</title>

  <style>
    body {
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    .main-wrapper {
      flex: 1;
    }



    .footer-line {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-bottom: 40px;
    }

    .footer-line div {
      width: 20%;
      max-width: 500px;
      border-top: 1px solid white;
    }

    .footer-icons {
      margin-bottom: 10px;
    }

    .footer-icons a {
      color: #ccc;
      margin-right: 15px;
      font-size: 18px;
    }
 
 #viralScoreFeedback::before,
#captionClarityFeedback::before,
#soundMatchFeedback::before,
#viewerUnderstandingFeedback::before,
#engagementForecastFeedback::before,
#viralStrengthFeedback::before {
  content: none !important;
}


.footer-pre-container {
  display: flex;
  justify-content: center; /* Center horizontally */
  align-items: center;
  width: 100%;
  margin-top: 70px; /* adjust spacing as needed */
}

.footer-pre-bar {
  background-color: #0a0f3a;
  color: white;
  padding: 10px 20px;
  font-weight: 600;
  border-radius: 10px;
  display: inline-block;
  text-align: center;
  margin: 0;
}

.footer-pre-bar span {
  font-size: 16px;
}

.footer-pre-bar a {
  color: #3ea6ff;
  text-decoration: none;
  font-weight: 600;
}

.footer-pre-bar a:hover {
  text-decoration: underline;
}


 footer {
  margin-top: 0 !important;
  padding-top: 0 !important;
  border-top: none !important;
  box-shadow: none !important;
  outline: none !important;
}




.result-content p::before {
  content: none !important;
}

#detailed-gemini-feedback::before {
  content: none !important;
}


/* Label Text */
.strength-text {
  color: #fff !important;
  font-weight: bold;
}


.chartjs-tooltip {
  background: #fff !important;
  color: #1a233a !important;
  border: 1px solid #1E88E5 !important;
  border-radius: 8px !important;
  padding: 8px 12px !important;
  font-size: 14px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}


.sidebar-link i {
  margin-right: 10px;
  width: 20px;
  text-align: center;
  transition: transform 0.4s ease;
}

.sidebar-link:hover i {
  transform: rotate(360deg);
}

.sidebar ul {
  list-style: none;
  padding-left: 0;
}



 </style>

<style>
  .btn-upgrade:hover {
    background-color: #4fc3f7 !important; /* Light blue */
    transform: scale(1.05);
    color: #fff !important;
  }
</style>





<script>
  function updateUserRank(rankText) {
    const rankEl = document.getElementById("userRank");
    const badge = rankEl.closest(".user-rank-badge");

    if (!rankEl || !badge) return;

    rankEl.textContent = rankText;

    // Add glow class
    badge.classList.add("glow");

    // Remove glow after 1.5s
    setTimeout(() => {
      badge.classList.remove("glow");
    }, 1500);
  }

  // Example usage
  updateUserRank("⚡ Content Climber");
</script>

















<footer class="new-footer">
  <div class="footer-container">
    <!-- Social Media Icons -->
    <div class="social-icons">
      <a href="https://twitter.com/copybosshq" target="_blank" class="social-link" aria-label="Twitter">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://facebook.com/copybosshq" target="_blank" class="social-link" aria-label="Facebook">
        <i class="fab fa-facebook"></i>
      </a>
      <a href="https://instagram.com/copybosshq" target="_blank" class="social-link" aria-label="Instagram">
        <i class="fab fa-instagram"></i>
      </a>
      <a href="https://www.tiktok.com/@copybosspro?lang=en-GB" target="_blank" class="social-link" aria-label="TikTok">
        <i class="fab fa-tiktok"></i>
      </a>
      <a href="https://youtube.com/copybosshq" target="_blank" class="social-link" aria-label="YouTube">
        <i class="fab fa-youtube"></i>
      </a>
    </div>

    <!-- Footer Links -->
    <div class="footer-links">
      <a href="#" onclick="console.log('Privacy clicked'); openLegalModal('privacy-modal'); return false;" class="footer-link">Privacy</a>
      <span class="link-separator">|</span>
      <a href="#" onclick="console.log('Terms clicked'); openLegalModal('terms-modal'); return false;" class="footer-link">Terms</a>
      <span class="link-separator">|</span>
      <a href="#" onclick="console.log('Support clicked'); openLegalModal('support-modal'); return false;" class="footer-link">Support</a>
    </div>

    <!-- Copyright -->
    <div class="copyright">
      © 2025 ZERRA Group Ltd. All rights reserved. CopyBoss™ is a product of ZERRA Group.
    </div>
  </div>
</footer>

<style>
/* Professional Stealth-Style Footer */
.new-footer {
  width: 100%;
  background: linear-gradient(to bottom, #071229, #0a1a3d, #102f5c);
  padding: 60px 40px 40px;
  color: #b8c5d6;
  font-family: 'Poppins', sans-serif;
  font-size: 14px;
  letter-spacing: 0.3px;
  margin: 0;
  position: relative;
  bottom: 0;
  left: 0;
  right: 0;
  flex-shrink: 0;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 220px;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
}

.footer-container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  text-align: center;
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 20px;
}

/* Social Icons */
.social-icons {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  margin-bottom: 20px;
}

.social-link {
  color: #8fa3c7;
  font-size: 20px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px;
  border-radius: 50%;
  text-decoration: none;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  width: 44px;
  height: 44px;
  position: relative;
  overflow: hidden;
}

.social-link::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.5s;
}

.social-link:hover {
  color: #ffffff;
  transform: translateY(-2px) scale(1.05);
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.3);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
}

.social-link:hover::before {
  left: 100%;
}

/* Footer Links */
.footer-links {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 15px;
  margin-bottom: 15px;
  flex-wrap: wrap;
}

.footer-link {
  color: #8fa3c7;
  text-decoration: none;
  transition: all 0.3s ease;
  font-weight: 500;
  font-size: 14px;
  padding: 5px 8px;
  border-radius: 4px;
  position: relative;
}

.footer-link::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  width: 0;
  height: 2px;
  background: linear-gradient(90deg, #4e54c8, #8f94fb);
  transition: all 0.3s ease;
  transform: translateX(-50%);
}

.footer-link:hover {
  color: #ffffff;
  background: rgba(255, 255, 255, 0.05);
}

.footer-link:hover::after {
  width: 100%;
}

.link-separator {
  color: #4a5568;
  font-weight: 300;
  font-size: 12px;
}

/* Enhanced Copyright */
.copyright {
  color: #8fa3c7;
  font-size: 13px;
  line-height: 1.4;
  max-width: 600px;
  margin: 0;
  font-weight: 400;
  letter-spacing: 0.2px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .new-footer {
    padding: 40px 20px;
    min-height: 180px;
  }
  
  .social-icons {
    gap: 15px;
    margin-bottom: 15px;
  }
  
  .social-link {
    font-size: 18px;
    width: 40px;
    height: 40px;
    padding: 8px;
  }
  
  .footer-links {
    gap: 12px;
    margin-bottom: 12px;
  }
  
  .footer-link {
    font-size: 13px;
  }
  
  .copyright {
    font-size: 12px;
    padding: 0 15px;
  }
}

@media (max-width: 480px) {
  .new-footer {
    padding: 30px 15px;
    min-height: 160px;
  }
  
  .social-icons {
    gap: 12px;
    margin-bottom: 12px;
  }
  
  .social-link {
    font-size: 16px;
    width: 36px;
    height: 36px;
    padding: 6px;
  }
  
  .footer-links {
    flex-direction: column;
    gap: 8px;
    margin-bottom: 10px;
  }
  
  .link-separator {
    display: none;
  }
  
  .footer-link {
    font-size: 12px;
  }
  
  .copyright {
    font-size: 11px;
    padding: 0 10px;
  }
}
</style>

<!-- Animated Analysis Overlay -->
<div id="loadingIndicator" style="
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(20,20,50,0.95));
  backdrop-filter: blur(10px);
  z-index: 9999;
  justify-content: flex-start;
  align-items: center;
  flex-direction: column;
  padding-top: 15vh;
">
  <!-- Animated Logo/Icon -->
  <div class="analysis-logo" style="
    width: 120px;
    height: 120px;
    border-radius: 50%;
    background: linear-gradient(135deg, #2248bc, #5f64ec);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 40px;
    animation: pulse 2s infinite;
    box-shadow: 0 0 30px rgba(34, 72, 188, 0.5);
  ">
    <i class="fa-sharp fa-solid fa-brain" style="font-size: 48px; color: white;"></i>
  </div>
  
  <!-- Main Text -->
  <h2 style="
    color: white;
    font-size: 28px;
    font-weight: 600;
    margin-bottom: 10px;
    text-align: center;
    font-family: 'Poppins', sans-serif;
  ">Analyzing your video...</h2>
  
  <!-- Subtitle -->
  <p style="
    color: #ccc;
    font-size: 16px;
    margin-bottom: 35px;
    text-align: center;
    font-family: 'Poppins', sans-serif;
  ">Our AI is processing your content</p>
  
  <!-- Progress Bar -->
  <div style="
    width: 300px;
    height: 6px;
    background: rgba(255,255,255,0.1);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 20px;
  ">
    <div id="progressBar" style="
      width: 0%;
      height: 100%;
      background: linear-gradient(90deg, #2248bc, #5f64ec);
      border-radius: 3px;
      transition: width 0.3s ease;
      animation: progress 3s ease-in-out infinite;
    "></div>
  </div>
  
  <!-- Timer -->
  <div id="analysisTimer" style="
    color: #aaa;
    font-size: 14px;
    font-family: 'Poppins', sans-serif;
  ">Starting analysis...</div>
  
  <!-- Loading Dots -->
  <div class="loading-dots" style="
    margin-top: 20px;
    display: flex;
    gap: 8px;
  ">
    <div style="
      width: 8px;
      height: 8px;
      background: #2248bc;
      border-radius: 50%;
      animation: dot1 1.4s infinite;
    "></div>
    <div style="
      width: 8px;
      height: 8px;
      background: #5f64ec;
      border-radius: 50%;
      animation: dot2 1.4s infinite;
    "></div>
    <div style="
      width: 8px;
      height: 8px;
      background: #2248bc;
      border-radius: 50%;
      animation: dot3 1.4s infinite;
    "></div>
  </div>
</div>

<style>
@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.05); opacity: 0.8; }
}

@keyframes progress {
  0% { width: 0%; }
  50% { width: 70%; }
  100% { width: 100%; }
}

@keyframes dot1 {
  0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

@keyframes dot2 {
  0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

@keyframes dot3 {
  0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

/* Comprehensive Neon Glow Effects for All Card Elements */
/* Unified blue neon theme for all cards */
.gauge-box:not(.pro-locked),
.gauge-box.pro-locked,
#soundGaugeCard,
#viewerGaugeCard,
#soundmatch-card,
#viewerunderstanding-card,
.chart-card,
.upload-box,
.score-circle,
.score-block,
.score-block.excellent,
.score-block.good,
.score-block.poor,
.history-card,
.pro-locked-results,
.results-card {
  position: relative;
  box-shadow: 0 0 20px rgba(59, 130, 246, 0.7), 0 0 40px rgba(59, 130, 246, 0.5), 0 0 60px rgba(59, 130, 246, 0.3);
}

/* Enhanced hover effects with intensified glow - unified blue theme */
.gauge-box:hover,
.gauge-box.pro-locked:hover,
#soundGaugeCard:hover,
#viewerGaugeCard:hover,
#soundmatch-card:hover,
#viewerunderstanding-card:hover,
.chart-card:hover,
.upload-box:hover,
.score-circle:hover,
.score-block:hover,
.score-block.excellent:hover,
.score-block.good:hover,
.score-block.poor:hover,
.history-card:hover,
.pro-locked-results:hover,
.results-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 30px rgba(59, 130, 246, 0.8), 0 0 50px rgba(59, 130, 246, 0.6), 0 0 70px rgba(59, 130, 246, 0.4);
}
</style>







<div id="pdf-container" style="display: none;"></div>













<!-- 🔊 Ding Sound Script -->
<audio id="analyze-sound" src="assets/audio/ding.mp3" preload="auto"></audio>

<script>
  const analyzeBtn = document.querySelector('.analyzer-row button');
  const dingSound = document.getElementById('analyze-sound');

  if (analyzeBtn && dingSound) {
    analyzeBtn.addEventListener('click', () => {
      dingSound.currentTime = 0;
      dingSound.play().catch(e => console.log("Autoplay blocked:", e));
    });
  }
</script>



<audio id="padlockSound" src="/assets/audio/padlock-click.mp3" preload="auto"></audio>


<script>
  // Unlock audio context on first interaction (Safari fix)
  let audioUnlocked = false;
  window.addEventListener("click", () => {
    if (!audioUnlocked) {
      const audio = document.getElementById("padlockSound");
      audio.play().then(() => {
        audio.pause();
        audio.currentTime = 0;
        audioUnlocked = true;
      }).catch(() => {
        // silence error
      });
    }
  });

  // Play padlock sound on hover — once unlocked
  document.querySelectorAll(".padlock-icon img").forEach(padlock => {
    padlock.addEventListener("mouseenter", () => {
      if (audioUnlocked) {
        const audio = document.getElementById("padlockSound");
        audio.currentTime = 0;
        audio.play();
      }
    });
  });
</script>

<script>
  document.querySelectorAll('.sidebar-btn').forEach(link => {
    link.addEventListener('click', function (e) {
      e.preventDefault();
      const targetId = this.getAttribute('data-target');
      const targetSection = document.getElementById(targetId);
      if (targetSection) {
        targetSection.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
</script>


<script>
  document.getElementById("graphHelpBtn")?.addEventListener("click", () => {
    Swal.fire({
      icon: "info",
      title: "How the Graph Works 📈",
      html: `
        <p style='text-align:left; font-size: 15px;'>
          This graph shows your <b>Viral Score over the last 7 uploads</b>.
          It updates automatically whenever you analyze a new video.<br><br>
          Hover over each dot to see the score for that day. 
          Use the dropdown to <b>reset</b>, <b>export</b>, or <b>compare</b> your latest scores.
        </p>
      `,
      confirmButtonText: "Got it!"
    });
  });
</script>








<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>





<script>
  document.getElementById('shareBtn')?.addEventListener('click', (e) => {
    e.preventDefault();
    
    // Close dropdown first
    const menu = document.getElementById("dropdownMenu");
    if (menu) {
      menu.style.display = "none";
    }
    
    // Check user access (Pro or credits)
    if (isProActive()) {
      // Pro user - allow sharing
      showShareOptions();
    } else if (hasCredits()) {
      // Credit user - allow sharing and optionally decrement credit
      showShareOptions();
      // Optionally decrement a credit
      useReportCredit();
    } else {
      // Free user - show upgrade modal
      showUpgradeModal();
    }
  });
</script>


<script>
  document.getElementById('exportBtn')?.addEventListener('click', (e) => {
    e.preventDefault();
    
    // Close dropdown first
    const menu = document.getElementById("dropdownMenu");
    if (menu) {
      menu.style.display = "none";
    }
    
    // Check user access (Pro or credits)
    if (isProActive()) {
      // Pro user - allow export
      downloadGraphImage();
    } else if (hasCredits()) {
      // Credit user - allow export and optionally decrement credit
      downloadGraphImage();
      // Optionally decrement a credit
      useReportCredit();
    } else {
      // Free user - show upgrade modal
      showUpgradeModal();
    }
  });
</script>




<script>
  async function handleFileUpload(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  // Trigger the analysis process
  runAnalysis();
}
</script>


<!-- Login Modal -->
<div id="loginModal" class="modal-overlay">
  <div class="modal">
    <h2>Login</h2>
    <input type="text" id="usernameInput" placeholder="Enter your name" />
    <button id="submitLogin">Continue</button>
  </div>
</div>

<script>
  // Run after DOM is ready
  document.addEventListener("DOMContentLoaded", () => {
    const loginBtn = document.getElementById("loginBtn");
    const loginModal = document.getElementById("loginModal");
    const submitLogin = document.getElementById("submitLogin");

    // Only add login events if elements exist
    if (loginBtn && loginModal && submitLogin) {
      loginBtn.addEventListener("click", () => {
        loginModal.style.display = "flex";
      });

      submitLogin.addEventListener("click", () => {
        const username = document.getElementById("usernameInput").value.trim();
        if (username) {
          localStorage.setItem("username", username);
          loginModal.style.display = "none";
          updateProfileDisplay(username);
        }
      });
    }

    // Auto-login check
    const savedName = localStorage.getItem("username");
    if (savedName) {
      updateProfileDisplay(savedName);
    }

    function updateProfileDisplay(name) {
      const profileHTML = `
        <div class="user-profile">
          <img src="/uploads/avatars/default.png" class="avatar-thumb" alt="Profile Picture">
          <div class="user-info">
            <div class="username">@${name}</div>
            <a href="#" class="edit-profile-link" onclick="logout()">Logout</a>
          </div>
        </div>
      `;

      // Replace the old login button
      const navRight = document.querySelector(".nav-right");
      if (navRight) navRight.innerHTML = profileHTML;

      // Also update the sidebar if needed
      const sidebarUsername = document.querySelector(".username");
      if (sidebarUsername) sidebarUsername.textContent = `@${name}`;
    }

    window.logout = function () {
      localStorage.removeItem("videobossUser");
      window.location.href = "index.html";
    };
  });
</script>








<script>
  const modalContentMap = {
    "share-report": {
      title: "Share Your Report 📤",
      html: `
        <div style='text-align:left; font-size:15px;'>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Shareable Link:</label>
            <div style="display: flex; gap: 8px; align-items: center;">
              <input type="text" id="shareLink" value="https://videoboss.app/report/XYZ123" readonly style="
                flex: 1;
                padding: 10px 12px;
                border: 1px solid #ddd;
                border-radius: 6px;
                background: #f8f9fa;
                font-size: 14px;
                color: #666;
                cursor: text;
              ">
              <button onclick="copyShareLink()" style="
                padding: 10px 16px;
                background: #2248bc;
                color: white;
                border: none;
                border-radius: 6px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                white-space: nowrap;
                transition: background 0.2s ease;
              ">Copy Link</button>
            </div>
          </div>
          <p style="margin: 0; color: #666; font-size: 14px;">
            Share this link with others to let them view your report.
          </p>
        </div>`
    },
    "upgrade-pro": {
      title: "Upgrade to Pro 💎",
      html: `
        <div style="text-align: center;">
          <div style="font-size: 48px; margin-bottom: 16px;">💎</div>
          <p style="font-size: 16px; color: #333; margin-bottom: 16px; line-height: 1.5;">
            Unlock all feedback gauges, trend data, and exclusive tools.
          </p>
          <div style="
            background: #f8f9fa;
            border-radius: 8px;
            padding: 16px;
            margin: 20px 0;
            text-align: left;
          ">
            <div style="font-weight: 600; margin-bottom: 8px; color: #333;">✨ Pro Features:</div>
            <ul style="margin: 0; padding-left: 20px; color: #666; font-size: 14px;">
              <li>All performance gauges unlocked</li>
              <li>Share and download reports</li>
              <li>Compare multiple videos</li>
              <li>Advanced analytics and insights</li>
              <li>Priority support</li>
            </ul>
          </div>
        </div>`
    },
    "settings-section": {
      title: "User Settings",
      html: `
        <div style='text-align:left; font-size:15px;'>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Default Chart Time Range:</label>
            <select id="chartTimeRange" style="
              width: 100%;
              padding: 10px 12px;
              border: 1px solid #ddd;
              border-radius: 6px;
              background: white;
              font-size: 14px;
              color: #333;
            ">
              <option value="7">Last 7 Days</option>
              <option value="30">Last 30 Days</option>
              <option value="all">All Time</option>
            </select>
          </div>
          
          <div style="margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
              <label style="font-weight: 600; color: #333;">Auto-Save Reports:</label>
              <div class="toggle-switch" onclick="toggleSetting('autoSave')" style="
                width: 50px;
                height: 24px;
                background: #ccc;
                border-radius: 12px;
                position: relative;
                cursor: pointer;
                transition: background 0.3s ease;
              ">
                <div id="autoSaveToggle" class="toggle-slider" style="
                  width: 20px;
                  height: 20px;
                  background: white;
                  border-radius: 50%;
                  position: absolute;
                  top: 2px;
                  left: 2px;
                  transition: transform 0.3s ease;
                "></div>
              </div>
            </div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
              <label style="font-weight: 600; color: #333;">Email Notifications:</label>
              <div class="toggle-switch" onclick="toggleSetting('emailNotifications')" style="
                width: 50px;
                height: 24px;
                background: #ccc;
                border-radius: 12px;
                position: relative;
                cursor: pointer;
                transition: background 0.3s ease;
              ">
                <div id="emailNotificationsToggle" class="toggle-slider" style="
                  width: 20px;
                  height: 20px;
                  background: white;
                  border-radius: 50%;
                  position: absolute;
                  top: 2px;
                  left: 2px;
                  transition: transform 0.3s ease;
                "></div>
              </div>
            </div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
              <label style="font-weight: 600; color: #333;">Show Interface Tips:</label>
              <div class="toggle-switch" onclick="toggleSetting('interfaceTips')" style="
                width: 50px;
                height: 24px;
                background: #ccc;
                border-radius: 12px;
                position: relative;
                cursor: pointer;
                transition: background 0.3s ease;
              ">
                <div id="interfaceTipsToggle" class="toggle-slider" style="
                  width: 20px;
                  height: 20px;
                  background: white;
                  border-radius: 50%;
                  position: absolute;
                  top: 2px;
                  left: 2px;
                  transition: transform 0.3s ease;
                "></div>
              </div>
            </div>
          </div>
          
          <div style="margin-bottom: 30px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Feedback Language:</label>
            <select id="feedbackLanguage" style="
              width: 100%;
              padding: 10px 12px;
              border: 1px solid #ddd;
              border-radius: 6px;
              background: white;
              font-size: 14px;
              color: #333;
            ">
              <option value="en">English</option>
            </select>
          </div>
          
          <button onclick="saveSettings()" style="
            width: 100%;
            padding: 12px 16px;
            background: #2248bc;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
          ">Save Settings</button>
        </div>`
    },
    "insights-section": {
      title: "Content Insights",
      html: `
        <div style='text-align:left; font-size:15px;'>
          <!-- Stats Grid -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 24px;">
            <div style="
              background: #f8f9fa;
              padding: 16px;
              border-radius: 8px;
              text-align: center;
              border: 1px solid #e9ecef;
            ">
              <div style="font-size: 24px; font-weight: bold; color: #2248bc; margin-bottom: 4px;">14</div>
              <div style="font-size: 12px; color: #666;">Total Videos Analyzed</div>
            </div>
            <div style="
              background: #f8f9fa;
              padding: 16px;
              border-radius: 8px;
              text-align: center;
              border: 1px solid #e9ecef;
            ">
              <div style="font-size: 24px; font-weight: bold; color: #28a745; margin-bottom: 4px;">71.5</div>
              <div style="font-size: 12px; color: #666;">Average Viral Score</div>
            </div>
          </div>
          
          <!-- Top Performing Video Card -->
          <div style="margin-bottom: 24px;">
            <h4 style="margin: 0 0 12px 0; font-size: 16px; color: #333;">🏆 Top Performing Video</h4>
            <div style="
              background: linear-gradient(135deg, #2248bc, #5f64ec);
              color: white;
              padding: 16px;
              border-radius: 8px;
              box-shadow: 0 4px 12px rgba(34, 72, 188, 0.2);
            ">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <div style="font-weight: 600; font-size: 14px;">"How to Make Viral Content"</div>
                <div style="
                  background: rgba(255,255,255,0.2);
                  padding: 4px 8px;
                  border-radius: 12px;
                  font-size: 12px;
                  font-weight: 600;
                ">89</div>
              </div>
              <div style="font-size: 12px; opacity: 0.9; margin-bottom: 8px;">
                #viral #content #tips #socialmedia
              </div>
              <div style="font-size: 12px; opacity: 0.8;">
                Duration: 2:34 • Posted: 3 days ago
              </div>
            </div>
          </div>
          
          <!-- Mini Chart -->
          <div style="margin-bottom: 24px;">
            <h4 style="margin: 0 0 12px 0; font-size: 16px; color: #333;">📈 Score Trend (Last 5 Analyses)</h4>
            <div style="
              background: #f8f9fa;
              padding: 16px;
              border-radius: 8px;
              border: 1px solid #e9ecef;
              height: 80px;
              display: flex;
              align-items: center;
              justify-content: center;
            ">
              <div style="
                width: 100%;
                height: 40px;
                background: linear-gradient(90deg, 
                  #28a745 0%, 
                  #28a745 20%, 
                  #ffc107 20%, 
                  #ffc107 40%, 
                  #28a745 40%, 
                  #28a745 60%, 
                  #dc3545 60%, 
                  #dc3545 80%, 
                  #28a745 80%, 
                  #28a745 100%
                );
                border-radius: 4px;
                position: relative;
              ">
                <div style="
                  position: absolute;
                  top: -20px;
                  left: 0;
                  right: 0;
                  display: flex;
                  justify-content: space-between;
                  font-size: 10px;
                  color: #666;
                ">
                  <span>65</span>
                  <span>72</span>
                  <span>68</span>
                  <span>89</span>
                  <span>71</span>
                </div>
              </div>
            </div>
          </div>
          
          <!-- View Full Report Button -->
          <button onclick="showProFeature()" style="
            width: 100%;
            padding: 12px 16px;
            background: linear-gradient(135deg, #2248bc, #5f64ec);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
          " title="Available with Pro plan">
            View Full Report
            <span style="
              position: absolute;
              top: -8px;
              right: -8px;
              background: #ffc107;
              color: #333;
              font-size: 10px;
              padding: 2px 6px;
              border-radius: 8px;
              font-weight: bold;
            ">PRO</span>
          </button>
        </div>`
    },
    "ai-tips": {
      title: "AI Tips to Go Viral",
      html: `
        <div style='text-align:left; font-size:15px;'>
          <div id="aiTipsContainer">
            <!-- Tips will be dynamically loaded here -->
          </div>
          <button onclick="loadMoreTips()" style="
            width: 100%;
            padding: 12px 16px;
            background: #2248bc;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s ease;
            margin-top: 20px;
          ">Show 5 More Tips</button>
        </div>`
    },
    "refer-section": {
      title: "Refer & Earn",
      html: `
        <div style='text-align:left; font-size:15px;'>
          <p style="margin-bottom: 20px; color: #333;">
            Invite a friend. When they sign up, you'll get a £1 credit towards your next report.
          </p>
          
          <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #333;">
              Your Referral Link:
            </label>
            <input 
              type="text" 
              id="referralLink" 
              value="https://yourdomain.com/ref/yourcode" 
              readonly 
              style="
                width: 100%;
                padding: 12px;
                border: 1px solid #ddd;
                border-radius: 6px;
                background-color: #f8f9fa;
                font-size: 14px;
                color: #666;
                margin-bottom: 12px;
              "
            >
            <div style="display: flex; gap: 8px;">
              <button onclick="copyReferralLink()" style="
                flex: 1;
                padding: 10px 16px;
                background: #2248bc;
                color: white;
                border: none;
                border-radius: 6px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.2s ease;
              ">Copy Link</button>
              <button onclick="shareReferralLink()" style="
                flex: 1;
                padding: 10px 16px;
                background: #28a745;
                color: white;
                border: none;
                border-radius: 6px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.2s ease;
              ">Share</button>
            </div>
          </div>
        </div>`
    },
    "compare-videos": {
      title: "Compare With Past Videos",
      html: `
        <div style='text-align:left; font-size:15px;'>
          <p style="margin-bottom: 20px; color: #666; font-size: 14px;">
            Select one or more of your past uploads to compare their performance with your current video.
          </p>
          
          <div id="videoComparisonList" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;">
            <!-- Video entries will be dynamically loaded here -->
          </div>
          
          <button id="compareSelectedBtn" onclick="compareSelectedVideos()" class="compare-btn disabled">
            Compare
            <span id="proTag" style="background: #8e7cff; color: white; font-size: 10px; padding: 2px 6px; border-radius: 4px; margin-left: 8px; font-weight: bold; vertical-align: middle; display: ${userIsPro ? 'none' : 'inline-block'};">PRO</span>
          </button>
        </div>`
    }
  };

  document.querySelectorAll('.sidebar-btn').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const target = link.dataset.target;

      if (target === "analyzer-history") {
        const history = JSON.parse(localStorage.getItem("analysisHistory")) || [];

        if (!history.length) {
          Swal.fire({
            icon: "info",
            title: "Analyzer History 📁",
            html: `<p style='text-align:left;'>You haven't analyzed any videos yet. Run your first video through the analyzer to see it here.</p>`,
            confirmButtonText: "Got it!"
          });
          return;
        }

        let html = `<div style="display: flex; flex-direction: column; gap: 16px; text-align: left; max-height: 400px; overflow-y: auto;">`;

        history.reverse().forEach(entry => {
          html += `
            <div class="history-card" style="padding:12px;border:1px solid #ccc;border-radius:8px;">
              <h3 style="margin: 0 0 6px;">🎬 ${entry.title || 'Untitled Video'}</h3>
              <p style="margin: 0 0 6px;">Score: <strong>${entry.score || 'N/A'}</strong> • Date: ${entry.date || 'Unknown'}</p>
              <button onclick="viewReport('${entry.id}')" style="padding:6px 12px;border:none;background:#4f46e5;color:#fff;border-radius:6px;">View Report</button>
            </div>
          `;
        });

        html += `</div>`;
        html += `
          <button id="clear-history-btn" style="margin-top: 16px; padding: 10px 16px; background: #dc2626; color: white; border: none; border-radius: 6px; cursor: pointer;">
            🗑️ Clear All History
          </button>
         
        `;

        Swal.fire({
          icon: "info",
          title: "Analyzer History 📁",
          html: html,
          confirmButtonText: "Close"
        });

        setTimeout(() => {
          const clearBtn = document.getElementById("clear-history-btn");
          const downloadBtn = document.getElementById("download-latest-btn");

          if (clearBtn) {
            clearBtn.addEventListener("click", () => {
              if (confirm("Are you sure you want to clear all analyzer history?")) {
                localStorage.removeItem("analysisHistory");
                Swal.fire({
                  icon: "success",
                  title: "History Cleared ✅",
                  html: `<p style='text-align:left;'>Your analyzer history has been successfully cleared.</p>`,
                  confirmButtonText: "OK"
                });
              }
            });
          }

          if (downloadBtn) {
            downloadBtn.addEventListener("click", () => {
              const latest = history[history.length - 1];
              const pdfContainer = document.createElement("div");
              pdfContainer.style.padding = "24px";
              pdfContainer.innerHTML = `
                <h2 style="color:#4f46e5;">📄 VideoBoss Analysis Report</h2>
                <hr style="margin:12px 0;">
                <p><strong>📌 Title:</strong> ${latest.title || "Untitled"}</p>
                <p><strong>📅 Date:</strong> ${latest.date || "Unknown"}</p>
                <p><strong>📊 Score:</strong> ${latest.score || "N/A"}</p>
                <p><strong>📝 Summary:</strong> ${latest.summary || "No summary available."}</p>
                <br><p style="font-size:13px;color:gray;">Generated with VideoBoss Analyzer</p>
              `;
              document.body.appendChild(pdfContainer);

              html2pdf().from(pdfContainer).set({
                margin: 10,
                filename: `${latest.title || "analysis-report"}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
              }).save().then(() => {
                document.body.removeChild(pdfContainer);
                Swal.fire({
                  icon: "success",
                  title: "PDF Downloaded 🎉",
                  html: `<p style='text-align:left;'>Your report has been saved successfully.</p>`,
                  confirmButtonText: "Done"
                });
              });
            });
          }
        }, 100);
  } else if (target === "download-results") {
  console.log('[downloadPDF] Current feedback in window:', window.feedback);
  console.log('[downloadPDF] Feedback type:', typeof window.feedback);
  console.log('[downloadPDF] Feedback keys:', Object.keys(window.feedback || {}));
  
  // Check if we have current feedback from live analysis
  if (!window.feedback || !window.feedback.feedback) {
    Swal.fire({
      icon: "warning",
      title: "No Analysis Results",
      text: "Please analyze a video first to generate a report.",
    });
    return;
  }

  const feedback = window.feedback.feedback;

  Swal.fire({
    title: "Download Report?",
    text: "Do you want to download your latest analysis as a PDF?",
    icon: "question",
    showCancelButton: true,
    confirmButtonText: "Yes, download it",
    cancelButtonText: "Cancel"
  }).then(result => {
    if (result.isConfirmed) {
      console.log('[downloadPDF] User confirmed download. Starting PDF generation...');
      console.log('[downloadPDF] Template fetch starting...');
      
      // Fetch the template and inject dynamic data
      fetch('analyzer-report-template.html')
        .then(res => res.text())
        .then(template => {
          console.log('[downloadPDF] Template loaded successfully');
                      // Access live Gemini results from window.feedback with comprehensive safety checks
            const fb = window.feedback || {};
            const feedback = fb.feedback || {};

            // Debug logging to console
            console.log('🔍 PDF Generation Debug Info:');
            console.log('Full window.feedback:', fb);
            console.log('Feedback object:', feedback);
            console.log('Feedback keys:', Object.keys(feedback));
            console.log('ViralScore exists:', !!feedback.viralScore);
            console.log('ViralScore value:', feedback.viralScore);
            console.log('ViralScore score:', feedback.viralScore?.score);
          
          // Comprehensive check if Gemini results are available
          if (!feedback || typeof feedback !== 'object') {
            console.warn('❌ No feedback object found');
            Swal.fire({
              icon: "warning",
              title: "No Analysis Results",
              text: "Please analyze a video first to generate Gemini feedback for the PDF.",
              confirmButtonText: "OK"
            });
            return;
          }
          
          if (!feedback.viralScore) {
            console.warn('❌ No viralScore found in feedback object');
            Swal.fire({
              icon: "warning",
              title: "No Analysis Results",
              text: "Please analyze a video first to generate Gemini feedback for the PDF.",
              confirmButtonText: "OK"
            });
            return;
          }
          
          // Prepare dynamic content for template with live Gemini data
          const summaryHTML = fb.summary || 'Analysis completed successfully.';
          
          // Build score grid with actual Gemini feedback and safe fallbacks
          const scoreHTML = `
            <div class="score-block ${getScoreQuality(feedback.viralScore?.score || 0)}">
              <span class="label">🔥 Viral Score</span>
              ${feedback.viralScore?.score || "N/A"}
            </div>
            <div class="score-block ${getScoreQuality(feedback.hookStrength?.score || 0)}">
              <span class="label">⚡ Hook Strength</span>
              ${feedback.hookStrength?.score || "N/A"}
            </div>
            <div class="score-block ${getScoreQuality(feedback.captionClarity?.score || 0)}">
              <span class="label">💬 Caption Clarity</span>
              ${feedback.captionClarity?.score || "N/A"}
            </div>
            <div class="score-block ${getScoreQuality(feedback.soundMatch?.score || 0)}">
              <span class="label">🎵 Audio Match</span>
              ${feedback.soundMatch?.score || "N/A"}
            </div>
            <div class="score-block ${getScoreQuality(feedback.viewerUnderstanding?.score || 0)}">
              <span class="label">👁️ Viewer Understanding</span>
              ${feedback.viewerUnderstanding?.score || "N/A"}
            </div>
            <div class="score-block ${getScoreQuality(feedback.engagementForecast?.score || 0)}">
              <span class="label">📈 Engagement Forecast</span>
              ${feedback.engagementForecast?.score || "N/A"}
            </div>
          `;
          
          // Build feedback grid with detailed Gemini feedback and safe fallbacks
          const feedbackHTML = `
            <div class="ai-feedback-block">
              <strong>Viral Score:</strong>
              ${feedback.viralScore?.detail || 'No feedback available'}
            </div>
            <div class="ai-feedback-block">
              <strong>Hook Strength:</strong>
              ${feedback.hookStrength?.detail || 'No feedback available'}
            </div>
            <div class="ai-feedback-block">
              <strong>Caption Clarity:</strong>
              ${feedback.captionClarity?.detail || 'No feedback available'}
            </div>
            <div class="ai-feedback-block">
              <strong>Audio Match:</strong>
              ${feedback.soundMatch?.detail || 'No feedback available'}
            </div>
            <div class="ai-feedback-block">
              <strong>Viewer Understanding:</strong>
              ${feedback.viewerUnderstanding?.detail || 'No feedback available'}
            </div>
            <div class="ai-feedback-block">
              <strong>Engagement Forecast:</strong>
              ${feedback.engagementForecast?.detail || 'No feedback available'}
            </div>
          `;

          // Replace placeholders in template
          let filled = template;
          filled = filled.replace("{{summaryBlock}}", summaryHTML);
          filled = filled.replace("{{scoreGrid}}", scoreHTML);
          filled = filled.replace("{{feedbackGrid}}", feedbackHTML);
          filled = filled.replace("[Will auto-fill]", new Date().toLocaleString());

          // Create temp div for PDF generation
          const tempDiv = document.createElement('div');
          tempDiv.innerHTML = filled;
          document.body.appendChild(tempDiv);
          
          // Generate PDF
          html2pdf()
            .from(tempDiv)
            .set({ 
              filename: 'VideoBoss_Report.pdf',
              margin: 10,
              image: { type: 'jpeg', quality: 0.98 },
              html2canvas: { scale: 2 },
              jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
            })
            .save()
            .then(() => {
              document.body.removeChild(tempDiv);
              Swal.fire({
                icon: "success",
                title: "PDF Downloaded! 🎉",
                text: "Your report has been saved successfully.",
                confirmButtonText: "Done"
              });
            })
            .catch(err => {
              console.error('❌ PDF generation failed:', err);
              document.body.removeChild(tempDiv);
              Swal.fire({
                icon: "error",
                title: "PDF Generation Failed",
                text: "Something went wrong. Please try again.",
                confirmButtonText: "OK"
              });
            });
        })
        .catch(err => {
          console.error('❌ Failed to load template or render PDF:', err);
          Swal.fire({
            icon: "error",
            title: "Template Loading Failed",
            text: "Something went wrong. Check the console for errors.",
            confirmButtonText: "OK"
          });
        });
    }
  });
}



// ✅ Continue your modalContentMap logic below
else if (modalContentMap[target]) {
  const content = modalContentMap[target];
  
  if (target === "share-report") {
    // Check Pro access for share report
    if (!checkProAccess('share-report')) {
      return;
    }
    Swal.fire({
      title: content.title,
      html: content.html,
      showCloseButton: true,
      showConfirmButton: false,
      width: 500,
      customClass: {
        popup: 'swal2-popup-custom'
      }
    });
  } else if (target === "download-results") {
    // Check Pro access for download results
    if (!checkProAccess('download-results')) {
      return;
    }
    // Handle download results (existing logic)
    console.log('[downloadPDF] Current feedback in window:', window.feedback);
    console.log('[downloadPDF] Feedback type:', typeof window.feedback);
    console.log('[downloadPDF] Feedback keys:', Object.keys(window.feedback || {}));
    
    // Check if we have current feedback from live analysis
    if (!window.feedback || !window.feedback.feedback) {
      Swal.fire({
        icon: "warning",
        title: "No Analysis Results",
        text: "Please analyze a video first to generate a report.",
      });
      return;
    }
    
    // Continue with existing download logic...
    const feedback = window.feedback.feedback;
    
    Swal.fire({
      title: "Download Report?",
      text: "Do you want to download your latest analysis as a PDF?",
      icon: "question",
      showCancelButton: true,
      confirmButtonText: "Yes, download it",
      cancelButtonText: "Cancel"
    }).then(result => {
      if (result.isConfirmed) {
        // Existing download logic...
        console.log('[downloadPDF] User confirmed download. Starting PDF generation...');
        // ... rest of the download logic
      }
    });
  } else if (target === "upgrade-pro") {
    // Handle upgrade to Pro based on system status
    if (UPGRADE_SYSTEM_ACTIVE) {
      // Show existing upgrade modal with benefits
      Swal.fire({
        title: "Upgrade to Pro 💎",
        html: `
          <div style="text-align: center;">
            <div style="font-size: 48px; margin-bottom: 16px;">💎</div>
            <p style="font-size: 16px; color: #333; margin-bottom: 16px; line-height: 1.5;">
              Unlock all feedback gauges, trend data, and exclusive tools.
            </p>
            <div style="
              background: linear-gradient(135deg, rgba(108, 99, 255, 0.1), rgba(142, 124, 255, 0.1));
              border: 1px solid rgba(142, 124, 255, 0.2);
              border-radius: 8px;
              padding: 16px;
              margin: 20px 0;
              text-align: left;
            ">
              <div style="font-weight: 600; margin-bottom: 8px; color: #333;">✨ Pro Features:</div>
              <ul style="margin: 0; padding-left: 20px; color: #666; font-size: 14px;">
                <li>All performance gauges unlocked</li>
                <li>Share and download reports</li>
                <li>Compare multiple videos</li>
                <li>Advanced analytics and insights</li>
                <li>Priority support</li>
              </ul>
            </div>
          </div>
        `,
        confirmButtonText: "Upgrade Now",
        confirmButtonColor: "#8e7cff",
        showCancelButton: true,
        cancelButtonText: "Maybe Later",
        cancelButtonColor: "#6c757d",
        width: 500,
        customClass: {
          popup: 'swal2-popup-custom'
        }
      }).then((result) => {
        if (result.isConfirmed) {
          // Redirect to Stripe checkout page
          window.open('https://buy.stripe.com/test_28o5kC0QZ8QZ8QZ8QZ', '_blank');
        }
      });
    } else {
      // Show "coming soon" modal
      Swal.fire({
        title: "Upgrade Coming Soon!",
        html: `
          <div style="text-align: center;">
            <div style="font-size: 48px; margin-bottom: 16px;">🚀</div>
            <p style="font-size: 16px; color: #333; margin-bottom: 16px; line-height: 1.5;">
              Pro features will be available soon. Stay tuned!
            </p>
          </div>
        `,
        confirmButtonText: "Got it!",
        confirmButtonColor: "#2248bc",
        width: 400,
        customClass: {
          popup: 'swal2-popup-custom'
        }
      });
    }
  } else if (target === "settings-section" || target === "insights-section" || target === "ai-tips" || target === "refer-section" || target === "compare-videos") {
    Swal.fire({
      title: content.title,
      html: content.html,
      showCloseButton: true,
      showConfirmButton: false,
      width: 500,
      customClass: {
        popup: 'swal2-popup-custom'
      }
    });
    
    // Initialize modals after they are shown (not when closed)
    if (target === "ai-tips") {
      setTimeout(() => {
        initializeAITips();
      }, 100);
    } else if (target === "compare-videos") {
      setTimeout(() => {
        initializeVideoComparison();
      }, 200);
    }
  } else {
    modalBody.innerHTML = content.html;
    modal.classList.add("show");
    overlay.classList.add("show");
  }
}
    }); // end of link.addEventListener
  });   // end of document.querySelectorAll

// Helper function for score quality with safe fallbacks
function getScoreQuality(score) {
  if (!score || isNaN(score) || score === 0) return 'poor';
  if (score >= 70) return 'good';
  if (score >= 50) return 'warn';
  return 'poor';
}

// Function to validate feedback structure
function validateFeedback(feedback) {
  if (!feedback || typeof feedback !== 'object') {
    console.warn('❌ Invalid feedback object:', feedback);
    return false;
  }
  
  const requiredKeys = ['viralScore', 'hookStrength', 'captionClarity', 'soundMatch', 'viewerUnderstanding', 'engagementForecast'];
  const hasAllKeys = requiredKeys.every(key => feedback[key] && typeof feedback[key].score === 'number');
  
  if (!hasAllKeys) {
    console.warn('❌ Missing required feedback keys or invalid scores:', feedback);
    return false;
  }
  
  console.log('✅ Feedback validation passed');
  return true;
}

// Function to copy share link to clipboard
function copyShareLink() {
  const shareLink = document.getElementById('shareLink');
  if (shareLink) {
    navigator.clipboard.writeText(shareLink.value).then(() => {
      // Show success feedback
      const copyBtn = event.target;
      const originalText = copyBtn.textContent;
      copyBtn.textContent = 'Copied!';
      copyBtn.style.background = '#28a745';
      
      setTimeout(() => {
        copyBtn.textContent = originalText;
        copyBtn.style.background = '#2248bc';
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy link:', err);
      // Fallback for older browsers
      shareLink.select();
      document.execCommand('copy');
      
      const copyBtn = event.target;
      const originalText = copyBtn.textContent;
      copyBtn.textContent = 'Copied!';
      copyBtn.style.background = '#28a745';
      
      setTimeout(() => {
        copyBtn.textContent = originalText;
        copyBtn.style.background = '#2248bc';
      }, 2000);
    });
  }
}

// Function to toggle settings
function toggleSetting(settingName) {
  const toggle = document.getElementById(settingName + 'Toggle');
  const toggleSwitch = toggle.parentElement;
  
  if (toggle.style.transform === 'translateX(26px)') {
    // Turn off
    toggle.style.transform = 'translateX(0)';
    toggleSwitch.style.background = '#ccc';
  } else {
    // Turn on
    toggle.style.transform = 'translateX(26px)';
    toggleSwitch.style.background = '#2248bc';
  }
}

// Function to save settings
function saveSettings() {
  // Get all setting values
  const chartTimeRange = document.getElementById('chartTimeRange').value;
  const autoSave = document.getElementById('autoSaveToggle').style.transform === 'translateX(26px)';
  const emailNotifications = document.getElementById('emailNotificationsToggle').style.transform === 'translateX(26px)';
  const interfaceTips = document.getElementById('interfaceTipsToggle').style.transform === 'translateX(26px)';
  const feedbackLanguage = document.getElementById('feedbackLanguage').value;
  
  // Save to localStorage (for demo purposes)
  const settings = {
    chartTimeRange,
    autoSave,
    emailNotifications,
    interfaceTips,
    feedbackLanguage
  };
  
  localStorage.setItem('userSettings', JSON.stringify(settings));
  
  // Show success toast
  Toastify({
    text: "Settings saved successfully",
    duration: 3000,
    gravity: "top",
    position: "right",
    backgroundColor: "#28a745",
    stopOnFocus: true
  }).showToast();
  
  // Close modal
  Swal.close();
}

// Function to show pro feature notification
function showProFeature() {
  Swal.fire({
    title: "Pro Feature 🔒",
    html: `
      <div style="text-align: center;">
        <div style="font-size: 48px; margin-bottom: 16px;">💎</div>
        <p style="font-size: 16px; color: #333; margin-bottom: 16px;">
          Full insights and detailed reports are available with our Pro plan.
        </p>
        <p style="font-size: 14px; color: #666;">
          Upgrade to unlock advanced analytics, trend predictions, and comprehensive performance insights.
        </p>
      </div>
    `,
    showCancelButton: true,
    confirmButtonText: "Upgrade to Pro",
    cancelButtonText: "Maybe Later",
    confirmButtonColor: "#2248bc",
    width: 400
  }).then((result) => {
    if (result.isConfirmed) {
      // Redirect to upgrade page or show upgrade modal
      Swal.fire({
        title: "Coming Soon! 🚀",
        text: "Pro features will be available soon. Stay tuned for updates!",
        icon: "info",
        confirmButtonText: "Got it!"
      });
    }
  });
}



// Function to render video comparison list
function renderVideoComparisonList() {
  const container = document.getElementById('videoComparisonList');
  if (!container) return;
  
  // Get uploaded videos from localStorage
  const history = JSON.parse(localStorage.getItem("analysisHistory")) || [];
  
  if (history.length === 0) {
    container.innerHTML = `
      <div style="
        text-align: center;
        padding: 40px 20px;
        color: #666;
        background: #f8f9fa;
        border-radius: 8px;
        border: 1px solid #e9ecef;
        animation: fadeIn 0.3s ease-in-out;
      ">
        <div style="font-size: 48px; margin-bottom: 16px;">📁</div>
        <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">You haven't uploaded any past videos yet</div>
        <div style="font-size: 14px;">Upload one first to compare.</div>
      </div>
    `;
    return;
  }
  
  // Format videos with proper structure and classes
  let html = `<div style="display: flex; flex-direction: column; gap: 12px; text-align: left;">`;
  
  // Show most recent videos first
  history.forEach((entry, index) => {
    // Create a readable timestamp
    const uploadTime = entry.timestamp ? new Date(entry.timestamp).toLocaleTimeString('en-US', { 
      hour12: false, 
      hour: '2-digit', 
      minute: '2-digit', 
      second: '2-digit' 
    }) : 'Unknown';
    
    // Use video title or filename as thumbnail/title
    const videoTitle = entry.title || `Video ${index + 1}`;
    
    html += `
      <div class="video-item" style="
        display: flex;
        align-items: center;
        padding: 12px;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        background: #fff;
        cursor: pointer;
        transition: all 0.2s ease;
        animation: fadeIn 0.3s ease-in-out;
      " data-video-id="${entry.id}">
        <input 
          type="checkbox" 
          class="compare-checkbox"
          id="video-${entry.id}" 
          data-video-id="${entry.id}"
          style="margin-right: 12px; transform: scale(1.2);"
        >
        <div style="flex: 1; font-size: 14px; color: #333;">
          <div style="font-weight: 600; margin-bottom: 4px;">🎬 ${videoTitle}</div>
          <div style="font-size: 12px; color: #666;">
            ${uploadTime} • Score: <strong>${entry.score || 'N/A'}</strong> • Date: ${entry.date || 'Unknown'}
          </div>
        </div>
      </div>
    `;
  });
  
  html += `</div>`;
  container.innerHTML = html;
  
  // Update button state after checkboxes are rendered
  updateCompareButton();
}

// Function to update compare button state
function updateCompareButton() {
  const checkboxes = document.querySelectorAll('#videoComparisonList .compare-checkbox:checked');
  const compareBtn = document.getElementById('compareSelectedBtn');
  const proTag = document.getElementById('proTag');
  
  if (compareBtn) {
    if (checkboxes.length > 0) {
      // Enable button
      compareBtn.disabled = false;
      compareBtn.removeAttribute('disabled');
      compareBtn.classList.remove('disabled');
      compareBtn.classList.add('enabled');
      
      // Show PRO tag for free users
      if (proTag && !userIsPro) {
        proTag.style.display = 'inline-block';
      }
    } else {
      // Disable button
      compareBtn.disabled = true;
      compareBtn.setAttribute('disabled', 'disabled');
      compareBtn.classList.remove('enabled');
      compareBtn.classList.add('disabled');
      
      // Hide PRO tag when disabled
      if (proTag) {
        proTag.style.display = 'none';
      }
    }
  }
}

// Function to toggle video selection (for clicking on the card)
function toggleVideoSelection(videoId) {
  const checkbox = document.getElementById(`video-${videoId}`);
  if (checkbox) {
    checkbox.checked = !checkbox.checked;
    updateCompareButton();
  }
}

// Function to compare selected videos
function compareSelectedVideos() {
  const selectedVideos = Array.from(document.querySelectorAll('#videoComparisonList .compare-checkbox:checked'))
    .map(checkbox => {
      const videoId = checkbox.id.replace('video-', '');
      const history = JSON.parse(localStorage.getItem("analysisHistory")) || [];
      return history.find(entry => entry.id === videoId);
    })
    .filter(video => video); // Remove any undefined entries
  
  if (selectedVideos.length === 0) {
    Toastify({
      text: "Please select at least one video to compare",
      duration: 3000,
      gravity: "top",
      position: "right",
      backgroundColor: "#dc3545",
      stopOnFocus: true
    }).showToast();
    return;
  }
  
  // Close the comparison modal
  Swal.close();
  
  if (userIsPro) {
    // Show comparison results for Pro users
    showComparisonResults(selectedVideos);
  } else {
    // Show upgrade modal for Free users
    showUpgradeModal();
  }
}

// Function to show comparison results for Pro users
function showComparisonResults(selectedVideos) {
  // Create a new comparison page/section
  const comparisonSection = document.createElement('div');
  comparisonSection.id = 'comparisonSection';
  comparisonSection.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #1a233a;
    z-index: 10000;
    overflow-y: auto;
    padding: 20px;
  `;
  
  let comparisonHTML = `
    <div style="max-width: 1200px; margin: 0 auto; color: white;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
        <h1 style="margin: 0; font-size: 28px; font-weight: 600;">📊 Video Comparison Results</h1>
        <button onclick="closeComparisonSection()" style="
          background: #dc3545;
          color: white;
          border: none;
          padding: 10px 20px;
          border-radius: 8px;
          cursor: pointer;
          font-size: 14px;
        ">Close Comparison</button>
      </div>
      
      <div style="
        background: #2e3b5e;
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
      ">
        <h2 style="margin: 0 0 10px 0; font-size: 18px; color: #fff;">Selected Videos: ${selectedVideos.length}</h2>
        <p style="margin: 0; color: #ccc; font-size: 14px;">Here's how your selected videos stack up against each other</p>
      </div>
      
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
  `;
  
  selectedVideos.forEach((video, index) => {
    const uploadDate = video.date || 'Unknown';
    const score = video.score || 'N/A';
    const summary = video.summary || 'No summary available';
    
    // Generate placeholder metrics based on score
    const hookStrength = Math.max(0, Math.min(100, score + Math.floor(Math.random() * 20) - 10));
    const captionQuality = Math.max(0, Math.min(100, score + Math.floor(Math.random() * 15) - 8));
    const soundMatch = Math.max(0, Math.min(100, score + Math.floor(Math.random() * 25) - 12));
    
    comparisonHTML += `
      <div style="
        background: #2e3b5e;
        border-radius: 12px;
        padding: 20px;
        border: 1px solid #4a5568;
      ">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h3 style="margin: 0; font-size: 16px; font-weight: 600; color: #fff;">🎬 ${video.title || 'Untitled Video'}</h3>
          <div style="
            background: ${score >= 70 ? '#28a745' : score >= 50 ? '#ffc107' : '#dc3545'};
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
          ">Score: ${score}</div>
        </div>
        
        <div style="margin-bottom: 15px;">
          <p style="margin: 0 0 8px 0; font-size: 12px; color: #a0aec0;">📅 Uploaded: ${uploadDate}</p>
          <p style="margin: 0; font-size: 13px; color: #e2e8f0; line-height: 1.4;">${summary}</p>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
          <div style="text-align: center; padding: 10px; background: #4a5568; border-radius: 6px;">
            <div style="font-size: 11px; color: #a0aec0; margin-bottom: 4px;">Hook Strength</div>
            <div style="font-size: 14px; font-weight: 600; color: #fff;">${hookStrength}%</div>
          </div>
          <div style="text-align: center; padding: 10px; background: #4a5568; border-radius: 6px;">
            <div style="font-size: 11px; color: #a0aec0; margin-bottom: 4px;">Caption Quality</div>
            <div style="font-size: 14px; font-weight: 600; color: #fff;">${captionQuality}%</div>
          </div>
          <div style="text-align: center; padding: 10px; background: #4a5568; border-radius: 6px;">
            <div style="font-size: 11px; color: #a0aec0; margin-bottom: 4px;">Sound Match</div>
            <div style="font-size: 14px; font-weight: 600; color: #fff;">${soundMatch}%</div>
          </div>
        </div>
      </div>
    `;
  });
  
  comparisonHTML += `
      </div>
    </div>
  `;
  
  comparisonSection.innerHTML = comparisonHTML;
  document.body.appendChild(comparisonSection);
}

// Function to close comparison section
function closeComparisonSection() {
  const comparisonSection = document.getElementById('comparisonSection');
  if (comparisonSection) {
    comparisonSection.remove();
  }
}

// Function to show upgrade modal for Free users
function showUpgradeModal() {
  Swal.fire({
    title: "Upgrade to Pro to Compare Videos",
    html: `
      <div style="text-align: center;">
        <div style="font-size: 48px; margin-bottom: 16px;">🔒</div>
        <p style="font-size: 16px; color: #333; margin-bottom: 16px; line-height: 1.5;">
          See side-by-side insights and performance metrics to improve your content.
        </p>
        <div style="
          background: #f8f9fa;
          border-radius: 8px;
          padding: 16px;
          margin: 20px 0;
          text-align: left;
        ">
          <div style="font-weight: 600; margin-bottom: 8px; color: #333;">✨ Pro Features:</div>
          <ul style="margin: 0; padding-left: 20px; color: #666; font-size: 14px;">
            <li>Compare multiple videos side-by-side</li>
            <li>Detailed performance metrics</li>
            <li>Hook strength analysis</li>
            <li>Caption quality insights</li>
            <li>Sound match evaluation</li>
          </ul>
        </div>
      </div>
    `,
    confirmButtonText: "Upgrade Now",
    confirmButtonColor: "#ff6b35",
    showCancelButton: true,
    cancelButtonText: "Maybe Later",
    cancelButtonColor: "#6c757d",
    width: 500,
    customClass: {
      popup: 'swal2-popup-custom'
    }
  }).then((result) => {
    if (result.isConfirmed) {
      // Redirect to Stripe checkout page
      window.open('https://buy.stripe.com/test_28o5kC0QZ8QZ8QZ8QZ', '_blank');
    }
  });
}

// Function to show upgrade modal for Share/Download features
function showShareDownloadUpgradeModal() {
  Swal.fire({
    title: "Unlock with Pro",
    html: `
      <div style="text-align: center;">
        <div style="font-size: 48px; margin-bottom: 16px;">🔒</div>
        <p style="font-size: 16px; color: #333; margin-bottom: 16px; line-height: 1.5;">
          Unlock with Pro to share or download reports.
        </p>
        <div style="
          background: linear-gradient(135deg, rgba(108, 99, 255, 0.1), rgba(142, 124, 255, 0.1));
          border: 1px solid rgba(142, 124, 255, 0.2);
          border-radius: 8px;
          padding: 16px;
          margin: 20px 0;
          text-align: left;
        ">
          <div style="font-weight: 600; margin-bottom: 8px; color: #333;">✨ Pro Features:</div>
          <ul style="margin: 0; padding-left: 20px; color: #666; font-size: 14px;">
            <li>Share reports with others</li>
            <li>Download PDF reports</li>
            <li>Compare multiple videos</li>
            <li>Access all performance gauges</li>
          </ul>
        </div>
      </div>
    `,
    confirmButtonText: "Upgrade Now",
    confirmButtonColor: "#8e7cff",
    showCancelButton: true,
    cancelButtonText: "Maybe Later",
    cancelButtonColor: "#6c757d",
    width: 500,
    customClass: {
      popup: 'swal2-popup-custom'
    }
  }).then((result) => {
    if (result.isConfirmed) {
      // Redirect to Stripe checkout page
      window.open('https://buy.stripe.com/test_28o5kC0QZ8QZ8QZ8QZ', '_blank');
    }
  });
}

// Function to show Pro feature modal for graph sharing
function showGraphShareProModal() {
  Swal.fire({
    title: "Pro Feature",
    html: `
      <div style="text-align: center;">
        <div style="font-size: 48px; margin-bottom: 16px;">🔒</div>
        <p style="font-size: 16px; color: #333; margin-bottom: 16px; line-height: 1.5;">
          Sharing graphs is only available for Pro users. Upgrade now to unlock.
        </p>
        <div style="
          background: linear-gradient(135deg, rgba(108, 99, 255, 0.1), rgba(142, 124, 255, 0.1));
          border: 1px solid rgba(142, 124, 255, 0.2);
          border-radius: 8px;
          padding: 16px;
          margin: 20px 0;
          text-align: left;
        ">
          <div style="font-weight: 600; margin-bottom: 8px; color: #333;">✨ Pro Features:</div>
          <ul style="margin: 0; padding-left: 20px; color: #666; font-size: 14px;">
            <li>Share graphs with others</li>
            <li>Download graph images</li>
            <li>Share via email</li>
            <li>Copy shareable links</li>
          </ul>
        </div>
      </div>
    `,
    confirmButtonText: "Upgrade Now",
    confirmButtonColor: "#8e7cff",
    showCancelButton: true,
    cancelButtonText: "Maybe Later",
    cancelButtonColor: "#6c757d",
    width: 500,
    customClass: {
      popup: 'swal2-popup-custom'
    }
  }).then((result) => {
    if (result.isConfirmed) {
      // Redirect to Stripe checkout page
      window.open('https://buy.stripe.com/test_28o5kC0QZ8QZ8QZ8QZ', '_blank');
    }
  });
}

// Function to show share options for Pro users
function showShareOptions() {
  Swal.fire({
    title: "Share Graph",
    html: `
      <div style="text-align: left;">
        <div style="display: flex; flex-direction: column; gap: 12px;">
          <button onclick="copyGraphLink()" style="
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
            text-align: left;
            width: 100%;
          " onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
            <i class="fa-sharp fa-light fa-link" style="font-size: 16px; color: #2248bc;"></i>
            <div>
              <div style="font-weight: 600; color: #333;">Copy Link</div>
              <div style="font-size: 12px; color: #666;">Copy a shareable link to your graph</div>
            </div>
          </button>
          
          <button onclick="downloadGraphImage()" style="
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
            text-align: left;
            width: 100%;
          " onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
            <i class="fa-sharp fa-light fa-download" style="font-size: 16px; color: #2248bc;"></i>
            <div>
              <div style="font-weight: 600; color: #333;">Download Graph Image</div>
              <div style="font-size: 12px; color: #666;">Save your graph as a PNG image</div>
            </div>
          </button>
          
          <button onclick="shareViaEmail()" style="
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
            text-align: left;
            width: 100%;
          " onmouseover="this.style.background='#e9ecef'" onmouseout="this.style.background='#f8f9fa'">
            <i class="fa-sharp fa-light fa-envelope" style="font-size: 16px; color: #2248bc;"></i>
            <div>
              <div style="font-weight: 600; color: #333;">Share via Email</div>
              <div style="font-size: 12px; color: #666;">Send graph link via email</div>
            </div>
          </button>
        </div>
      </div>
    `,
    showConfirmButton: false,
    showCloseButton: true,
    width: 400,
    customClass: {
      popup: 'swal2-popup-custom'
    }
  });
}

// Function to copy graph link
function copyGraphLink() {
  const graphLink = `${window.location.origin}/graph/${Date.now()}`;
  navigator.clipboard.writeText(graphLink).then(() => {
    Swal.close();
    Toastify({
      text: "Graph link copied to clipboard!",
      duration: 3000,
      gravity: "top",
      position: "right",
      backgroundColor: "#28a745",
      stopOnFocus: true
    }).showToast();
  }).catch(err => {
    console.error('Failed to copy link:', err);
    Swal.close();
    Toastify({
      text: "Failed to copy link",
      duration: 3000,
      gravity: "top",
      position: "right",
      backgroundColor: "#dc3545",
      stopOnFocus: true
    }).showToast();
  });
}

// Function to download graph image
function downloadGraphImage() {
  const canvas = document.getElementById("copyBossChart");
  if (canvas) {
    const link = document.createElement("a");
    link.href = canvas.toDataURL("image/png");
    link.download = "viral-score-graph.png";
    link.click();
    Swal.close();
    Toastify({
      text: "Graph image downloaded!",
      duration: 3000,
      gravity: "top",
      position: "right",
      backgroundColor: "#28a745",
      stopOnFocus: true
    }).showToast();
  }
}

// Function to share via email
function shareViaEmail() {
  const graphLink = `${window.location.origin}/graph/${Date.now()}`;
  const subject = "Check out my Viral Score Graph!";
  const body = `Hi! I wanted to share my viral score graph with you. You can view it here: ${graphLink}`;
  
  const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  window.open(mailtoLink);
  
  Swal.close();
  Toastify({
    text: "Email client opened!",
    duration: 3000,
    gravity: "top",
    position: "right",
    backgroundColor: "#28a745",
    stopOnFocus: true
  }).showToast();
}

// Function to check if user has Pro access for specific features
function checkProAccess(feature) {
  if (!userIsPro) {
    showShareDownloadUpgradeModal();
    return false;
  }
  return true;
}

// Function to initialize gauge visibility based on user plan
function initializeGaugeVisibility() {
  const lockedGauges = document.querySelectorAll('.gauge-box.pro-locked');
  
  if (userIsPro) {
    // Pro users see all gauges unlocked
    lockedGauges.forEach(gauge => {
      gauge.classList.remove('pro-locked');
      const overlay = gauge.querySelector('.locked-overlay');
      if (overlay) {
        overlay.style.display = 'none';
      }
    });
    
    // Hide PRO tags for Pro users
    const proTags = document.querySelectorAll('.pro-tag, .pro-tag-dropdown');
    proTags.forEach(tag => {
      tag.style.display = 'none';
    });
  } else {
    // Free users only see Sound Match gauge unlocked
    lockedGauges.forEach(gauge => {
      gauge.classList.add('pro-locked');
      const overlay = gauge.querySelector('.locked-overlay');
      if (overlay) {
        overlay.style.display = 'block';
      }
    });
    
    // Ensure Sound Match gauge is unlocked for free users
    const soundGauge = document.getElementById('soundGaugeCard');
    if (soundGauge) {
      soundGauge.classList.remove('pro-locked');
      const soundOverlay = soundGauge.querySelector('.locked-overlay');
      if (soundOverlay) {
        soundOverlay.style.display = 'none';
      }
    }
    
    // Show PRO tags for Free users
    const proTags = document.querySelectorAll('.pro-tag, .pro-tag-dropdown');
    proTags.forEach(tag => {
      tag.style.display = 'inline-block';
    });
  }
  
  // Add event listeners for upgrade buttons
  const upgradeButtons = document.querySelectorAll('.btn-upgrade');
  upgradeButtons.forEach(button => {
    button.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      showShareDownloadUpgradeModal();
    });
  });
}

// Function to initialize video comparison modal
function initializeVideoComparison() {
  const container = document.getElementById('videoComparisonList');
  if (container) {
    renderVideoComparisonList();
    setupVideoComparisonEvents();
  } else {
    // Fallback: try again after a short delay
    setTimeout(() => {
      const retryContainer = document.getElementById('videoComparisonList');
      if (retryContainer) {
        renderVideoComparisonList();
        setupVideoComparisonEvents();
      }
    }, 100);
  }
}

// Function to setup event delegation for video comparison
function setupVideoComparisonEvents() {
  const container = document.getElementById('videoComparisonList');
  if (!container) return;
  
  // Event delegation for checkbox changes
  container.addEventListener('change', function(e) {
    if (e.target.type === 'checkbox' && e.target.classList.contains('compare-checkbox')) {
      updateCompareButton();
    }
  });
  
  // Event delegation for video item clicks
  container.addEventListener('click', function(e) {
    const videoItem = e.target.closest('.video-item');
    if (videoItem && e.target.type !== 'checkbox') {
      const videoId = videoItem.dataset.videoId;
      if (videoId) {
        toggleVideoSelection(videoId);
      }
    }
  });
}

// Function to deselect all videos when modal is closed
function deselectAllVideos() {
  const checkboxes = document.querySelectorAll('#videoComparisonList .compare-checkbox');
  checkboxes.forEach(checkbox => {
    checkbox.checked = false;
  });
  updateCompareButton();
}

// AI Tips Array
const aiTips = [
  { title: "🎯 Hook in 2 Seconds", tip: "Start every video with a bold, unexpected visual or question." },
  { title: "📈 Use Trending Sounds", tip: "Trending audio gives your content an instant boost on TikTok and Instagram." },
  { title: "🔥 Add On-Screen Text", tip: "Even silent scrollers will stop if your message is clear visually." },
  { title: "🕒 Shorter = Better", tip: "Keep your videos under 15s for higher completion and retention rates." },
  { title: "👀 Use Open Loops", tip: "Tease something big but don't reveal it until the end." },
  { title: "📊 Analyze Your Flops", tip: "Your worst-performing videos teach more than your best ones." },
  { title: "⚡ Energy Sells", tip: "Talk faster, cut quicker, move more — speed keeps attention." },
  { title: "🎬 Cut the First 2 Seconds", tip: "Most videos start too slow — cut the intro fluff." },
  { title: "👂Voiceovers Win", tip: "CapCut voiceovers feel native and convert like mad." },
  { title: "📲 Vertical Always", tip: "Horizontal videos tank on TikTok and Reels — keep it mobile-first." },
  { title: "🌟 Use Emotion Words", tip: "Shock, Excite, Regret, Secret — emotional hooks pull people in." },
  { title: "📍Location = Connection", tip: "Mention or show a relatable location to boost relevance." },
  { title: "🔁 Repeat a Catchphrase", tip: "Consistency builds brand identity and retention." },
  { title: "🎥 Film in Natural Light", tip: "Lighting makes or breaks your video's quality instantly." },
  { title: "🚀 Post at Peak Hours", tip: "Test different times — often between 6–10PM works best." },
  { title: "🧠 Use Curiosity", tip: "Create a knowledge gap: 'Most people don't know this...'" },
  { title: "💡 Add Text Highlights", tip: "Use bold colors to emphasize key points on-screen." },
  { title: "🔇 Silent Preview Proof", tip: "Check if your video makes sense with sound OFF — many users scroll muted." },
  { title: "💬 Pin a Comment", tip: "Direct conversation by pinning a call-to-action comment." },
  { title: "🏆 Reuse Winning Formats", tip: "Got a viral layout? Reuse it with a fresh hook." },
  { title: "👻 Use Jump Cuts", tip: "Cut out every pause or 'uhm' — snappy edits = pro content." },
  { title: "🧲 First Frame Matters", tip: "Your first second should be your most interesting moment." },
  { title: "🎨 Add Captions", tip: "Auto-captions increase watch time for 80% of users." },
  { title: "🔍 Use Keywords in Text", tip: "TikTok and IG scan your on-screen text to categorize your video." },
  { title: "🧪 Test Thumbnails", tip: "Pick the most intense freeze frame or add bold text." },
  { title: "🙋 Tell a Personal Story", tip: "Personal content = authentic connection." },
  { title: "💥 Show the Result First", tip: "Reverse your story: show result → then explain how." },
  { title: "📉 Don't Ask for Follows", tip: "Give value first — let engagement come naturally." },
  { title: "📦 Use Split-Screen Edits", tip: "React or demonstrate visually in split screen for better clarity." },
  { title: "🧼 Remove Visual Clutter", tip: "Messy backgrounds hurt engagement." },
  { title: "🎭 Be Unpredictable", tip: "Unexpected endings drive shares." },
  { title: "🌈 Use Color Psychology", tip: "Red = urgency, Blue = trust, Yellow = joy — leverage it." },
  { title: "🧩 Build a Series", tip: "Part 1, 2, 3 videos create anticipation and returning viewers." },
  { title: "🚫 Avoid Over-Editing", tip: "Too many effects can distract — clarity beats complexity." },
  { title: "💣 Break the Pattern", tip: "Do something visually disruptive every 3–5 seconds." },
  { title: "🎯 Speak to One Person", tip: "Make your viewer feel like it's just for them." },
  { title: "🧠 Use Thought-Provoking Prompts", tip: "'What would you do if...?' triggers engagement." },
  { title: "📸 Film in Batches", tip: "Plan and shoot multiple videos in one session to stay consistent." },
  { title: "🎙️ Improve Audio", tip: "Crisp sound = more authority and better retention." },
  { title: "🧠 Leverage Common Myths", tip: "Bust myths in your niche to grab attention." },
  { title: "📆 Post Consistently", tip: "The algorithm rewards creators who post regularly." },
  { title: "👀 Use POV Shots", tip: "Point-of-view content feels immersive and relatable." },
  { title: "🎮 Add Micro-Missions", tip: "Ask viewers to 'watch till the end' or 'spot the detail'." },
  { title: "📢 Add CTAs Creatively", tip: "Use 'Double tap if you agree' instead of 'Like and follow.'" },
  { title: "👫 Duet or Stitch", tip: "Engage with viral creators to ride the wave." },
  { title: "🧵 Use Story Threads", tip: "Start with a bold claim, then unfold your points fast." },
  { title: "🏁 Always End Strong", tip: "Close with an unexpected twist or punchline." },
  { title: "🧙‍♂️ Use Visual Magic", tip: "Small effects like zooms or masking tricks boost interest." },
  { title: "🔍 Mimic Viral Styles", tip: "Don't copy, but study pacing, framing, and cuts of viral hits." }
];

// Track shown tips to avoid repeats
let shownTips = new Set();

// Function to get random tips
function getRandomTips(count = 5) {
  const availableTips = aiTips.filter(tip => !shownTips.has(tip.title));
  
  // If we've shown most tips, reset the shown tips
  if (availableTips.length < count) {
    shownTips.clear();
    return getRandomTips(count);
  }
  
  const selectedTips = [];
  for (let i = 0; i < count; i++) {
    const randomIndex = Math.floor(Math.random() * availableTips.length);
    const selectedTip = availableTips.splice(randomIndex, 1)[0];
    selectedTips.push(selectedTip);
    shownTips.add(selectedTip.title);
  }
  
  return selectedTips;
}

// Function to render tips
function renderTips(tips) {
  return tips.map(tip => `
    <div style="
      background: #f8f9fa;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 12px;
      border-left: 4px solid #2248bc;
    ">
      <div style="font-weight: 600; font-size: 14px; color: #333; margin-bottom: 6px;">
        ${tip.title}
      </div>
      <div style="font-size: 13px; color: #666; line-height: 1.4;">
        ${tip.tip}
      </div>
    </div>
  `).join('');
}

// Function to load more tips
function loadMoreTips() {
  const container = document.getElementById('aiTipsContainer');
  if (container) {
    const newTips = getRandomTips(5);
    const tipsHTML = renderTips(newTips);
    container.innerHTML += tipsHTML;
  }
}

// Function to initialize AI tips modal
function initializeAITips() {
  const container = document.getElementById('aiTipsContainer');
  if (container) {
    // Reset shown tips for new modal session
    shownTips.clear();
    const initialTips = getRandomTips(5);
    const tipsHTML = renderTips(initialTips);
    container.innerHTML = tipsHTML;
  }
}

// Function to copy referral link to clipboard
function copyReferralLink() {
  const referralLink = document.getElementById('referralLink');
  if (referralLink) {
    navigator.clipboard.writeText(referralLink.value).then(() => {
      // Show success feedback
      const copyBtn = event.target;
      const originalText = copyBtn.textContent;
      copyBtn.textContent = 'Copied!';
      copyBtn.style.background = '#28a745';
      
      setTimeout(() => {
        copyBtn.textContent = originalText;
        copyBtn.style.background = '#2248bc';
      }, 2000);
    }).catch(err => {
      console.error('Failed to copy referral link:', err);
      // Fallback for older browsers
      referralLink.select();
      document.execCommand('copy');
      
      const copyBtn = event.target;
      const originalText = copyBtn.textContent;
      copyBtn.textContent = 'Copied!';
      copyBtn.style.background = '#28a745';
      
      setTimeout(() => {
        copyBtn.textContent = originalText;
        copyBtn.style.background = '#2248bc';
      }, 2000);
    });
  }
}

// Function to share referral link
function shareReferralLink() {
  const referralLink = document.getElementById('referralLink');
  if (!referralLink) return;
  
  const shareData = {
    title: 'VideoBoss Analyzer - Refer & Earn',
    text: 'Join me on VideoBoss Analyzer and get £1 credit when you sign up!',
    url: referralLink.value
  };
  
  // Try Web Share API first
  if (navigator.share && navigator.canShare(shareData)) {
    navigator.share(shareData).catch(err => {
      console.log('Share cancelled or failed:', err);
      // Fallback to copy
      fallbackShare();
    });
  } else {
    // Fallback to copy
    fallbackShare();
  }
}

// Fallback share function
function fallbackShare() {
  const referralLink = document.getElementById('referralLink');
  if (referralLink) {
    navigator.clipboard.writeText(referralLink.value).then(() => {
      // Show success message
      const shareBtn = event.target;
      const originalText = shareBtn.textContent;
      shareBtn.textContent = 'Link copied!';
      shareBtn.style.background = '#28a745';
      
      setTimeout(() => {
        shareBtn.textContent = originalText;
        shareBtn.style.background = '#28a745';
      }, 2000);
      
      // Show toast notification
      Toastify({
        text: "Link copied – now share it!",
        duration: 3000,
        gravity: "top",
        position: "right",
        backgroundColor: "#28a745",
        stopOnFocus: true
      }).showToast();
    }).catch(err => {
      console.error('Failed to copy link:', err);
      // Final fallback
      referralLink.select();
      document.execCommand('copy');
      
      const shareBtn = event.target;
      const originalText = shareBtn.textContent;
      shareBtn.textContent = 'Link copied!';
      shareBtn.style.background = '#28a745';
      
      setTimeout(() => {
        shareBtn.textContent = originalText;
        shareBtn.style.background = '#28a745';
      }, 2000);
      
      Toastify({
        text: "Link copied – now share it!",
        duration: 3000,
        gravity: "top",
        position: "right",
        backgroundColor: "#28a745",
        stopOnFocus: true
      }).showToast();
    });
  }
}



// ✅ PDF generator function goes outside all conditionals
// Old generatePDF function is now unused for the main download button, but can be kept for other uses if needed.
function generatePDF(feedback, latest) {
  fetch("pdf-template.html")
    .then(res => res.text())
    .then(template => {
      let filled = template;

      filled = filled.replace("14 July 2025, 11:47am", new Date().toLocaleString());
filled = filled.replace("Video Analysis Report", `Video Analysis Report – ${latest.title}`);
filled = filled.replace("[summary-text]", feedback?.summary || "No summary.");
filled = filled.replace("[score-blocks]", scoreBlocks);
filled = filled.replace("[feedback-blocks]", feedbackBlocks);

      

      const scoreBlocks = Object.entries(feedback).map(([key, section]) => {
        const score = section?.score ?? "--";
        const label = section?.label || "–";
        const short = section?.short || "No comment.";
        let quality = "good";
        if (score < 50) quality = "poor";
        else if (score < 70) quality = "warn";

        let icon = "💡";
        if (key.toLowerCase().includes("viral")) icon = "🔥";
        else if (key.toLowerCase().includes("caption")) icon = "💬";
        else if (key.toLowerCase().includes("sound")) icon = "🎵";
        else if (key.toLowerCase().includes("viewer")) icon = "👁️";
        else if (key.toLowerCase().includes("engagement")) icon = "📈";
        else if (key.toLowerCase().includes("hook")) icon = "⚡";

        return `
          <div class="score-block ${quality}">
            <span class="label">${icon} ${key}</span>
            Score: ${score}<br> Label: ${label}<br>
            Quick Note: ${short}
          </div>
        `;
      }).join("");

      filled = filled.replace("[score-blocks]", scoreBlocks);
filled = filled.replace("[feedback-blocks]", feedbackBlocks);
filled = filled.replace("[summary-text]", feedback?.summary || "No summary.");


      const feedbackBlocks = Object.entries(feedback).map(([key, section]) => {
        const detail = section?.detail || "No detail.";
        return `
          <div class="ai-feedback-block">
            <strong>${key}:</strong>
            ${detail}
          </div>
        `;
      }).join("");

      filled = filled.replace(/<div class="ai-feedback-grid">([\s\S]*?)<\/div>/, `<div class="ai-feedback-grid">${feedbackBlocks}</div>`);

      // Create iframe
      const iframe = document.createElement("iframe");
      iframe.style.width = "800px";
      iframe.style.height = "1000px";
      iframe.style.position = "absolute";
      iframe.style.top = "-9999px";
      document.body.appendChild(iframe);

      const doc = iframe.contentWindow.document;
      doc.open();
      doc.write(filled);
      doc.close();

      // Wait before generating PDF
      setTimeout(() => {
        html2pdf().from(iframe).set({
          margin: 10,
          filename: `${latest.title || "report"}.pdf`,
          image: { type: "jpeg", quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        }).save().then(() => {
          document.body.removeChild(iframe);
        });
      }, 800);
    });
}




   
  
  
  






  

  // ... your iframe + generatePDF code above ...

function viewReport(id) {
  const history = JSON.parse(localStorage.getItem("analysisHistory")) || [];
  const report = history.find(item => item.id === id);

  if (!report) {
    Swal.fire({
      icon: "error",
      title: "Report Not Found ❌",
      text: "This report couldn't be found in your saved history.",
    });
    return;
  }

  const feedback = report.feedback || {};
  let detailedHTML = "";

  for (const key in feedback) {
    const section = feedback[key];
    if (!section) continue;

    const label = section.label || "–";
    const score = section.score ?? "--";
    const short = section.short || "Awaiting short feedback.";
    const detail = section.detail || "Awaiting detailed feedback.";

    detailedHTML += `
      <div class="detailed-feedback-block">
        <h3 style="margin-bottom: 6px;">${key.replace(/([A-Z])/g, ' $1')}</h3>
        <p><strong>Score:</strong> ${score} • <strong>Label:</strong> ${label}</p>
        <p><strong>Summary:</strong> ${short}</p>
        <p><strong>Detail:</strong> ${detail}</p>
      </div>
    `;
  }

  const html = `
    <div style="text-align:left; max-height: 400px; overflow-y: auto;">
      <h2>📋 ${report.title}</h2>
      <p><strong>Date:</strong> ${report.date}</p>
      <p><strong>Overall Score:</strong> ${report.score}</p>
      <hr style="margin: 12px 0;">
      ${detailedHTML}
    </div>
  `;

  Swal.fire({
    icon: "info",
    title: "Full Report",
    html: html,
    width: 600,
    confirmButtonText: "Close"
  });
}

// ✅ One and only closing tag
</script>


<script>
function updateSidebarRank(average) {
    const rankEl = document.getElementById("userRankTitle");

    let title = "Unknown";
    if (average >= 90) {
      title = "🧠 Elite Creator";
    } else if (average >= 75) {
      title = "🔥 Viral Ninja";
    } else if (average >= 50) {
      title = "⚡ Content Climber";
    } else if (average >= 30) {
      title = "📈 Rookie Creator";
    } else {
      title = "💤 Just Getting Started";
    }

    if (rankEl) rankEl.innerText = title;
  }


 window.syncViralChartFromGemini = function (score) {
  if (typeof score !== "number" || !window.copyBossChart) {
    console.warn("⚠️ Invalid score or chart missing");
    return;
  }

  const now = new Date();
  const day = now.toLocaleDateString("en-GB", { weekday: "short" });
  const time = now.toLocaleTimeString("en-GB", { hour: "2-digit", minute: "2-digit" });
  const label = `${day} ${time}`;

  const labels = copyBossChart.data.labels;
  const data = copyBossChart.data.datasets[0].data;

  if (labels[labels.length - 1] === label && data[data.length - 1] === score) {
    console.log("⚠️ Duplicate score/timestamp skipped");
    return;
  }

  labels.push(label);
  data.push(score);

  if (labels.length > 7) {
    labels.shift();
    data.shift();
  }

  copyBossChart.update();

  try {
    localStorage.setItem("copyBossLabels", JSON.stringify(labels));
    localStorage.setItem("copyBossScores", JSON.stringify(data));
  } catch (err) {
    console.warn("⚠️ Failed to save chart data", err);
  }

  const avg = Math.round(data.reduce((a, b) => a + b, 0) / data.length);
  updateSidebarRank(avg);

  console.log("📊 Viral chart updated:", score, "→", label);
};






</script>


<script>
// PDF Download Button Logic (fixed for Gemini feedback)


</script>

<script>
// Stripe Checkout and Unlock Logic
const stripe = Stripe('YOUR_STRIPE_PUBLISHABLE_KEY');

// Stripe Checkout Functions
async function redirectToStripeCheckout(plan) {
  const userId = localStorage.getItem('videobossUserId');
  if (!userId) {
    alert("Please log in first.");
    return;
  }

  try {
    const res = await fetch('/create-checkout-session', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ plan, userId })
    });
    const data = await res.json();
    if (data.url) {
      window.location.href = data.url;
    } else {
      alert("Failed to start checkout.");
    }
  } catch (err) {
    console.error(err);
    alert("Error redirecting to Stripe Checkout.");
  }
}

// Unlock Logic Functions
function unlockPro() {
  localStorage.setItem('isPro', 'true');
  localStorage.removeItem('reportCredits'); // Clear credits when Pro is active
  removeLocks();
}

function addReportCredits(credits) {
  const currentCredits = parseInt(localStorage.getItem('reportCredits') || '0');
  localStorage.setItem('reportCredits', (currentCredits + credits).toString());
  removeLocks();
}

function useReportCredit() {
  const credits = parseInt(localStorage.getItem('reportCredits') || '0');
  if (credits > 0) {
    localStorage.setItem('reportCredits', (credits - 1).toString());
    if (credits - 1 === 0) {
      applyLocks(); // Re-lock when credits run out
    }
    return true;
  }
  return false;
}

function isProActive() {
  return localStorage.getItem('isPro') === 'true';
}

function hasCredits() {
  return parseInt(localStorage.getItem('reportCredits') || '0') > 0;
}

function shouldUnlock() {
  return isProActive() || hasCredits();
}

// Lock/Unlock Functions
function removeLocks() {
  // Remove pro-locked class from gauge boxes
  document.querySelectorAll('.gauge-box.pro-locked').forEach(box => {
    box.classList.remove('pro-locked');
  });
  
  // Remove locked-overlay from result cards
  document.querySelectorAll('.pro-locked-results .locked-overlay').forEach(overlay => {
    overlay.style.display = 'none';
  });
  
  // Remove blur from result content
  document.querySelectorAll('.pro-locked-results .result-content').forEach(content => {
    content.style.filter = 'none';
    content.style.opacity = '1';
  });
}

function applyLocks() {
  if (shouldUnlock()) return; // Don't apply locks if user should be unlocked
  
  // Add pro-locked class to gauge boxes
  document.querySelectorAll('.gauge-box').forEach(box => {
    if (!box.classList.contains('soundGaugeCard') && !box.classList.contains('viewerGaugeCard')) {
      box.classList.add('pro-locked');
    }
  });
  
  // Show locked-overlay on result cards
  document.querySelectorAll('.pro-locked-results .locked-overlay').forEach(overlay => {
    overlay.style.display = 'flex';
  });
  
  // Apply blur to result content
  document.querySelectorAll('.pro-locked-results .result-content').forEach(content => {
    content.style.filter = 'blur(8px)';
    content.style.opacity = '0.55';
  });
}

// Check URL parameters for payment success
function checkPaymentSuccess() {
  const urlParams = new URLSearchParams(window.location.search);
  const plan = urlParams.get('plan');
  const credits = urlParams.get('credits');
  
  if (plan === 'pro') {
    unlockPro();
    showSuccessMessage('Pro subscription activated! 🎉');
  } else if (credits) {
    const creditAmount = parseInt(credits);
    addReportCredits(creditAmount);
    showSuccessMessage(`${creditAmount} report credits added! 📊`);
  }
}

function showSuccessMessage(message) {
  // Simple success message (you can enhance this with a toast library)
  const successDiv = document.createElement('div');
  successDiv.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: #4CAF50;
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    z-index: 10000;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  `;
  successDiv.textContent = message;
  document.body.appendChild(successDiv);
  
  setTimeout(() => {
    successDiv.remove();
  }, 5000);
}

// Verify user status from backend
async function verifyUserStatusFromBackend(userId) {
  try {
    const response = await fetch(`/api/user/status/${userId}`);
    if (!response.ok) throw new Error('Failed to fetch user status');
    const status = await response.json();

    // Update localStorage from backend
    if (status.plan === 'pro' && new Date(status.subscription_expires) > new Date()) {
      localStorage.setItem('isPro', 'true');
      unlockPro();
    } else {
      localStorage.removeItem('isPro');
    }

    if (status.report_credits && status.report_credits > 0) {
      localStorage.setItem('reportCredits', status.report_credits);
      removeLocks();
    }
  } catch (err) {
    console.error('Backend verification failed, falling back to localStorage:', err);
    // fallback: keep using whatever localStorage has
    if (localStorage.getItem('isPro') === 'true') {
      unlockPro();
    } else if (parseInt(localStorage.getItem('reportCredits') || '0') > 0) {
      removeLocks();
    }
  }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', async function() {
  // Get user ID and verify status from backend
  const userId = localStorage.getItem('videobossUserId');
  if (userId) {
    await verifyUserStatusFromBackend(userId);
  }
  
  checkPaymentSuccess();
  updatePlanStatus();
  
  // Always ensure free gauges are unlocked first
  ensureFreeGaugesUnlocked();
  
  if (shouldUnlock()) {
    removeLocks();
  } else {
    applyLocks();
  }
});

// Ensure free gauges are always unlocked
function ensureFreeGaugesUnlocked() {
  // Sound Match and Viewer Understanding should always be unlocked
  const soundGauge = document.getElementById('soundGaugeCard');
  const viewerGauge = document.getElementById('viewerGaugeCard');
  
  if (soundGauge) {
    soundGauge.classList.remove('pro-locked');
  }
  if (viewerGauge) {
    viewerGauge.classList.remove('pro-locked');
  }
}

// Update plan status display
function updatePlanStatus() {
  const planElement = document.getElementById('userPlan');
  if (planElement) {
    if (isProActive()) {
      planElement.textContent = 'Pro';
      planElement.style.color = '#8e7cff';
    } else if (hasCredits()) {
      const credits = localStorage.getItem('reportCredits');
      planElement.textContent = `Free (${credits} credits)`;
      planElement.style.color = '#4CAF50';
    } else {
      planElement.textContent = 'Free';
      planElement.style.color = '#ccc';
    }
  }
}

// Free Upload Tracking Functions
function hasUsedFreeUpload() {
  return localStorage.getItem('freeUploadUsed') === 'true';
}

function markFreeUploadUsed() {
  localStorage.setItem('freeUploadUsed', 'true');
}

function canAnalyze() {
  return isProActive() || hasCredits() || !hasUsedFreeUpload();
}

// Upgrade Modal
function showUpgradeModal() {
  const modal = document.createElement('div');
  modal.id = 'upgradeModal';
  modal.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    backdrop-filter: blur(5px);
  `;
  
  modal.innerHTML = `
    <div style="
      background: linear-gradient(135deg, #0d0d1a, #1a1a2e);
      border: 1px solid #333;
      border-radius: 15px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    ">
      <h2 style="color: #fff; margin-bottom: 20px; font-size: 24px;">🚀 Upgrade to VideoBoss Pro</h2>
      <p style="color: #ccc; margin-bottom: 30px; line-height: 1.6;">
        You've used your free analysis. Upgrade now to unlock unlimited video analysis and advanced features!
      </p>
      
      <div style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px;">
        <button onclick="redirectToStripeCheckout('pro')" style="
          background: linear-gradient(135deg, #6c63ff, #8e7cff);
          color: white;
          border: none;
          padding: 15px 25px;
          border-radius: 10px;
          font-weight: 600;
          font-size: 16px;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(108, 99, 255, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(108, 99, 255, 0.3)'">
          💎 Upgrade to Pro - £4.99/month
        </button>
        
        <button onclick="redirectToStripeCheckout('2reports')" style="
          background: linear-gradient(135deg, #4CAF50, #45a049);
          color: white;
          border: none;
          padding: 12px 20px;
          border-radius: 8px;
          font-weight: 600;
          font-size: 14px;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 3px 10px rgba(76, 175, 80, 0.3);
        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(76, 175, 80, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 3px 10px rgba(76, 175, 80, 0.3)'">
          📊 Buy 2 Reports - £1.99
        </button>
        
        <button onclick="redirectToStripeCheckout('15reports')" style="
          background: linear-gradient(135deg, #FF9800, #F57C00);
          color: white;
          border: none;
          padding: 12px 20px;
          border-radius: 8px;
          font-weight: 600;
          font-size: 14px;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: 0 3px 10px rgba(255, 152, 0, 0.3);
        " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(255, 152, 0, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 3px 10px rgba(255, 152, 0, 0.3)'">
          📈 Buy 15 Reports - £9.99
        </button>
      </div>
      
      <button onclick="closeUpgradeModal()" style="
        background: transparent;
        color: #888;
        border: 1px solid #444;
        padding: 8px 16px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
      " onmouseover="this.style.borderColor='#666'; this.style.color='#aaa'" onmouseout="this.style.borderColor='#444'; this.style.color='#888'">
        Maybe Later
      </button>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function closeUpgradeModal() {
  const modal = document.getElementById('upgradeModal');
  if (modal) {
    modal.remove();
  }
}

// Update all upgrade buttons to use Stripe checkout
document.addEventListener('DOMContentLoaded', function() {
  // Update main upgrade button
  const upgradeButtons = document.querySelectorAll('.btn-upgrade');
  upgradeButtons.forEach(button => {
    if (button.textContent.includes('Upgrade') || button.textContent.includes('Unlock')) {
      button.onclick = function(e) {
        e.preventDefault();
        redirectToStripeCheckout('pro');
      };
    }
  });
});

// Particle Animation
document.addEventListener('DOMContentLoaded', function() {
    const particles = document.getElementById('particles');
    
    // Create particles
    function createParticles() {
        for (let i = 0; i < 50; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDelay = Math.random() * 6 + 's';
            particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
            particles.appendChild(particle);
        }
    }
    
    // Initialize particles
    createParticles();
});

// Simple Legal Modal functions
function openLegalModal(modalId) {
    console.log('=== openLegalModal function called ===');
    console.log('Modal ID:', modalId);
    
    if (!modalId) {
        console.error('No modal ID provided');
        return;
    }
    
    // Create a simple modal overlay
    const overlay = document.createElement('div');
    overlay.id = 'legal-modal-overlay';
    overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px);';
    
    // Create modal content
    const modalContent = document.createElement('div');
    modalContent.style.cssText = 'background: linear-gradient(135deg, #1e1e40, #2a2a50); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 0; max-width: 90%; width: 600px; max-height: 80vh; overflow: hidden; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5); position: relative;';
    
    // Get content based on modal type
    let title, content;
    if (modalId === 'privacy-modal') {
        title = 'Privacy Policy';
        content = '<div style="padding: 32px;"><div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 8px; padding: 16px; margin-bottom: 24px;"><p style="margin: 0; color: #e2e8f0; font-size: 0.95rem; line-height: 1.5;">We respect your privacy and are committed to protecting your personal data.</p></div><div style="color: #cbd5e1; line-height: 1.6;"><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Information We Collect</h3><p>We collect information you provide directly to us, such as when you create an account, upload videos, or contact us for support.</p><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">How We Use Your Information</h3><p>We use the information we collect to provide, maintain, and improve our services, process transactions, and communicate with you.</p><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Contact Us</h3><p>If you have any questions about this Privacy Policy, please contact us at hello@copy-boss.com.</p></div></div>';
    } else if (modalId === 'terms-modal') {
        title = 'Terms of Service';
        content = '<div style="padding: 32px;"><div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 8px; padding: 16px; margin-bottom: 24px;"><p style="margin: 0; color: #e2e8f0; font-size: 0.95rem; line-height: 1.5;">By using CopyBoss, you agree to these terms of service.</p></div><div style="color: #cbd5e1; line-height: 1.6;"><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Acceptance of Terms</h3><p>By accessing or using CopyBoss, you agree to be bound by these Terms of Service and all applicable laws and regulations.</p><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Use License</h3><p>We grant you a limited, non-exclusive, non-transferable license to use CopyBoss for your personal or business use.</p><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Contact Us</h3><p>If you have any questions about these Terms, please contact us at hello@copy-boss.com.</p></div></div>';
    } else if (modalId === 'support-modal') {
        title = 'Support';
        content = '<div style="padding: 32px;"><div style="background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 8px; padding: 16px; margin-bottom: 24px;"><p style="margin: 0; color: #e2e8f0; font-size: 0.95rem; line-height: 1.5;">Need help? We are here to support you with any questions or issues.</p></div><div style="color: #cbd5e1; line-height: 1.6;"><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Contact Support</h3><p>For technical support, billing questions, or general inquiries, please contact us at hello@copy-boss.com.</p><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Response Time</h3><p>We typically respond to support requests within 24-48 hours during business days.</p><h3 style="color: white; font-size: 1.25rem; font-weight: 600; margin: 24px 0 12px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); padding-bottom: 8px;">Community Support</h3><p>Join our community hub for tips and support: <a href="https://copy-boss.com/community/" style="color: #3b82f6;">copy-boss.com/community</a></p></div></div>';
    }
    
    // Create header
    const header = document.createElement('div');
    header.style.cssText = 'display: flex; justify-content: space-between; align-items: center; padding: 24px 32px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); background: rgba(255, 255, 255, 0.05);';
    
    const titleElement = document.createElement('h3');
    titleElement.textContent = title;
    titleElement.style.cssText = 'font-size: 1.5rem; font-weight: 600; color: white; margin: 0;';
    
    const closeButton = document.createElement('button');
    closeButton.innerHTML = '&times;';
    closeButton.style.cssText = 'background: none; border: none; color: #8fa3c7; font-size: 1.5rem; cursor: pointer; padding: 8px; border-radius: 8px; transition: all 0.2s ease; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10001;';
    
    // Add click event with direct modal removal
    closeButton.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('X button clicked - closing modal directly');
        const overlay = document.getElementById('legal-modal-overlay');
        if (overlay) {
            overlay.remove();
            document.body.style.overflow = '';
            console.log('Modal closed successfully via X button');
        } else {
            console.log('Modal overlay not found when X button clicked');
        }
    });
    
    // Debug: Check if close button is properly created
    console.log('Close button created:', closeButton);
    console.log('Close button onclick:', closeButton.onclick);
    
    header.appendChild(titleElement);
    header.appendChild(closeButton);
    
    // Assemble modal - create complete structure
    modalContent.innerHTML = '';
    modalContent.appendChild(header);
    
    // Create content container
    const contentContainer = document.createElement('div');
    contentContainer.innerHTML = content;
    modalContent.appendChild(contentContainer);
    
    overlay.appendChild(modalContent);
    
    // Add to page
    document.body.appendChild(overlay);
    document.body.style.overflow = 'hidden';
    
    // Close on overlay click
    overlay.onclick = function(e) {
        if (e.target === overlay) {
            const overlay = document.getElementById('legal-modal-overlay');
            if (overlay) {
                overlay.remove();
                document.body.style.overflow = '';
            }
        }
    };
    
    // Close on ESC key
    document.addEventListener('keydown', function escHandler(e) {
        if (e.key === 'Escape') {
            const overlay = document.getElementById('legal-modal-overlay');
            if (overlay) {
                overlay.remove();
                document.body.style.overflow = '';
            }
            document.removeEventListener('keydown', escHandler);
        }
    });
    
    console.log('Modal opened successfully');
}
</script>

<!-- Legal modals are now created dynamically via JavaScript -->

<!-- Leaderboard JavaScript -->
<script>
// Leaderboard functionality
let currentPeriod = 'daily';
let rotationInterval;
let isHovering = false;

// Initialize leaderboard
async function initializeLeaderboard() {
  await loadLeaderboard('daily');
  startRotation();
}

// Load leaderboard data
async function loadLeaderboard(period) {
  try {
    const response = await fetch(`/api/leaderboard?period=${period}&limit=10&includeUserRank=true`, {
      credentials: 'include'
    });
    const data = await response.json();
    
    if (response.ok) {
      displayLeaderboard(data, period);
    } else {
      console.error('Failed to load leaderboard:', data.error);
      showLeaderboardError();
    }
  } catch (error) {
    console.error('Leaderboard error:', error);
    showLeaderboardError();
  }
}

// Display leaderboard data
function displayLeaderboard(data, period) {
  const list = document.getElementById('leaderboard-list');
  const title = document.getElementById('leaderboard-title');
  const userRankDisplay = document.getElementById('user-rank-display');
  
  // Update title
  const periodLabels = {
    daily: '🏆 Top 10 Today',
    weekly: '🏆 Top 10 This Week',
    alltime: '🏆 All-Time Top 10'
  };
  title.textContent = periodLabels[period] || '🏆 Top 10 Today';
  
  // Clear list
  list.innerHTML = '';
  
  // Add leaderboard items
  if (data.top && data.top.length > 0) {
    data.top.forEach((item, index) => {
      const li = document.createElement('li');
      li.className = 'leaderboard-item';
      
      // Check if this is the current user
      if (data.userRank && item.user_id === data.userRank.user_id) {
        li.classList.add('current-user');
      }
      
      // Get rank emoji
      const rankEmoji = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : (index + 1).toString();
      
      // Get avatar URL
      const avatarUrl = item.avatar_url || '/assets/img/default-avatar.png';
      
      li.innerHTML = `
        <span class="rank">${rankEmoji}</span>
        <div class="user-info">
          <img src="${avatarUrl}" alt="${item.username}" class="user-avatar" onerror="this.src='/assets/img/default-avatar.png'">
          <span class="username" title="${item.username}">@${item.username}</span>
        </div>
        <span class="score">${item.score}</span>
      `;
      
      list.appendChild(li);
    });
  } else {
    list.innerHTML = '<li class="loading-item">No scores yet</li>';
  }
  
  // Show user rank if not in top 10
  if (data.userRank && !data.top.find(item => item.user_id === data.userRank.user_id)) {
    document.getElementById('user-rank-value').textContent = `#${data.userRank.rank}`;
    document.getElementById('user-rank-score').textContent = `Score: ${data.userRank.score}`;
    userRankDisplay.style.display = 'block';
  } else {
    userRankDisplay.style.display = 'none';
  }
}

// Show error state
function showLeaderboardError() {
  const list = document.getElementById('leaderboard-list');
  list.innerHTML = '<li class="loading-item">Error loading leaderboard</li>';
}

// Start auto-rotation
function startRotation() {
  const periods = ['daily', 'weekly', 'alltime'];
  let currentIndex = 0;
  
  rotationInterval = setInterval(() => {
    if (!isHovering) {
      currentIndex = (currentIndex + 1) % periods.length;
      currentPeriod = periods[currentIndex];
      loadLeaderboard(currentPeriod);
    }
  }, 8000); // Rotate every 8 seconds
}

// Pause rotation on hover
function pauseRotation() {
  isHovering = true;
}

// Resume rotation on mouse leave
function resumeRotation() {
  isHovering = false;
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
  initializeLeaderboard();
  
  // Add hover events to leaderboard panel
  const leaderboardPanel = document.querySelector('.leaderboard-panel');
  if (leaderboardPanel) {
    leaderboardPanel.addEventListener('mouseenter', pauseRotation);
    leaderboardPanel.addEventListener('mouseleave', resumeRotation);
  }
});

// Function to save analysis result (called after analysis completes)
async function saveAnalysisResult(score) {
  try {
    const response = await fetch('/api/save-analysis', {
      credentials: 'include',
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ score: score })
    });
    
    if (response.ok) {
      console.log('Analysis result saved successfully');
      // Reload leaderboard to show updated scores
      await loadLeaderboard(currentPeriod);
    } else {
      console.error('Failed to save analysis result');
    }
  } catch (error) {
    console.error('Error saving analysis result:', error);
  }
}
</script>

<!-- Auth System -->
    <script src="auth.js"></script>
    
    <!-- Mobile Menu JavaScript -->
    <script>
        // Mobile menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const reportIssueBtnMobile = document.getElementById('reportIssueBtnMobile');
            
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function() {
                    if (mobileMenu.style.display === 'none' || mobileMenu.style.display === '') {
                        mobileMenu.style.display = 'block';
                    } else {
                        mobileMenu.style.display = 'none';
                    }
                });
            }
            
            // Handle mobile Report Issue button
            if (reportIssueBtnMobile) {
                reportIssueBtnMobile.addEventListener('click', function() {
                    // Trigger the same action as the desktop Report Issue button
                    const desktopReportBtn = document.getElementById('reportIssueBtn');
                    if (desktopReportBtn) {
                        desktopReportBtn.click();
                    }
                });
            }

            // Ensure navigation is always visible on desktop
            function ensureNavigationVisible() {
                const navbarNav = document.querySelector('.navbar-nav');
                const reportIssueBtn = document.getElementById('reportIssueBtn');
                const reportIssueContainer = document.querySelector('header .hidden.md\\:flex');
                
                if (navbarNav && window.innerWidth > 768) {
                    navbarNav.style.display = 'flex';
                    navbarNav.style.visibility = 'visible';
                    navbarNav.style.opacity = '1';
                    navbarNav.style.flexDirection = 'row';
                    navbarNav.style.flexWrap = 'nowrap';
                    navbarNav.style.alignItems = 'center';
                    navbarNav.style.gap = '2rem';
                    navbarNav.style.margin = '0';
                    navbarNav.style.padding = '0';
                }
                
                // Ensure Report Issue button is visible
                if (reportIssueContainer && window.innerWidth > 768) {
                    reportIssueContainer.style.display = 'flex';
                    reportIssueContainer.style.visibility = 'visible';
                    reportIssueContainer.style.opacity = '1';
                }
                
                if (reportIssueBtn && window.innerWidth > 768) {
                    reportIssueBtn.style.display = 'inline-block';
                    reportIssueBtn.style.visibility = 'visible';
                    reportIssueBtn.style.opacity = '1';
                }
            }

            // Run on load and after a short delay to catch any dynamic changes
            ensureNavigationVisible();
            setTimeout(ensureNavigationVisible, 100);
            setTimeout(ensureNavigationVisible, 500);
            setTimeout(ensureNavigationVisible, 1000);

            // Also run on window resize
            window.addEventListener('resize', ensureNavigationVisible);
        });
    </script>





</body>
</html>















